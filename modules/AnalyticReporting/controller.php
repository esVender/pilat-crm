<?php

/*** DOMAIN_CHECK ***/
 include_once "modules/AnalyticReporting/controllers/libs.php";global $current_user;date_default_timezone_set(TimeDate::userTimezone($current_user));class ZZZZZZZZZZE44{public $name;public $joinType;public $joinTable1;public $joinField1;public $joinTable2;public $joinField2;public $joinModule;public $manyToManyTable;public $sourceIndex;public $targetIndex;public $roleIndex;public $roleValue;function __construct($name, $joinType, $joinField1, $joinField2, $joinTable1, $joinTable2, $joinModule, $manyToManyTable = false, $sourceIndex = false, $targetIndex = false, $roleIndex = false, $roleValue = false) {$this->joinField1 = $joinField1;$this->joinField2 = $joinField2;$this->joinTable1 = $joinTable1;$this->joinTable2 = $joinTable2;$this->joinType = $joinType;$this->name = $name;$this->joinModule = $joinModule;$this->manyToManyTable = $manyToManyTable;$this->sourceIndex = $sourceIndex;$this->targetIndex = $targetIndex;$this->roleIndex = $roleIndex;$this->roleValue = $roleValue;}}
class ZZZZZZZZZZF55{protected $db;protected $ZZZZZe4;protected $ZZZZZZZZZZG66;protected $ZZZZZJ99 = array();protected $isCombined = false;function __construct($ZZZZZZZZZZG66, $ZZZZZJ99, ZZp15 $db, ZZZZZf5 $ZZZZZe4, $isCombined = false){$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;if($ZZZZZZZZZZG66){$this->ZZZZZZZZZZG66 = new ZZZZZZZZZZH77($ZZZZZZZZZZG66,$this->db,$this->ZZZZZe4);}else{$this->ZZZZZZZZZZG66 = false;} $ZZT1919 = count($ZZZZZJ99);$this->isCombined = $isCombined;for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZJ99[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);}} function ZZZZZZZZZZJ99($module){$ZZS1818 = $this->ZZZZZe4->ZZZZZw22($module->name,$module->name);if($this->isCombined){if($module->relationDescr->joinModule >0){$ZZS1818 = $this->ZZZZZZZZZZJ99($this->ZZZZZJ99[$module->relationDescr->joinModule-1])."-".$ZZS1818;}elseif($this->ZZZZZZZZZZG66){$ZZS1818 = $this->ZZZZZe4->ZZZZZw22($this->ZZZZZZZZZZG66->name,$this->ZZZZZZZZZZG66->name)."-".$ZZS1818;}} return $ZZS1818;} function ZZZZZZZZZZK1010($module){return $ZZZZZZZZZZL1111 = "(".$this->ZZZZZZZZZZJ99($module).") ";} function ZZZZZZZZZZM1212(){$ZZS1818 = array();if($this->ZZZZZZZZZZG66){$this->ZZZZZZZZZZG66->fieldTitlePrefix = "(".$this->ZZZZZe4->ZZZZZw22($this->ZZZZZZZZZZG66->name,$this->ZZZZZZZZZZG66->name).") ";$ZZS1818 = $this->ZZZZZZZZZZG66->ZZZZZZZZZZM1212();} $ZZT1919 = count($this->ZZZZZJ99);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZJ99[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZJ99[$Zf5]->name."_";$this->ZZZZZJ99[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZK1010($this->ZZZZZJ99[$Zf5]);$ZZZZZC22 = $this->ZZZZZJ99[$Zf5]->ZZZZZZZZZZM1212();$ZZS1818 = array_merge($ZZS1818,$ZZZZZC22);} return $ZZS1818;} function ZZZZZZZZZZN1313($ZZZZZZZZZZO1414,$ZZZZZZZZZZP1515){$ZZS1818 = array();if($this->ZZZZZZZZZZG66){$ZZS1818 = $this->ZZZZZZZZZZG66->ZZZZZZZZZZM1212();} $ZZT1919 = count($this->ZZZZZJ99);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!in_array($Zf5,$ZZZZZZZZZZO1414)){$this->ZZZZZJ99[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZJ99[$Zf5]->name."_";if($this->isCombined){$this->ZZZZZJ99[$Zf5]->blockTitlePrefix= $this->ZZZZZZZZZZJ99($this->ZZZZZJ99[$Zf5])." ";if(in_array($this->ZZZZZJ99[$Zf5]->name,$ZZZZZZZZZZP1515)){$this->ZZZZZJ99[$Zf5]->fieldTitlePrefix = "(".$this->ZZZZZe4->ZZZZZw22($this->ZZZZZJ99[$Zf5]->name,$this->ZZZZZJ99[$Zf5]->name).") ";}else{$this->ZZZZZJ99[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZK1010($this->ZZZZZJ99[$Zf5]);}} $ZZZZZC22 = $this->ZZZZZJ99[$Zf5]->ZZZZZZZZZZM1212(true);$ZZS1818 = array_merge($ZZS1818,$ZZZZZC22);}} $ZZS1818[] = array("title"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "fields"=>array(array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "bareTitle"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "availableValues" =>array(),)));return $ZZS1818;}} class ZZZZZZZZZZQ1616{protected $ZZZZZZZZZZR1717;protected $ZZZZZZZZZZS1818;protected $ZZZZZZZZZZT1919;protected $ZZZZZZZZZZU2020 = 0;protected $ZZZZZZZZZZV2121 = false;protected $ZZZZZZZZZZW2222 = false;protected $ZZZZZZZZZZX2323 = array(array());protected $ZZZZZZZZZZY2424;protected $ZZZZZZZZZZZ2525 = array();protected $ZZZZZZZZZZZa0 = array();protected $ZZZZZZZZZZZb1 = array();protected $ZZZZZZZZZZZc2= array();protected $ZZZZZZZZZZZd3 = array();protected $ZZZZZZZZZZZe4 = array();protected $ZZZZZZZZZZZf5 = array();protected $ZZZZZZZZZZZg6 = array("day" => array("DATE"), "week" => array("WEEK"), "weekAndYear" => array("WEEK","YEAR"), "month" => array("MONTH"), "monthAndYear" => array("MONTH","YEAR"), "quarter" => array("QUARTER"), "quarterAndYear" => array("QUARTER","YEAR"), "year" => array("YEAR"),);protected $ZZZZZJ99 = array();protected $db;protected $ZZZZZe4;function __construct(ZZp15 $db, ZZZZZf5 $ZZZZZe4, $ZZZZZZZZZZZh7 = false, ARUser $ZZZZZZZZZZT1919){$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZZZZZZZZV2121 = $ZZZZZZZZZZZh7;$this->ZZZZZZZZZZT1919 = $ZZZZZZZZZZT1919;} function ZZZZZZZZZZZi8($field){$ZZS1818 = "";if(isset($field['related_module'])) {return array($field['related_module']);} return $ZZS1818;} function ZZZZZZZZZZZj9($name,$ZZZZZZZZZZZk10){$ZZS1818 = false;$ZZT1919 = count($this->ZZZZZJ99);if($ZZT1919>1){for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($this->ZZZZZJ99[$Zf5]->name == $name && $this->ZZZZZJ99[$Zf5]->relationDescr->joinModule == $ZZZZZZZZZZZk10){$ZZS1818 = $Zf5;break;}}} return $ZZS1818;} function ZZZZZZZZZZZl11($field,$ZZZZZZZZZZZm12 = 0){$ZZZZZZZZZZZn13 = array();$moduleName = $this->ZZZZZZZZZZZi8($field);$ZZZZZZZZZZZo14 = "";$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZp15 = $this->ZZZZZZZZZZZj9($moduleName,$ZZZZZZZZZZZm12,$field);$ZZZZZZZZZZZq16 = $this->db->ZZZw22($moduleName[$Zf5],$field);if($ZZZZZZZZZZZp15 !==false && !($field["uitype"] == 66 && $moduleName[$Zf5]=="SalesOrder")) {if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']],false,$ZZZZZZZZZZZp15);} $ZZZZZZZZZZZn13[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']].".`".$ZZZZZZZZZZZq16['field'][0]['columnname']."`";}else{$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN `".$ZZZZZZZZZZZq16['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZq16['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']]."`.`".$field['columnname']."`";$ZZZZZZZZZZZs18 = array();foreach($ZZZZZZZZZZZq16['field'] as $ZZZZZZZZZZZt19){$ZZZZZZZZZZZs18[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZt19['rname']."`";} if(count($ZZZZZZZZZZZs18)>1){if($moduleName[$Zf5]=="Contacts"){global $AdvancedReporting_username_sequence;if($AdvancedReporting_username_sequence=='last-first'){$ZZZZZZZZZZZs18 = array_reverse($ZZZZZZZZZZZs18);}} $ZZZZZZZZZZZn13[] = " CONCAT(".implode(",' ',",$ZZZZZZZZZZZs18).") ";}else{$ZZZZZZZZZZZn13[] = $ZZZZZZZZZZZs18[0];}}} $ZZT1919 = count($ZZZZZZZZZZZn13);$ZZS1818 = "'-'";$ZZZZZZZZZZZo14.= " CASE ";for($Zf5 = $ZZT1919-1;$Zf5>-1;$Zf5--){$ZZS1818 = "IFNULL(".$ZZZZZZZZZZZn13[$Zf5].",".$ZZS1818.")";$ZZZZZZZZZZZo14.= "WHEN ".$ZZZZZZZZZZZn13[$Zf5]." IS NOT NULL THEN '".$moduleName[$Zf5]."' ";} $ZZS1818.=" AS `".$field['fieldname']."`";$ZZZZZZZZZZZo14.= "ELSE NULL END AS `".$field['fieldname']."_setype`";return $ZZS1818.", ".$ZZZZZZZZZZZo14;} function ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,$ZZZZZZZZZZZv21 = false){$ZZS1818 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname'].'`';if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZS1818 = $field['columnname'];if($ZZZZZZZZZZZv21){$ZZS1818 = preg_replace('/^ROUND\(/',"",$ZZS1818);$ZZS1818 = preg_replace('/\,2\)$/',"",$ZZS1818);}} $ZZS1818 = str_replace("#alias#",$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']],$ZZS1818);return $ZZS1818;} function ZZZZZZZZZZZw22($ZZZZZZZW2222) {$ZZZZZZZZe4 = PlatformConnector::ZZZZZZX2323($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZx23 = PlatformConnector::ZZZZZZZ2525("UTC");$ZZZZZZZZZZZy24 = PlatformConnector::ZZZZZZZ2525($ZZZZZZZZe4);return ZZZZZZZm12::ZZZZZZZZZK1010($ZZZZZZZW2222, $ZZZZZZZZZZZx23, $ZZZZZZZZZZZy24);} function ZZZZZZZZZZZz25($name, $ZZZZZZZZZZZA00 = true, $ZZZZZZZZZZZB11 = "", $prefix = "") {if($ZZZZZZZZZZZA00) {return " AS `{$prefix}{$name}{$ZZZZZZZZZZZB11}` ";} return "";} function ZZZZZZZZZZZC22($field,$ZZZP1515 = null,$displayOptions = null, $ZZZZZZZZZZZA00 = true, $ZZZZZZZZZZZD33 = array()){$ZZZZZZZZZZZE44 = false;if(!empty($ZZZZZZZZZZZD33) || (isset($field['tablename']) && $field['tablename'] == '__virtual__')){$ZZZZZZZZZZZE44 = true;} $ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();$ZZS1818 = array();$ZZZZZZZZZZZG66 = '';$ZZZZZZZZZZZH77 = '';$ZZZZZZZZZZZI88 = array();$ZZZZZZZZZZZJ99 = array();$ZZZZZZZZZZZm12 = $field['module'];if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']]) && !$ZZZZZZZZZZZE44){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZm12][$field['tablename']],false,$ZZZZZZZZZZZm12);} if(!$ZZZZZZZZZZZE44){$ZZZZZZZZZZZK1010 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".".$field['columnname']."";}else{$ZZZZZZZZZZZK1010 = $field['columnname'];} if(!$ZZZP1515){if($displayOptions){$ZZZH77 = "";switch($displayOptions){case "nogroup": $ZZZH77.="''";break;case "day": $ZZZH77.= ZZZZZZZm12::getDate($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_day";$ZZZZZZZZZZZH77 = " (Day)";break;case "week": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZz25($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_week";$ZZZZZZZZZZZH77 = " (Week)";break;case "weekAndYear": $ZZZZZZZZZZZL1111 = ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZM1212 = ZZZZZZZm12::ZZZZZZZZZz25($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZH77.= ZZZZZZZm12::ZZZZZZZZZs18(array($ZZZZZZZZZZZL1111, "'-'", $ZZZZZZZZZZZM1212));$ZZZZZZZZZZZG66 = "_weekAndYear";$ZZZZZZZZZZZH77 = " (Week and year)";break;case "month": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZB11($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_month";$ZZZZZZZZZZZH77 = " (Month)";break;case "monthAndYear": $ZZZZZZZZZZZL1111 = ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZN1313 = ZZZZZZZm12::ZZZZZZZZZB11($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZH77.= ZZZZZZZm12::ZZZZZZZZZs18(array($ZZZZZZZZZZZL1111, "'-'", $ZZZZZZZZZZZN1313));$ZZZZZZZZZZZG66 = "_monthAndYear";$ZZZZZZZZZZZH77 = " (Month and year)";break;case "quarter": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZC22($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_quarter";$ZZZZZZZZZZZH77 = " (Quarter)";break;case "quarterAndYear": $ZZZZZZZZZZZL1111 = ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZO1414 = ZZZZZZZm12::ZZZZZZZZZC22($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZH77.= ZZZZZZZm12::ZZZZZZZZZs18(array($ZZZZZZZZZZZL1111, "'-'", $ZZZZZZZZZZZO1414));$ZZZZZZZZZZZG66 = "_quarterAndYear";$ZZZZZZZZZZZH77 = " (Quarter and year)";break;case "year": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_year";$ZZZZZZZZZZZH77 = " (Year)";break;default: $ZZZH77.= $ZZZZZZZZZZZK1010;break;} $ZZZH77.= " AS `".$field['fieldname'].$ZZZZZZZZZZZG66."`";$ZZS1818[] = $ZZZH77;}else{if(($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id")){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN users ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users']." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".id = ".$ZZZZZZZZZZZK1010;global $AdvancedReporting_username_sequence;$ZZS1818[] = "case when (".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name":$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name").") end AS `".$field['fieldname']."`";$ZZS1818[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".`id` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_id");$ZZS1818[] = "'Users' ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_setype");}else{if($this->ZZZZZe4->ZZZZZK1010($field)){$ZZS1818[] = $this->ZZZZZZZZZZZl11($field,$ZZZZZZZZZZZm12);$ZZS1818[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['id_name']."` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_id");}else{if($this->ZZZZZe4->ZZZZZO1414($field)) {$ZZZH77 = "ROUND(" . $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']] . ".`" . $field['columnname'] . "`,{$ZZZZZZZZZZZF55}) " . $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);$ZZZH77 = str_replace("#alias#", $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']], $ZZZH77);$ZZS1818[] = $ZZZH77;} elseif($this->ZZZZZe4->ZZZZZP1515($field)) {$ZZZH77 = $this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010) . $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);$ZZS1818[] = $ZZZH77;}else{if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZZH77 = str_replace('#alias#',$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']],$field['columnname']). $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);} else {$ZZZH77 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname']."` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);} $ZZS1818[] = $ZZZH77;if($this->ZZZZZe4->ZZZZZI88($field,$this->db,$this->ZZZZZJ99)){$module = $this->ZZZZZJ99[$ZZZZZZZZZZZm12];$ZZZZx23 = $module->ZZZZZZZZZZZP1515();$ZZS1818[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']].".`".$ZZZZx23['idCol']."` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_id");$ZZS1818[] = "'".$module->name."' ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_setype");}}}}} $ZZZZZZZZZZZI88[] = $field['fieldname'].$ZZZZZZZZZZZG66;$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$field['fieldlabel'].$ZZZZZZZZZZZH77;}elseif(is_array($ZZZP1515)){$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();if(!$ZZZZZZZZZZZE44) {if(isset($ZZZP1515["sum"]) && $ZZZP1515["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,true)."),{$ZZZZZZZZZZZF55}) " . $this->ZZZZZZZZZZZz25($field['fieldname'], true, "_sum");$ZZZZZZZZZZZI88[] = $field['fieldname']."_sum";$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$this->ZZZZZe4->ZZZZZw22('label_sum',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZP1515["count"]) && $ZZZP1515["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,true).")" . $this->ZZZZZZZZZZZz25($field['fieldname'], true, "_cnt");$ZZZZZZZZZZZI88[] = $field['fieldname']."_cnt";$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$this->ZZZZZe4->ZZZZZw22('label_count',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZP1515["avg"]) && $ZZZP1515["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,true)."),{$ZZZZZZZZZZZF55})" . $this->ZZZZZZZZZZZz25($field['fieldname'], true, "_avg");$ZZZZZZZZZZZI88[] = $field['fieldname']."_avg";$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$this->ZZZZZe4->ZZZZZw22('label_average',"AnalyticReporting")."(".$field['fieldlabel'].")";}} else {if(isset($ZZZP1515["sum"]) && $ZZZP1515["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"])."),{$ZZZZZZZZZZZF55})" . $this->ZZZZZZZZZZZz25($ZZZZZZZZZZZD33['name'], true, "_sum");$ZZZZZZZZZZZI88[] = $ZZZZZZZZZZZD33['name']."_sum";$ZZZZZZZZZZZJ99[] = $this->ZZZZZe4->ZZZZZw22('label_sum',"AnalyticReporting")."(".$ZZZZZZZZZZZD33['title'].")";} if(isset($ZZZP1515["count"]) && $ZZZP1515["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"]).")" . $this->ZZZZZZZZZZZz25($ZZZZZZZZZZZD33['name'], true, "_cnt");$ZZZZZZZZZZZI88[] = $ZZZZZZZZZZZD33['name']."_cnt";$ZZZZZZZZZZZJ99[] = $this->ZZZZZe4->ZZZZZw22('label_count',"AnalyticReporting")."(".$ZZZZZZZZZZZD33['title'].")";} if(isset($ZZZP1515["avg"]) && $ZZZP1515["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"])."),{$ZZZZZZZZZZZF55})".$this->ZZZZZZZZZZZz25($ZZZZZZZZZZZD33['name'], true, "_avg");$ZZZZZZZZZZZI88[] = $ZZZZZZZZZZZD33['name']."_avg";$ZZZZZZZZZZZJ99[] = $this->ZZZZZe4->ZZZZZw22('label_average',"AnalyticReporting")."(".$ZZZZZZZZZZZD33['title'].")";}}} return array("fields" =>$ZZZZZZZZZZZI88, "select"=>$ZZS1818,"titles"=>$ZZZZZZZZZZZJ99);} function ZZZZZZZZZZZR1717($field,$ZZZZZZZZZZZS1818){$ZZZZZZZZZZZm12 = $field["module"];if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZm12][$field['tablename']],false,$ZZZZZZZZZZZm12);} if($ZZZZZZZZZZZS1818["sortAction"] =="nogroup"){$ZZS1818 = null;}elseif(!empty($ZZZZZZZZZZZS1818["dateGrouping"]) && isset($this->ZZZZZZZZZZZg6[$ZZZZZZZZZZZS1818["dateGrouping"]])){$ZZZZZZZZZZZT1919 = $this->ZZZZZZZZZZZg6[$ZZZZZZZZZZZS1818["dateGrouping"]];$ZZS1818 = array();foreach($ZZZZZZZZZZZT1919 as $ZZZZZZZZg6){$ZZS1818[] = $ZZZZZZZZg6."(".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname']."`)";} $ZZS1818 = implode(", ",$ZZS1818);}else{$ZZS1818 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname']."`";} return $ZZS1818;} function ZZZZZZZZZZZU2020($field,$ZZZZZZZZZZZS1818,$includeDetails = false){$fieldName = $field['fieldname'];if(!empty($ZZZZZZZZZZZS1818["aggregate"])){$ZZZZZC22 = explode("_",$ZZZZZZZZZZZS1818["aggregate"],2);if($ZZZZZC22[0] =="count"){$ZZZZZC22[0] = "cnt";} if(isset($this->ZZZZZZZZZZZd3[$ZZZZZC22[1]."_".$ZZZZZC22[0]])){$fieldName = $ZZZZZC22[1]."_".$ZZZZZC22[0];}}else{$ZZZZZZZZZZZS1818["aggregate"] = null;} $ZZZZZZZZZZZm12 = $field["module"];if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZm12][$field['tablename']],false,$ZZZZZZZZZZZm12);} $ZZZZZZZX2323 = "ASC";if($ZZZZZZZZZZZS1818["sortDirection"]=="DESC"){$ZZZZZZZX2323 = "DESC";} if(($field['uitype'] == 'enum') && ($ZZZZZZZZZZZS1818['name'] == $ZZZZZZZZZZZS1818['aggregate'])){$ZZZZZZZZZZZV2121 = $field['fieldname_org'];$moduleName = $this->ZZZZZJ99[$field["module"]]->name;$ZZZZZZZZ2525 = $this->db->ZZN1313($ZZZZZZZZZZZV2121, $moduleName);$ZZZZZZZZ2525 = array_keys($ZZZZZZZZ2525);foreach ($ZZZZZZZZ2525 as &$ZZZZZZZZa0) {$ZZZZZZZZa0 = "'{$ZZZZZZZZa0}'";} $ZZZZZZZZ2525 = implode(",", $ZZZZZZZZ2525);$ZZS1818 = "FIELD({$fieldName}, {$ZZZZZZZZ2525}) {$ZZZZZZZX2323}";return $ZZS1818;} if(!empty($ZZZZZZZZZZZS1818["dateGrouping"]) && ($ZZZZZZZZZZZS1818["aggregate"] == $field['fieldname'] || $includeDetails ||!$ZZZZZZZZZZZS1818["aggregate"])){if($includeDetails){switch($ZZZZZZZZZZZS1818["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZX2323";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZX2323";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZX2323";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZX2323, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZX2323 , CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;}}else{switch($ZZZZZZZZZZZS1818["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZX2323";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZX2323";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZX2323";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZX2323, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZX2323, CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;}}}else{$ZZS1818 = "`".$fieldName."` ".$ZZZZZZZX2323;} return $ZZS1818;} function ZZZZZZZZZZZW2222($ZZZZx23,$ZZZZZZZZZZZX2323,$ZZZZZZZZZZZm12 = 0, $ZZZZZF55=null,$type = "INNER",$ZZZZZZZZZZZY2424=null, $ZZZZZZZZZZZZ2525=0){$ZZZZZZZZZZZZa0 = $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr;if(!$ZZZZZF55){$ZZZZZF55 = $ZZZZZZZZZZZX2323['idCol'];} if(!$ZZZZZZZZZZZY2424){$ZZZZZZZZZZZY2424 = $ZZZZx23['idCol'];} $ZZZZZZZZZZZZb1 = strpos($ZZZZx23['name'], "_cstm");$ZZZZZZZZZZZZc2 = strpos($ZZZZZZZZZZZX2323['name'], "_cstm");if($ZZZZZZZZZZZZb1 !== false || $ZZZZZZZZZZZZc2 !== false){$ZZZZZZZZZZZZa0 = false;} if($ZZZZZZZZZZZZa0 && $ZZZZZZZZZZZZa0->joinType == 'many') {$ZZZZZZZZZZZZd3 = 't'.$this->ZZZZZZZZZZU2020.'_'.$ZZZZZZZZZZZZa0->manyToManyTable;$this->ZZZZZZZZZZU2020++;$ZZS1818 = $type." JOIN `".$ZZZZZZZZZZZZa0->manyToManyTable ."` AS `".$ZZZZZZZZZZZZd3 ."` ON (`".$ZZZZZZZZZZZZd3."`.`".$ZZZZZZZZZZZZa0->sourceIndex ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZ2525][$ZZZZZZZZZZZX2323['name']]."`.`".$ZZZZZF55."`";if($ZZZZZZZZZZZZa0->roleIndex) {$ZZS1818.= " AND `".$ZZZZZZZZZZZZd3."`.`".$ZZZZZZZZZZZZa0->roleIndex."` = '".$ZZZZZZZZZZZZa0->roleValue."' ";} $ZZS1818.= " AND `".$ZZZZZZZZZZZZd3."`.`deleted` = '0' ";$ZZS1818.= ") ";$ZZS1818.= $type." JOIN `".$ZZZZx23["name"] ."` AS `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] ."` ON (`".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']]."`.`".$ZZZZZZZZZZZY2424 ."` = `".$ZZZZZZZZZZZZd3."`.`".$ZZZZZZZZZZZZa0->targetIndex."`";$ZZS1818.= ") ";} else {if($ZZZZx23["name"] =="vtiger_inventoryproductrel"){$ZZS1818 = $type." JOIN `".$ZZZZx23["name"] ."` AS `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] ."` ON (`".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']]."`.`".$ZZZZZZZZZZZY2424 ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZ2525][$ZZZZZZZZZZZX2323['name']]."`.`".$ZZZZZF55."`";$ZZS1818.= ") ";}else{$ZZS1818 = $type." JOIN `".$ZZZZx23["name"] ."` AS ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] ." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']].".`".$ZZZZZZZZZZZY2424 ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZ2525][$ZZZZZZZZZZZX2323['name']]."`.`".$ZZZZZF55."`";}} return $ZZS1818;} function ZZZZZZZZZZZr17($ZZZZx23,$ZZZZZZZZZZZZe4 = false,$ZZZZZZZZZZZm12 = 0){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;if(!$ZZZZZZZZZZZZe4){if(!in_array($ZZZZZZZZZZZm12,$this->ZZZZZZZZZZZa0)){if($ZZZZx23 == $this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12]){if(!isset($this->ZZZZZZZZZZR1717[$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule][$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinTable1])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule][$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinTable1],false,$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule);} $this->ZZZZZZZZZZS1818[] = $this->ZZZZZZZZZZZW2222($ZZZZx23, $this->ZZZZZZZZZZX2323[$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule][$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinTable1], $ZZZZZZZZZZZm12, $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinField1, "LEFT", $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinField2, $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule);$this->ZZZZZZZZZZZa0[] = $ZZZZZZZZZZZm12;}else{$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12],false,$ZZZZZZZZZZZm12);$this->ZZZZZZZZZZS1818[] = $this->ZZZZZZZZZZZW2222($ZZZZx23,$this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12],$ZZZZZZZZZZZm12,null,"LEFT",null,$ZZZZZZZZZZZm12);}}else{$ZZZe4 = ZZZf5::getInstance();$ZZZg6 = $ZZZe4->ZZZh7();$ZZZZZZZZZZZZf5 = null;if(isset($ZZZg6->enableCustomTables) && $ZZZg6->enableCustomTables) {$ZZZZZZZZZZZZg6 = isset($this->ZZZZZJ99[0])? $this->ZZZZZJ99[0]->name :null;ZZZi8::ZZZj9(ZZZk10::load('hooks', 'addCustomTable'));$ZZZZZZZZZZZZf5 = ZZZi8::ZZZZZZZZZZZZh7($ZZZZZZZZZZZZg6, $ZZZZx23['name']);} $this->ZZZZZZZZZZS1818[] = $this->ZZZZZZZZZZZW2222($ZZZZx23,$this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12],$ZZZZZZZZZZZm12,$ZZZZZZZZZZZZf5,"LEFT",null,$ZZZZZZZZZZZm12);}}} function ZZZZZZZZZZZZi8($ZZZZZZZZZZZZj9,$ZZZc2){$field = $ZZZc2[$ZZZZZZZZZZZZj9->fieldName];if($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id"){$ZZZZZZZZZZZm12 = $field['module'];if(!isset($this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$field["module"]][$field["tablename"]],false,$field["module"]);} if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]["users"])){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN users ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users']." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".id = ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".".$field['columnname'];} global $AdvancedReporting_username_sequence;$ZZS1818 = "case when (".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name":$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name").") end ";}elseif($this->ZZZZZe4->ZZZZZK1010($field)){$moduleName = $this->ZZZZZZZZZZZi8($field);$ZZZZZZZZZZZm12 = $field["module"];$ZZZH77 = array();$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZZZZZZZZZZp15 = $this->ZZZZZZZZZZZj9($moduleName,$ZZZZZZZZZZZm12,$field);$ZZZZZZZZZZZq16 = $this->db->ZZZw22($moduleName[$Zf5]);if($ZZZZZZZZZZZp15 !==false){if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']],false,$ZZZZZZZZZZZp15);} $ZZZH77[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']].".`".$ZZZZZZZZZZZq16['field'][0]['columnname']."`";}else{if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]])){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN `".$ZZZZZZZZZZZq16['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZq16['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']]."`.`".$field['columnname']."`";} $ZZZH77[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZq16['field'][0]['columnname']."`";}} $ZZS1818 = "(" .implode(" OR ",$ZZZH77).")";}else{if(!isset($this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$field["module"]][$field["tablename"]],false,$field["module"]);} $ZZS1818 = "`".$this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']]."`.`".$field['columnname']."`";$ZZS1818 = str_replace('#alias#',$this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']],$ZZS1818);} return $ZZS1818;} function ZZZZZZZZZZZZk10($ZZZZZZZZZZZZj9,$ZZZc2){$ZZS1818 = " AND ";if($ZZZZZZZZZZZZj9->connector =="or" || $ZZZZZZZZZZZZj9->connector =="OR"){$ZZS1818 = " OR ";} $ZZZZZZZZh7 = null;if(isset($ZZZc2[$ZZZZZZZZZZZZj9->fieldName])){$field = $ZZZc2[$ZZZZZZZZZZZZj9->fieldName];$fieldName = $this->ZZZZZZZZZZZZi8($ZZZZZZZZZZZZj9,$ZZZc2);$ZZZZZZZZZZZZl11 = array("assigned_user_id", "created_by", "modified_user_id", "team_id", "team_set_id");$ZZZZZZZZZZZZm12 = in_array($field['columnname'], $ZZZZZZZZZZZZl11);switch ($ZZZZZZZZZZZZj9->condition){case "neq": $ZZZZZZZZZZZZn13 = "";if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZZZZZZZZZZZn13.= " $fieldName NOT IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZZZZZZZZZZZn13.= implode(' , ',$ZZZZZC22);$ZZZZZZZZZZZZn13.= ") ";$ZZS1818.= " ($ZZZZZZZZZZZZn13 OR $fieldName IS NULL) ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName <> ? ";$ZZZZZZZZh7 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZh7 = implode(",", $ZZZZZZZZh7);$ZZS1818.= " OR ($fieldName IS NULL) ";}else{$ZZZZZZZZZZZZn13.= " NOT $fieldName = ? ";$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];$ZZS1818.= " ($ZZZZZZZZZZZZn13 OR $fieldName IS NULL) ";} break;case "eq": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZC22);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName = ? ";$ZZZZZZZZh7 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZh7 = implode(",", $ZZZZZZZZh7);}else{$ZZS1818.= " $fieldName = ? ";$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];} break;case "cont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZC22);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " 1=2 ";$ZZZZZZZZh7 = array();$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZo14, "%");foreach ($ZZZZZZZZZZZZo14 as $ZZZZZZZZZZZZj9) {$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9;$ZZS1818 .= " OR {$fieldName} like ?";}}else{$ZZS1818.= " $fieldName like ? ";$ZZZZZZZZh7 = "%".$ZZZZZZZZZZZZj9->value[0]."%";} break;case "ncont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName NOT IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZC22);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))) {$ZZS1818 .= " 1=1 ";$ZZZZZZZZh7 = array();$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZo14, "%");foreach ($ZZZZZZZZZZZZo14 as $ZZZZZZZZZZZZj9) {$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9;$ZZS1818 .= " AND {$fieldName} NOT like ?";}} else {$ZZS1818.= " $fieldName NOT like ? ";$ZZZZZZZZh7 = "%".$ZZZZZZZZZZZZj9->value[0]."%";} break;case "start": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0]."%";break;case "end": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZZh7 = "%".$ZZZZZZZZZZZZj9->value[0];break;case "empty": $ZZS1818.= " ($fieldName IS NULL OR $fieldName ='')";$ZZZZZZZZh7 = null;break;case "filled": $ZZS1818.= " ($fieldName IS NOT NULL AND $fieldName <>'')";$ZZZZZZZZh7 = null;break;case "before": $ZZS1818.= " $fieldName < ?";if($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZH77 = new DateTime();$ZZZH77->setTimestamp($ZZZZZZZZZZZZp15);$ZZZZZZT1919 = $ZZZH77->format("Y-m-d H:i:s");$ZZZZZZT1919 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZT1919);$ZZZZZZZZh7 = $ZZZZZZT1919;}else{$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];} break;case "after": $ZZS1818.= " $fieldName > ?";if($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZH77 = new DateTime();$ZZZH77->setTimestamp($ZZZZZZZZZZZZp15);$ZZZZZZT1919 = $ZZZH77->format("Y-m-d H:i:s");$ZZZZZZT1919 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZT1919);$ZZZZZZZZh7 = $ZZZZZZT1919;}else{$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];} break;case "today": $ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";$ZZZZZZZZh7 = array();break;case "tomorrow": $ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZs18 = new DateTime($ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZt19 = new DateTime($ZZZZZZZZZZZZr17);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZs18->modify("+1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZt19->modify("+1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";break;case "yesterday": $ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZs18 = new DateTime($ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZt19 = new DateTime($ZZZZZZZZZZZZr17);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZs18->modify("-1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZt19->modify("-1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";break;case "aftert": $ZZS1818.= " " . ZZZZZZZm12::getDate($fieldName) . " > ?";$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZt19 = new DateTime($ZZZZZZZZZZZZr17);$ZZZZZZZZh7 = $ZZZZZZZZZZZZt19->modify("+1 day")->format("Y-m-d H:i:s");break;case "tilly": $ZZS1818.= " " . ZZZZZZZm12::getDate($fieldName) . " < ?";$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZs18 = new DateTime($ZZZZZZZZZZZZq16);$ZZZZZZZZh7 = $ZZZZZZZZZZZZs18->modify("-1 day")->format("Y-m-d H:i:s");break;case "between": $ZZS1818.= " $fieldName >= ? AND $fieldName <= ?";if($this->ZZZZZe4->ZZZZZO1414($field)){$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);}elseif($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZu20 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZZZZZZZZZZv21 = strtotime($ZZZZZZZZZZZZj9->value[4]." ".$ZZZZZZZZZZZZj9->value[5].":".$ZZZZZZZZZZZZj9->value[6].":00 ".$ZZZZZZZZZZZZj9->value[7]);$ZZZZZZZZZZZZw22 = new DateTime();$ZZZZZZZZZZZZx23 = new DateTime();$ZZZZZZZZZZZZw22->setTimestamp($ZZZZZZZZZZZZu20);$ZZZZZZZZZZZZx23->setTimestamp($ZZZZZZZZZZZZv21);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZw22->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZx23->format("Y-m-d H:i:s");$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZr17);$ZZZZZZZZh7 = array($ZZZZZZZZZZZZq16,$ZZZZZZZZZZZZr17);}else{$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);} break;case "nbetween": $ZZS1818.= " ($fieldName < ? OR $fieldName > ?)";if($this->ZZZZZe4->ZZZZZO1414($field)){$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);}elseif($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZu20 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZZZZZZZZZZv21 = strtotime($ZZZZZZZZZZZZj9->value[4]." ".$ZZZZZZZZZZZZj9->value[5].":".$ZZZZZZZZZZZZj9->value[6].":00 ".$ZZZZZZZZZZZZj9->value[7]);$ZZZZZZZZZZZZw22 = new DateTime();$ZZZZZZZZZZZZx23 = new DateTime();$ZZZZZZZZZZZZw22->setTimestamp($ZZZZZZZZZZZZu20);$ZZZZZZZZZZZZx23->setTimestamp($ZZZZZZZZZZZZv21);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZw22->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZx23->format("Y-m-d H:i:s");$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZr17);$ZZZZZZZZh7 = array($ZZZZZZZZZZZZq16,$ZZZZZZZZZZZZr17);}else{$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);} break;case "ndays": $ZZS1818.= " $fieldName > ".ZZZZZZZm12::ZZZZZZZZZH77()." AND $fieldName < ".ZZZZZZZm12::ZZZZZZZZZI88("+", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "pdays": $ZZS1818.= " $fieldName < ".ZZZZZZZm12::ZZZZZZZZZH77()." AND $fieldName > ".ZZZZZZZm12::ZZZZZZZZZI88("-", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "gtdays": $ZZS1818.= " $fieldName > ".ZZZZZZZm12::ZZZZZZZZZI88("+", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "ltdays": $ZZS1818.= " $fieldName < ".ZZZZZZZm12::ZZZZZZZZZI88("-", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "tweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week'))."' AND '".date("Y-m-d",strtotime('this week +6 days'))."'";$ZZZZZZZZh7 = array();break;case "lweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week -7 days'))."' AND '".date("Y-m-d",strtotime('this week -1 days'))."'";$ZZZZZZZZh7 = array();break;case "nweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week +7 days'))."' AND '".date("Y-m-d",strtotime('this week +13 days'))."'";$ZZZZZZZZh7 = array();break;case "tmonth": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-01")."' AND '".date("Y-m-t")."'";$ZZZZZZZZh7 = array();break;case "lmonth": $ZZZZZZZZZZZZy24 = date("Y-m-01 H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZz25 = date("Y-m-t H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZy24 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24, $field['uitype']);$ZZZZZZZZZZZZz25 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25, $field['uitype']);$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24 . " 00:00:00");$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";$ZZZZZZZZh7 = array();break;case "tyear": $ZZS1818.= " $fieldName BETWEEN '".date("Y-01-01")."' AND '".date("Y-12-t")."'";$ZZZZZZZZh7 = array();break;case "lyear": $ZZZZZZZZZZZZy24 = date("Y-01-01 H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZz25 = date("Y-12-t H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZy24 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24);$ZZZZZZZZZZZZz25 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25);$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZZZZZZZA00($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24 . " 00:00:00");$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZZZZZZZA00($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";$ZZZZZZZZh7 = array();break;case "nquarter": $ZZZZZZZZZZZZB11 = "'".date("Y-m-d",strtotime('+3 months'))."'";$ZZZZZZZZZZZZC22 = ZZZZZZZm12::ZZZZZZZZZC22($fieldName);$ZZZZZZZZZZZZD33 = ZZZZZZZm12::ZZZZZZZZZC22($ZZZZZZZZZZZZB11);$ZZZZZZZZZZZZE44 = ZZZZZZZm12::ZZZZZZZZZA00($fieldName);$ZZZZZZZZZZZZF55 = ZZZZZZZm12::ZZZZZZZZZA00($ZZZZZZZZZZZZB11);$ZZS1818.= " {$ZZZZZZZZZZZZC22} = {$ZZZZZZZZZZZZD33} AND {$ZZZZZZZZZZZZE44} = {$ZZZZZZZZZZZZF55} ";$ZZZZZZZZh7 = array();break;case "lquarter": $ZZZZZZZZZZZZG66 = "'".date("Y-m-d",strtotime('-3 months'))."'";$ZZZZZZZZZZZZC22 = ZZZZZZZm12::ZZZZZZZZZC22($fieldName);$ZZZZZZZZZZZZH77 = ZZZZZZZm12::ZZZZZZZZZC22($ZZZZZZZZZZZZG66);$ZZZZZZZZZZZZE44 = ZZZZZZZm12::ZZZZZZZZZA00($fieldName);$ZZZZZZZZZZZZI88 = ZZZZZZZm12::ZZZZZZZZZA00($ZZZZZZZZZZZZG66);$ZZS1818.= " {$ZZZZZZZZZZZZC22} = {$ZZZZZZZZZZZZH77} AND {$ZZZZZZZZZZZZE44} = {$ZZZZZZZZZZZZI88} ";$ZZZZZZZZh7 = array();break;case "gt": $ZZS1818.= " $fieldName > ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "lt": $ZZS1818.= " $fieldName < ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "egt": $ZZS1818.= " $fieldName >= ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "elt": $ZZS1818.= " $fieldName <= ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "unchecked": $ZZS1818.= " $fieldName = 0";$ZZZZZZZZh7 = array();break;case "checked": $ZZS1818.= " $fieldName = 1";$ZZZZZZZZh7 = array();break;case "assignedto": global $current_user;$ZZS1818.= " $fieldName LIKE ?";$ZZZZZZZZZZZZJ99 = $current_user->first_name;$ZZZZZZZZZZZZK1010 = $current_user->last_name;if($ZZZZZZZZZZZZJ99 == ""){$ZZZZZZZZZZZZL1111 = $ZZZZZZZZZZZZK1010;}else{$ZZZZZZZZZZZZL1111 = $ZZZZZZZZZZZZJ99." ".$ZZZZZZZZZZZZK1010;} $ZZZZZZZZh7 = array("%".$ZZZZZZZZZZZZL1111."%");break;}}else{$ZZS1818 = " ";} return array("sql"=>$ZZS1818,"param"=>$ZZZZZZZZh7);} function ZZZZZZZZZZZZM1212($ZZZZZZZZZZZZN1313,$ZZZc2){$ZZS1818 = "AND ";if($ZZZZZZZZZZZZN1313->connector =="OR"){$ZZS1818 = "OR ";} $ZZS1818.="(1=1 ";$ZZT1919 = count($ZZZZZZZZZZZZN1313->filters);$ZZZF55 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = $this->ZZZZZZZZZZZZk10($ZZZZZZZZZZZZN1313->filters[$Zf5],$ZZZc2);$ZZS1818.= $ZZZZZC22["sql"] . " ";if($ZZZZZC22["param"]!==null){if(is_array($ZZZZZC22["param"])){$ZZZF55 = array_merge($ZZZF55,$ZZZZZC22["param"]);}else{$ZZZF55[] = $ZZZZZC22["param"];}}} $ZZS1818.= ") ";return array("sql"=>$ZZS1818,"params"=>$ZZZF55);} function ZZZZZZZZZZZZO1414($ZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZQ1616,$ZZZT1919){$ZZT1919 = count($ZZZZZZZZZZZZQ1616);$ZZZZc2 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZQ1616[$Zf5]])){$ZZZZc2[] = $ZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZQ1616[$Zf5]];}} if(count($ZZZT1919) > 0){foreach($ZZZT1919 as $ZZZZZZZZZZZD33) {$ZZZZc2[] = array('tablename' => $ZZZZZZZZZZZD33['table'], 'columnname' => $ZZZZZZZZZZZD33['column'], 'fieldname' => $ZZZZZZZZZZZD33['name'], 'fieldlabel' => $ZZZZZZZZZZZD33['bareTitle'], 'uitype' => $ZZZZZZZZZZZD33['uitype'], 'typeofdata' => 'V~O', 'module' => 'X',);}} return $ZZZZc2;} function ZZZZZZZZZZZZR1717($ZZZZZZZZZZu20){$ZZZc2 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2 = array_merge($ZZZc2,$ZZZZZZZZZZu20[$Zf5]->ZZZZZZZZZZg6($Zf5));} return $ZZZc2;} function ZZZZZZZZZZZZS1818($ZZZZZZZZZZu20){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array();} return $ZZS1818;} function ZZZZZZZZZZZZT1919($ZZZZZZZZZZu20){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZu20[$Zf5]->ZZZZZZZZZZZP1515();} return $ZZS1818;} function ZZZZZZZZZZZZU2020($ZZZZZZZZZZu20){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZu20[$Zf5]->ZZZZZZZZZZZZV2121();} return $ZZS1818;} function ZZZZZZZZZZZZW2222(){$ZZq16 = " AND (1=1 ";$ZZT1919 = count($this->ZZZZZZZZZZZa0);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZX2323[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"])){if(!isset($this->ZZZZZZZZZZR1717[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"],false,$this->ZZZZZZZZZZZa0[$Zf5]);} $ZZq16.= "AND (`".$this->ZZZZZZZZZZR1717[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"]."`.`deleted` = 0 ";$ZZq16.= "OR `".$this->ZZZZZZZZZZR1717[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"]."`.`deleted` IS NULL) ";}} $ZZq16.=")";return $ZZq16;} function ZZZZZZZZZZZZX2323($ZZZZZZZZZZZZY2424,$includeDetails = false){$ZZS1818 = "";$ZZZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZY2424);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]]) && isset($ZZZZZZZZZZZZY2424[$Zf5]["sortDirection"]) && isset($ZZZZZZZZZZZZY2424[$Zf5]["sortAction"]) && in_array($ZZZZZZZZZZZZY2424[$Zf5]["sortAction"],array("sort","groupsort"))){$ZZZZS1818[] = $this->ZZZZZZZZZZZU2020($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]],$ZZZZZZZZZZZZY2424[$Zf5],$includeDetails);}} if(!empty($ZZZZS1818)){$ZZS1818= " ORDER BY ".implode(" , ",$ZZZZS1818);} return $ZZS1818;} function ZZZZZZZZZZZZZ2525($module){$ZZS1818 = $this->ZZZZZe4->ZZZZZw22($module->name,$module->name);if($module->relationDescr!==null){$ZZS1818 = $this->ZZZZZZZZZZZZZ2525($this->ZZZZZJ99[$module->relationDescr->joinModule])."-".$ZZS1818;} return $ZZS1818;} function ZZZZZZZZZZZZZa0($module,$ZZZZZJ99,$ZZZZZZZZZZZZQ1616,$ZZZT1919){$this->ZZZZZJ99 = array_merge(array($module),$ZZZZZJ99);$this->ZZZZZZZZZZR1717 = $this->ZZZZZZZZZZZZS1818($this->ZZZZZJ99);$this->ZZZZZZZZZZS1818 = array();$this->ZZZZZZZZZZZd3 = array();$this->ZZZZZZZZZZZf5 = array();$this->ZZZZZZZZZZU2020 = 0;$this->ZZZZZZZZZZX2323 = $this->ZZZZZZZZZZZZU2020($this->ZZZZZJ99);$this->ZZZZZZZZZZY2424 = $this->ZZZZZZZZZZZZT1919($this->ZZZZZJ99);$this->ZZZZZZZZZZZa0 = array(0);$this->ZZZZZZZZZZZe4 = array();$this->ZZZZZZZZZZZb1 = $this->ZZZZZZZZZZZZR1717($this->ZZZZZJ99);$this->ZZZZZZZZZZZc2 = $this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZZb1,$ZZZZZZZZZZZZQ1616,$ZZZT1919);$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZY2424[0],true);$ZZT1919 = count($this->ZZZZZJ99);if($this->ZZZZZZZZZZV2121 == true){for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZW2222[$Zf5] = $this->ZZZZZZZZZZZZZ2525($this->ZZZZZJ99[$Zf5])." ";}}else{for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZW2222[$Zf5] = "";}}} function ZZZZZZZZZZZZZb1($field,$ZZZZZZZZZZZZZc2,$ZZZZZZZZZZZZZd3, $ZZZZZZZZZZZA00 = true, $ZZZZZZZZZZZD33 = array()){$ZZZH77 = $this->ZZZZZZZZZZZC22($field,$ZZZZZZZZZZZZZc2,$ZZZZZZZZZZZZZd3, $ZZZZZZZZZZZA00, $ZZZZZZZZZZZD33);if(!$ZZZH77) {return false;} foreach($ZZZH77["fields"] as $Zu20=>$fieldName){$this->ZZZZZZZZZZZd3[$fieldName] = $ZZZH77["titles"][$Zu20];} $this->ZZZZZZZZZZZe4 = array_merge($this->ZZZZZZZZZZZe4,$ZZZH77["select"]);} function ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33){$ZZZZZZZZZZZZZe4 = array("avg" => array("args" => 1, "isExpr" => false, "fn" => "AVG",), "cnt" => array("args" => 1, "isExpr" => false, "fn" => "COUNT",), "min" => array("args" => 1, "isExpr" => false, "fn" => "MIN",), "max" => array("args" => 1, "isExpr" => false, "fn" => "MAX",), "sum" => array("args" => 1, "isExpr" =>false, "fn" => "SUM",), "plus" => array("args" => 2, "isExpr" =>true, "fn" => "+",), "minus" => array("args" => 2, "isExpr" =>true, "fn" => "-",), "mult" => array("args" => 2, "isExpr" =>true, "fn" => "*",), "div" => array("args" => 2, "isExpr" =>true, "fn" => "/",),);$ZZS1818 = "NULL";if(isset($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]) && count($ZZZZZZZZZZZD33["val"]) == $ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["args"] && count($ZZZZZZZZZZZD33["valType"]) == $ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["args"]){$ZZZH77 = array();for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["args"];$Zf5++){$ZZZZZZZZZZZZZf5 = "NULL";if(isset($ZZZZZZZZZZZD33["valType"][$Zf5]) && isset($ZZZZZZZZZZZD33["val"][$Zf5])){if($ZZZZZZZZZZZD33["valType"][$Zf5] == "c"){$ZZZZZC22 = str_replace(",",".",$ZZZZZZZZZZZD33["val"][$Zf5]);if(preg_match("/^([0-9]+)(\\.|,)?[0-9]{0,}$/",$ZZZZZC22)){$ZZZZZZZZZZZZZf5 = $ZZZZZC22;}}elseif($ZZZZZZZZZZZD33["valType"][$Zf5] == "f"){if(isset($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZD33["val"][$Zf5]])){$ZZZZZC22 = $this->ZZZZZZZZZZZC22($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZD33["val"][$Zf5]],null,null,false,false);$ZZZZZZZZZZZZZf5 = $ZZZZZC22["select"][0];}}elseif($ZZZZZZZZZZZD33["valType"][$Zf5] == "op"){$ZZZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"][$Zf5]);}} $ZZZH77[] = $ZZZZZZZZZZZZZf5;} if($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["isExpr"]){$ZZS1818 = "(". implode($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["fn"],$ZZZH77) .")";}else{$ZZS1818 = $ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["fn"]."(".implode($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["fn"],$ZZZH77) .")";}} return $ZZS1818;} function ZZZZZZZZZZZZZg6($ZZZc2){$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZH77 = "ROUND(".$this->ZZZZZZZZZZZQ1616($ZZZc2[$Zf5]["val"]).", {$ZZZZZZZZZZZF55}) AS `".$ZZZc2[$Zf5]['name']."`";$this->ZZZZZZZZZZZe4[] = $ZZZH77;$this->ZZZZZZZZZZZd3[$ZZZc2[$Zf5]['name']] = $ZZZc2[$Zf5]["title"];}} function ZZZZZZZZZZZZZh7($filters){$ZZT1919 = count($filters);$ZZZF55 = array();$ZZZZd3 = " WHERE (1=1 ";for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = $this->ZZZZZZZZZZZZM1212($filters[$Zf5],$this->ZZZZZZZZZZZb1);$ZZZZd3.= $ZZZZZC22["sql"];if(!empty($ZZZZZC22["params"])){$ZZZF55 = array_merge($ZZZF55,$ZZZZZC22["params"]);}} $this->ZZZZZZZZZZZf5 = $ZZZF55;$ZZZZd3.= ") ".$this->ZZZZZZZZZZZZW2222();return $ZZZZd3;} function ZZZZZZZZZZZZZi8(ZZZZZZZZZZH77 $module,$ZZZZZZZZZZZZQ1616,$filters,$ZZZZZJ99 = array(),$ZZZZZZZZZZZZY2424 = array(),$ZZZP1515 = array(),$ZZZZZZZZZZZZZj9 = false, $ZZZT1919 = array(), $ZZZZZZZZZZZZZk10 = array()){$ZZZZZZZZZZZZZl11 = array();$this->ZZZZZZZZZZZZZa0($module,$ZZZZZJ99,$ZZZZZZZZZZZZQ1616,$ZZZT1919);$ZZZO1414 = array();if($ZZZZZZZZZZZZZj9 == false){$ZZT1919 = count($this->ZZZZZZZZZZZc2);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){foreach($ZZZZZZZZZZZZY2424 as $ZZZZZZZZZZZZZm12) {if($this->ZZZZZZZZZZZc2[$Zf5]['fieldname'] == $ZZZZZZZZZZZZZm12['name']) {if(!empty($ZZZZZZZZZZZZZm12['dateGrouping'])) {array_push($ZZZZZZZZZZZZZl11, $this->ZZZZZZZZZZZc2[$Zf5]['fieldname']);$this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZc2[$Zf5], null, $ZZZZZZZZZZZZZm12['dateGrouping']);}}} if(!in_array($this->ZZZZZZZZZZZc2[$Zf5]['fieldname'], $ZZZZZZZZZZZZZl11)) {if($this->ZZZZZZZZZZZc2[$Zf5]['tablename'] !== '__virtual__') {$this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZc2[$Zf5],null,null);}}} $this->ZZZZZZZZZZZZZg6($ZZZT1919);} else{$ZZT1919 = count($ZZZZZZZZZZZZY2424);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]])){$ZZZZZZZZZZZZZd3 = null;if(isset($ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"]) && isset($this->ZZZZZZZZZZZg6[$ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"]])){$ZZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"];} if(isset($ZZZZZZZZZZZZY2424[$Zf5]["sortAction"]) && $ZZZZZZZZZZZZY2424[$Zf5]["sortAction"] =="nogroup"){$ZZZZZZZZZZZZZd3 = "nogroup";} $this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]],null,$ZZZZZZZZZZZZZd3);$ZZZH77 = $this->ZZZZZZZZZZZR1717($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]],$ZZZZZZZZZZZZY2424[$Zf5]);if(!empty($ZZZH77)){$ZZZO1414[] = $ZZZH77;}}} $ZZT1919 = count($ZZZP1515);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZZb1[$ZZZP1515[$Zf5]["selectedField"]])){$this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZb1[$ZZZP1515[$Zf5]["selectedField"]],$ZZZP1515[$Zf5]["value"],null);} foreach($ZZZT1919 as $ZZZZZZZZZZZD33) {if($ZZZZZZZZZZZD33["name"] == $ZZZP1515[$Zf5]["selectedField"]) {$this->ZZZZZZZZZZZZZb1(null, $ZZZP1515[$Zf5]["value"], null, true, $ZZZZZZZZZZZD33);}}} $ZZT1919 = count($ZZZZZZZZZZZZY2424);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"]) && !empty($ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"])){foreach($this->ZZZZZZZZZZZc2 as &$ZZZZZZZZZZZZZn13) {if($ZZZZZZZZZZZZZn13['fieldname'] == $ZZZZZZZZZZZZY2424[$Zf5]["name"]) {$ZZZZZZZZZZZZZn13['fieldname'] = $ZZZZZZZZZZZZZn13['fieldname'] . "_" . $ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"];$ZZZZZZZZZZZZZn13['dateGrouping'] = $ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"];}}}}} $ZZZZd3 = $this->ZZZZZZZZZZZZZh7($filters);$ZZZZS1818 = $this->ZZZZZZZZZZZZX2323($ZZZZZZZZZZZZY2424,!$ZZZZZZZZZZZZZj9);$ZZZZJ99 = "";if(!empty($ZZZO1414)){$ZZZZJ99= " GROUP BY ".implode(" , ",$ZZZO1414);} if(in_array($this->ZZZZZZZZZZY2424[0]['name'], array('oqc_offering'))) {$ZZZZZZZZZZZZZo14 = $this->ZZZZZZZZZZR1717[0][$this->ZZZZZZZZZZY2424[0]['name']];$ZZZZd3 .= " AND `$ZZZZZZZZZZZZZo14`.`is_latest` = 1 ";} $ZZZZZZZZZZX2323 = $this->ZZZZZZZZZZZZZp15($ZZZZZZZZZZZZY2424, $filters, $this->ZZZZZZZZZZY2424[0]['name'], $this->ZZZZZZZZZZS1818);$ZZZZZZZZZZZZZq16 = array();foreach($ZZZZZZZZZZZZY2424 as $ZZZZZZZZZZZZZr17) {if(in_array($ZZZZZZZZZZZZZr17['name'], $ZZZZZZZZZZZZZq16)) {continue;} if(isset($ZZZZZZZZZZZZZr17['showTop']) && $ZZZZZZZZZZZZZr17['showTop'] > 0) {$ZZZZZZZZZZZZZq16[] = $ZZZZZZZZZZZZZr17['name'];$this->ZZZZZZZZZZZf5 = array_merge($this->ZZZZZZZZZZZf5, $this->ZZZZZZZZZZZf5);}} $ZZq16 ="SELECT ".implode(" , ",$this->ZZZZZZZZZZZe4);$ZZq16.= " FROM ".$ZZZZZZZZZZX2323['mainTable']. " AS ".$this->ZZZZZZZZZZR1717[0][$this->ZZZZZZZZZZY2424[0]['name']];$ZZq16.= " ".implode(" ", $ZZZZZZZZZZX2323['joinTables']);$ZZq16.= $ZZZZd3;$ZZq16.= $ZZZZJ99;$ZZq16.= $ZZZZS1818;$ZZZZZZZZZZZZZs18 = $this->ZZZZZZZZZZZZZt19($ZZq16, $this->ZZZZZZZZZZZf5, $ZZZZZZZZZZZZZk10);$ZZq16.= $ZZZZZZZZZZZZZs18["sql"];return array("sql" => $ZZq16, "params" => $this->ZZZZZZZZZZZf5, "cols" => $this->ZZZZZZZZZZZd3, "fields" => $this->ZZZZZZZZZZZc2, "meta" => $ZZZZZZZZZZZZZs18["meta"],);} function ZZZZZZZZZZZZZt19($ZZq16, $ZZZF55, $ZZZZZZZZZZZZZk10){$ZZZZZZZZZZZZZs18 = array("meta" => array(), "sql" => '');if(!isset($ZZZZZZZZZZZZZk10["pagination"])) {$ZZZZZZZZZZZZZk10["pagination"] = false;} if(!isset($ZZZZZZZZZZZZZk10['records']) && $ZZZZZZZZZZZZZk10["pagination"]) {$query = 'SELECT COUNT(*) AS `COUNT` FROM ('.$ZZq16.') AS `counterTable`';$ZZn13 = $this->db->ZZZE44($query, $ZZZF55);$ZZZZZZZZZZZZZk10['records'] = (int) $ZZn13[0]['COUNT'];} if(isset($ZZZZZZZZZZZZZk10['records']) && isset($ZZZZZZZZZZZZZk10['limit']) && $ZZZZZZZZZZZZZk10["pagination"]) {$limit = (int) $ZZZZZZZZZZZZZk10['limit'];$ZZZZZZZZZZZZZu20 = 0;if($ZZZZZZZZZZZZZk10['records'] > 0 && $limit > 0) {$ZZZZZZZZZZZZZu20 = (int) ceil($ZZZZZZZZZZZZZk10['records'] / $limit);} $ZZZZZZZZZZZZZk10['pages'] = $ZZZZZZZZZZZZZu20;if(isset($ZZZZZZZZZZZZZk10['currentPage'])) {if($ZZZZZZZZZZZZZk10['currentPage'] > $ZZZZZZZZZZZZZk10['pages']) {$ZZZZZZZZZZZZZk10['currentPage'] = 1;} $ZZZZZZZZe4 = ($ZZZZZZZZZZZZZk10['currentPage'] - 1) * $limit;} else {$ZZZZZZZZe4 = 0;$ZZZZZZZZZZZZZk10['currentPage'] = 1;} $ZZZZZZZZZZZZZs18["sql"] = " LIMIT $ZZZZZZZZe4, $limit";} $ZZZZZZZZZZZZZs18["meta"] = $ZZZZZZZZZZZZZk10;return $ZZZZZZZZZZZZZs18;} function ZZZZZZZZZZZZZv21($ZZZZZZZZZZZZY2424, $filters) {$ZZZZZZZZZZZZZw22 = array('limit' => 0, 'column' => false, 'sortDirection' => 'DESC', 'table' => false, 'tableAlias' => false, 'sql' => '',);if(empty($ZZZZZZZZZZZZY2424)) {return false;} $ZZZZZZi8 = 0;foreach($ZZZZZZZZZZZZY2424 as $ZZZZZZZZZZZZZx23 => $ZZZZZZZZZZZZZy24){if(isset($ZZZZZZZZZZZZZy24['showAggregates'])) {$ZZZZZZi8 = $ZZZZZZZZZZZZZx23;break;}} if(!isset($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop']) || empty($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop'])) {return false;} if($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop'] > 0) {$ZZZZZZZZZZZZZw22['limit'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop'];$ZZZZZZZZZZZZZw22['field'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['name'];$ZZZZZZZZZZZZZw22['aggregate'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['aggregate'];$ZZZZZZZZZZZZZw22['aggregateSortDirection'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['sortDirection'];$ZZZ2525 = $this->ZZZZZZZZZZZZZz25($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['name']);$ZZZZZZZZZZZZZw22 = array_merge($ZZZZZZZZZZZZZw22, $ZZZ2525);if($ZZZZZZZZZZZZZw22['aggregate']) {$ZZZZZZZZZZZZZA00 = false;$ZZZZZZZZZZZZZw22['aggregateTable'] = false;$ZZZZZZZZZZZZZw22['aggregateTableAlias'] = false;$ZZZZZC22 = explode("_", $ZZZZZZZZZZZZZw22['aggregate'], 2);if(in_array($ZZZZZC22[0], array("sum", "avg", "count"))) {$ZZZZZZZZZZZZZA00 = $ZZZZZC22[0];array_shift($ZZZZZC22);$ZZZZZZZZZZZZZB11 = $ZZZZZC22[0];} else {$ZZZZZZZZZZZZZB11 = $ZZZZZZZZZZZZZw22['aggregate'];} $ZZZ2525 = $this->ZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZw22['aggregateType'] = $ZZZZZZZZZZZZZA00;$ZZZZZZZZZZZZZw22['aggregateColumn'] = $ZZZ2525['column'];$ZZZZZZZZZZZZZw22['aggregateTable'] = $ZZZ2525['table'];$ZZZZZZZZZZZZZw22['aggregateTableAlias'] = $ZZZ2525['tableAlias'];$ZZZZZZZZZZZZZw22['aggregateColumn'] = str_replace("#alias#", $ZZZ2525['tableAlias'], $ZZZZZZZZZZZZZw22['aggregateColumn']);} $ZZZZx23 = $ZZZZZZZZZZZZZw22['table'];$ZZZZZZZZZZZZZo14 = $ZZZZZZZZZZZZZw22['tableAlias'];$ZZZZZZZW2222 = $ZZZZZZZZZZZZZw22['column'];$limit = $ZZZZZZZZZZZZZw22['limit'];$aggregateColumn= $ZZZZZZZZZZZZZw22['aggregateColumn'];$ZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZw22['aggregateTableAlias'];$ZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZZw22['aggregateSortDirection'];$ZZZZZZZZZZZZZA00 = $ZZZZZZZZZZZZZw22['aggregateType'];$ZZZZZZZZZZZZZE44 = " `$ZZZZZZZZZZZZZC22`.`$aggregateColumn` ";if($ZZZZZZZZZZZZZA00 && in_array(strtoupper($ZZZZZZZZZZZZZA00), array('SUM', 'COUNT', 'AVG'))) {$ZZZZZZZZZZZZZE44 = " $ZZZZZZZZZZZZZA00($ZZZZZZZZZZZZZE44) ";} $ZZZZd3 = $this->ZZZZZZZZZZZZZh7($filters);$ZZq16 = "SELECT * FROM `".$ZZZZx23."` WHERE `".$ZZZZx23."`.`".$ZZZZZZZW2222."` IN (SELECT * FROM (SELECT `".$ZZZZZZZZZZZZZo14."`.`".$ZZZZZZZW2222."` FROM `".$this->ZZZZZZZZZZY2424[0]['name']."` AS ".$this->ZZZZZZZZZZR1717[0][$this->ZZZZZZZZZZY2424[0]['name']]." ".implode("\n", $this->ZZZZZZZZZZS1818)." $ZZZZd3 GROUP BY `".$ZZZZZZZZZZZZZo14."`.`".$ZZZZZZZW2222."` ORDER BY $ZZZZZZZZZZZZZE44 ".$ZZZZZZZZZZZZZD33." LIMIT $limit) AS tmp_limit_table) ";$ZZZZZZZZZZZZZw22['sql'] = "($ZZq16)";} return $ZZZZZZZZZZZZZw22;} function ZZZZZZZZZZZZZz25($field) {$r17 = array();foreach($this->ZZZZZZZZZZZb1 as $ZZZZZZZZZZZZZF55) {if ($ZZZZZZZZZZZZZF55['fieldname'] == $field) {$r17['column'] = $ZZZZZZZZZZZZZF55['columnname'];$r17['table'] = $ZZZZZZZZZZZZZF55['tablename'];$r17['tableAlias'] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZZF55['module']][$ZZZZZZZZZZZZZF55['tablename']];break;}} return $r17;} function ZZZZZZZZZZZZZp15($ZZZZZZZZZZZZY2424, $filters, $ZZZZZZZZZZY2424, $ZZZZZZZZZZZZZG66) {$ZZZZZZZZZZZZZw22 = $this->ZZZZZZZZZZZZZv21($ZZZZZZZZZZZZY2424, $filters);if($ZZZZZZZZZZZZZw22) {if($ZZZZZZZZZZY2424 == $ZZZZZZZZZZZZZw22['table']) {$ZZZZZZZZZZY2424 = $ZZZZZZZZZZZZZw22['sql'];} foreach($ZZZZZZZZZZZZZG66 as &$ZZZZZZZZZZZX2323) {$ZZZZZZZZZZZZZH77 = strpos($ZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZw22['table']);if($ZZZZZZZZZZZZZH77) {$ZZZZZZZZZZZX2323 = str_replace("`".$ZZZZZZZZZZZZZw22['table']."`", $ZZZZZZZZZZZZZw22['sql'], $ZZZZZZZZZZZX2323);break;}}} $r17 = array('mainTable' => $ZZZZZZZZZZY2424, 'joinTables' => $ZZZZZZZZZZZZZG66,);return $r17;}} class ZZZZZZZZZZZZZI88{protected $db;protected $ZZZZZe4;protected $ZZZR1717 = array();function __construct(ZZp15 $db, ZZZZZf5 $ZZZZZe4, $ZZZR1717 = array()){$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZR1717 = $ZZZR1717;} function translate($Zu20,$ZZZZZZZZZZZZZJ99 = false) {if(isset($this->ZZZR1717[$Zu20])) {return $this->ZZZR1717[$Zu20];} return $ZZZZZZZZZZZZZJ99;} function ZZZZZZZZZZZZZK1010($G66) {$ZZZZZZZZZZZZZL1111 = array();foreach($G66 as $Zu20 => $value) {$ZZZZZZZZZZZZZM1212 = $this->translate($Zu20);if($ZZZZZZZZZZZZZM1212) {$value = $ZZZZZZZZZZZZZM1212;} $ZZZZZZZZZZZZZL1111[$Zu20] = $value;} return $ZZZZZZZZZZZZZL1111;} function ZZZZZZZZZZZZZN1313($module,$ZZZZc2,$filters,$ZZZZZJ99 = array(),$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9 = false,$isCrosstab = true,$ZZZZZZZZZZZZZO1414 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd",$ZZZZZZZZZZZZZP1515 = false, $ZZZT1919 = array(), $ZZZZZZZZZZZZZk10 = array(), ARUser $ZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZZZZR1717 = new ZZZZZZZZZZQ1616($this->db,$this->ZZZZZe4, false, $ZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZS1818 = array();$ZZT1919 = count($ZZZZZJ99);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZS1818[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);} $ZZq16 = $ZZZZZZZZZZZZZR1717->ZZZZZZZZZZZZZi8($module,$ZZZZc2,$filters,$ZZZZZZZZZZZZZS1818,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9,$ZZZT1919,$ZZZZZZZZZZZZZk10);$this->db->ZZZI88("SET NAMES utf8", array());$ZZS1818 = $this->db->ZZZE44($ZZq16["sql"],$ZZq16["params"]);array_unshift($ZZZZZZZZZZZZZS1818,$module);$ZZZZZZZZZZZZZT1919 = new ZZZZZZZZZZZZZU2020($ZZZO1414,$ZZq16["fields"],$ZZZZZZZZZZZZZj9);$ZZZZZZZZZZZZZT1919->ZZZZZZZZZZZZZV2121($ZZS1818);$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZX2323($this->ZZZZZe4,$this->db,$ZZq16["fields"],$ZZZO1414,$ZZZZZZZZZZZZZS1818,$dateFormat,$ZZZZZZZZZZZZZP1515);$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818);$ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZK1010($ZZq16["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){if($aggregateColumn){$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZ2525($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);}else{$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZa0($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);} $ZZS1818 = $ZZZZZZZZZZZZZY2424->ZZZZZZZZZZZZZZb1($ZZS1818,$ZZZO1414,$ZZZP1515,$ZZq16["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZK1010($ZZS1818["cols"]);if($ZZZZZZZZZZZZZO1414){$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZZc2();$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818["data"]);} $ZZS1818["meta"] = $ZZq16["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZZd3($ZZZZZZZZZZZZZS1818, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);return $ZZS1818;} function ZZZZZZZZZZZZZZd3($ZZZZZZZZZZu20, $ZZZZZZZZZZZn13, $r17, $isCrosstab = false, $aggregateColumn = false) {$ZZZZZZZZZZZZZZe4 = array();if(!$aggregateColumn) {$ZZZZZZZZZZZZZZf5 = array();foreach ($ZZZZZZZZZZZn13 as $ZZZZy24 => $title) {$ZZZZZZZZZZZZZZg6 = strstr($ZZZZy24,'_');if(in_array(substr($ZZZZZZZZZZZZZZg6, -4), array('_sum','_min','_max','_cnt'))){if($isCrosstab){$ZZZZZZZZZZZZZZg6 = strstr(ltrim(substr($ZZZZZZZZZZZZZZg6,0,-4),'_'),'_');} else {$ZZZZZZZZZZZZZZg6 = substr($ZZZZZZZZZZZZZZg6,0,-4);}} $ZZZZZZZZZZZZZZf5[$ZZZZy24] = $ZZZZZZZZZZZZZZg6;} foreach ($ZZZZZZZZZZu20 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZZh7();foreach ($ZZZc2 as $field) {if(in_array(strstr($field['name'],'_'), $ZZZZZZZZZZZZZZf5)){$ZZZZZZZZZZZZZZi8 = array_keys($ZZZZZZZZZZZZZZf5, strstr($field['name'],'_'));foreach ($ZZZZZZZZZZZZZZi8 as $ZZZZZZZZZZZZZZj9) {$ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZj9] = $field['type'];}}}}} else {$ZZZZZZZZZZZZZZk10 = array();foreach ($ZZZZZZZZZZu20 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZZh7();foreach ($ZZZc2 as $field) {if($field['type'] == 'integer'){$ZZZZZZZZZZZZZZk10[] = $field['name'];}}} $ZZZZZZZZZZZZZZl11 = array();foreach ($this->ZZZR1717 as $Zu20 => $ZZZZZx23) {$ZZZZZZZZZZZB11 = substr($Zu20, -4);if($ZZZZZZZZZZZB11 == '_cnt' || in_array($Zu20, $ZZZZZZZZZZZZZZk10)) {$ZZZZZZZZZZZZZZe4[$ZZZZZx23] = 'integer';} elseif (in_array($ZZZZZZZZZZZB11, array('_sum','_min','_max'))) {foreach ($ZZZZZZZZZZZZZZk10 as $field) {if(strpos($Zu20, $field) !== false){$ZZZZZZZZZZZZZZe4[$ZZZZZx23] = 'integer';}}}}} return $ZZZZZZZZZZZZZZe4;}}
class ZZZZZZZZZZZZZZm12 extends ZZZZZZZZZZZZZI88{protected $ZZZZZZZZZZZZZZn13 = array();protected $ZZZZZZZZZZZZZZo14 = array();protected $ZZZZZZZZZZZZZZp15 = array();protected $ZZZZZZZZZZZZZZq16 = array();protected $ZZZZZZZZZZZZZZr17 = array();protected $ZZZZZZZZZZZZZZs18 = "";protected $ZZZZZZZZZZZZZZt19 = array();protected $ZZZZZZZZZZZZZZu20 = array();protected $ZZZY2424 = array();function ZZZZZZZZZZZZZZv21($ZZZZZZZZZZu20){$ZZT1919 = count($ZZZZZZZZZZu20);$ZZS1818 = 0;$ZZZZZZZZZZZZZZw22 = array();$ZZZZZZZZZZZZZZx23 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZu20[$Zf5]->joinModule == 0){$ZZZZZZZZZZu20[$Zf5]->joinModule = -1;$this->ZZZZZZZZZZZZZZn13[] = $Zf5;$ZZZZZZZZZZZZZZw22[$Zf5+1] = array();$ZZS1818++;} if($ZZZZZZZZZZu20[$Zf5]->joinModule>-1 && $ZZZZZZZZZZZZZZx23[$ZZZZZZZZZZu20[$Zf5]->joinModule]){$ZZZZZZZZZZZZZZw22[$ZZZZZZZZZZZZZZx23[$ZZZZZZZZZZu20[$Zf5]->joinModule]][$Zf5] = $ZZZZZZZZZZu20[$Zf5]->name;$ZZZZZZZZZZZZZZx23[$Zf5+1] = $ZZZZZZZZZZZZZZx23[$ZZZZZZZZZZu20[$Zf5]->joinModule];}else{$ZZZZZZZZZZZZZZx23[$Zf5+1] = $Zf5+1;}} if(!empty($ZZZZZZZZZZZZZZw22)){$this->ZZZZZZZZZZZZZZq16 = array_values(call_user_func_array("array_intersect",$ZZZZZZZZZZZZZZw22));} $this->ZZZZZZZZZZZZZZr17 = array();foreach($ZZZZZZZZZZZZZZw22 as $ZZZZZZZZZZZZZZy24 => $ZZZZZZZZZZZZZZz25){foreach($ZZZZZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZA00 => $ZZZZZZZZZZZZZZB11){if(in_array($ZZZZZZZZZZZZZZB11,$this->ZZZZZZZZZZZZZZq16)){if(!isset($this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZB11])){$this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZB11] = array();} $this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZy24] = $ZZZZZZZZZZZZZZA00+1;}}} return $ZZS1818;} function ZZZZZZZZZZZZZZC22($module,$ZZZZZJ99){$ZZS1818 = unserialize(serialize($ZZZZZJ99));$ZZS1818[$module]->joinModule = -1;$ZZT1919 = count($ZZS1818);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZS1818[$Zf5]->joinModule == $module+1){$ZZS1818[$Zf5]->joinModule=0;}} $this->ZZZZZZZZZZZZZZo14 = array($module+1);$this->ZZZZZZZZZZZZZZp15 = array($module+1 => 0);do{$ZZZH77 = count($this->ZZZZZZZZZZZZZZo14);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if((in_array($ZZS1818[$Zf5]->joinModule,$this->ZZZZZZZZZZZZZZo14)||$ZZS1818[$Zf5]->joinModule==0) && !in_array($Zf5+1,$this->ZZZZZZZZZZZZZZo14)){$this->ZZZZZZZZZZZZZZo14[] = $Zf5+1;$this->ZZZZZZZZZZZZZZp15[$Zf5+1] = count($this->ZZZZZZZZZZZZZZp15);if(!$ZZS1818[$Zf5]->joinModule==0){$ZZS1818[$Zf5]->joinModule = $this->ZZZZZZZZZZZZZZp15[$ZZS1818[$Zf5]->joinModule];}}}}while($ZZZH77 < count($this->ZZZZZZZZZZZZZZo14));$ZZZZZZZZZZZZZZD33 = array();$ZZT1919 = count($this->ZZZZZZZZZZZZZZo14);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZD33[] = $ZZS1818[$this->ZZZZZZZZZZZZZZo14[$Zf5]-1];} return $ZZZZZZZZZZZZZZD33;} function ZZZZZZZZZZZZZZE44($filters){$ZZZH77 = unserialize(serialize($filters));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZH77[$Zf5];$ZZZZZZZZZZZZZZF55 = count($ZZZH77[$Zf5]->filters);$ZZZZZZZZZZZZZZG66 = array();for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5]->filters[$ZZZZZW2222]->fieldName,2);if(!in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZZZZZZZZZZZZZG66[] = $ZZZZZW2222;}else{$ZZZZZC22[0] = $this->ZZZZZZZZZZZZZZp15[$ZZZZZC22[0]];$ZZZH77[$Zf5]->filters[$ZZZZZW2222]->fieldName = $ZZZZZC22[0]."_".$ZZZZZC22[1];}} $ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZG66)-1;for($ZZZZZW2222 = $ZZZZZZZZZZZZZZF55;$ZZZZZW2222>-1;$ZZZZZW2222--){array_splice($ZZS1818[$Zf5]->filters,$ZZZZZZZZZZZZZZG66[$ZZZZZW2222],1);}} return $ZZS1818;} function ZZZZZZZZZZZZZZH77($ZZZc2,$module){$ZZZH77 = unserialize(serialize($ZZZc2));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5],2);if(in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZS1818[] = array_search($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)."_".$ZZZZZC22[1];}elseif($ZZZZZC22[0]=="00"){$ZZZZZZZZZZZZZZI88 = explode("_",$ZZZZZC22[1],2);$ZZS1818[] = "0_".$module."_".$ZZZZZZZZZZZZZZI88[1];}} return $ZZS1818;} function ZZZZZZZZZZZZZZJ99($ZZZZJ99,$module){$ZZZH77 = unserialize(serialize($ZZZZJ99));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5]["name"],2);$ZZZZZZZZZZZZZZI88 = explode("_",$ZZZZZC22[1],2);$ZZZZZZZZZZZZZZK1010 = $ZZZH77[$Zf5]["name"];if(in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZZH77[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZp15[$ZZZZZC22[0]]."_".$ZZZZZC22[1];}elseif(isset($this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZI88[0]])){$ZZZH77[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZp15[$this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZI88[0]][$this->ZZZZZZZZZZZZZZo14[0]]]."_".$ZZZZZC22[1];if(!in_array($ZZZH77[$Zf5]["name"],$this->ZZZZZZZZZZZZZZt19)){$this->ZZZZZZZZZZZZZZt19[] = $ZZZH77[$Zf5]["name"];$this->ZZZZZZZZZZZZZZu20[$ZZZH77[$Zf5]["name"]] = $ZZZZZZZZZZZZZZK1010;}}elseif($ZZZH77[$Zf5]["name"] =="00_ALL_assigned_user_id"){$ZZZH77[$Zf5]["name"] = "0_".$module."_assigned_user_id";$this->ZZZZZZZZZZZZZZt19[] = $ZZZH77[$Zf5]["name"];$this->ZZZZZZZZZZZZZZu20[$ZZZH77[$Zf5]["name"]] = $ZZZZZZZZZZZZZZK1010;} if(isset($ZZZH77[$Zf5]["aggregate"]) && $ZZZH77[$Zf5]["aggregate"] == $ZZZZZZZZZZZZZZK1010){$ZZZH77[$Zf5]["aggregate"] = $ZZZH77[$Zf5]["name"];} $ZZS1818[] = $ZZZH77[$Zf5];} $this->commonFieldsCount = count($this->ZZZZZZZZZZZZZZt19);return $ZZS1818;} function ZZZZZZZZZZZZZZL1111($ZZZP1515){$ZZZH77 = unserialize(serialize($ZZZP1515));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5]["selectedField"],2);if(in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZZH77[$Zf5]["selectedField"] = $this->ZZZZZZZZZZZZZZp15[$ZZZZZC22[0]]."_".$ZZZZZC22[1];$ZZS1818[] = $ZZZH77[$Zf5];}} return $ZZS1818;} function ZZZZZZZZZZZZZZM1212($ZZq16,$prefix){$ZZZZZZZZZZZZZZN1313 = "SELECT DISTINCT `date_field` ";$ZZZZZZZZZZZZZZt19 = "";if(!empty($this->commonFieldsCount)){$ZZZZZZZZZZZZZZt19 = array();$ZZT1919 = $this->commonFieldsCount;for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZt19[] = "c_".$Zf5;if($this->ZZZZZZZZZZZZZZu20[$this->ZZZZZZZZZZZZZZt19[$Zf5]]!=="00_ALL_assigned_user_id"){$ZZZZZC22 = explode("_",$this->ZZZZZZZZZZZZZZt19[$Zf5]);$field = $this->db->ZZU2020($ZZZZZC22[1],$ZZZZZC22[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZZe4->ZZZZZI88($field,$this->db,false,$ZZZZZC22[1])){$ZZZZZZZZZZZZZZt19[] = "c_".$Zf5."_setype";$ZZZZZZZZZZZZZZt19[] = "c_".$Zf5."_id";}}} $ZZZZZZZZZZZZZZt19 = ", ".implode(", ",$ZZZZZZZZZZZZZZt19);} $ZZZZZZZZZZZZZZN1313.= $ZZZZZZZZZZZZZZt19." FROM (";$ZZZZZZZZZZZZZZO1414 = array();$ZZT1919 = count($ZZq16);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZZZZZZZZZZZZO1414[] = "SELECT `date_field` $ZZZZZZZZZZZZZZt19 FROM ".$ZZq16[$Zf5]["table"];}} $ZZZZZZZZZZZZZZN1313.= implode(" UNION ",$ZZZZZZZZZZZZZZO1414);$ZZZZZZZZZZZZZZN1313.= ")`date_fields`";$ZZZZZZZZZZZZZZP1515 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_{$prefix}_union AS ($ZZZZZZZZZZZZZZN1313)";$this->ZZZZZZZZZZZZZZs18 = "ar_temp_".$prefix."_union";return $ZZZZZZZZZZZZZZP1515;} function ZZZZZZZZZZZZZZQ1616(&$ZZq16,$ZZZZZR1717){$ZZZZZZZZZZZZZZR1717 = array_keys($ZZq16["cols"]);$ZZZZZZZZZZZZZZN1313 = "SELECT ";$ZZZZZZZZZZZZZZN1313.= "`combined`.`{$ZZZZZZZZZZZZZZR1717[0]}` AS `date_field` ";array_shift($ZZZZZZZZZZZZZZR1717);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZN1313.= ", `combined`.`{$ZZZZZZZZZZZZZZR1717[$Zf5]}` AS `c_$Zf5` ";if($ZZZZZZZZZZZZZZR1717[$Zf5]!=="00_ALL_assigned_user_id"){$ZZZZZC22 = $this->db->ZZZm12($ZZZZZZZZZZZZZZR1717[$Zf5]);$field = $this->db->ZZU2020($ZZZZZC22[1],$ZZZZZC22[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZZe4->ZZZZZI88($field,$this->db,false,$ZZZZZC22[1])){$ZZZZZZZZZZZZZZN1313.=", `combined`.`{$ZZZZZZZZZZZZZZR1717[$Zf5]}_setype` AS `c_{$Zf5}_setype` ";$ZZZZZZZZZZZZZZN1313.=", `combined`.`{$ZZZZZZZZZZZZZZR1717[$Zf5]}_id` AS `c_{$Zf5}_id` ";}}} $ZZZZZZZZZZZZZZN1313.= " FROM ({$ZZq16["sql"]}) `combined`";$ZZZZZZZZZZZZZZP1515 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_$ZZZZZR1717 AS ($ZZZZZZZZZZZZZZN1313)";$ZZq16["table"] = "ar_temp_$ZZZZZR1717";$ZZq16["createTmpTable"] = $ZZZZZZZZZZZZZZP1515;$ZZq16["fixTable"] = "UPDATE ".$ZZq16["table"]." SET `date_field` ='-' WHERE `date_field` IS NULL";$ZZq16["removeTable"] = "DROP TEMPORARY TABLE IF EXISTS ".$ZZq16["table"];} function ZZZZZZZZZZZZZZS1818(&$ZZq16){$ZZZZZZZZZZZZZZR1717 = array_keys($ZZq16["cols"]);$ZZZH77 = array_shift($ZZZZZZZZZZZZZZR1717);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZZZZT1919 = array($ZZZH77=> $ZZq16["cols"][$ZZZH77]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZZZZZZZZZZZZR1717[$Zf5],2);$ZZZZZZZZZZZm12 = array_search($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZp15);$ZZZZZZZZZZZZZZT1919[$ZZZZZZZZZZZm12."_".$ZZZZZC22[1]] = $ZZq16["cols"][$ZZZZZZZZZZZZZZR1717[$Zf5]];$ZZq16["sql"] = str_replace($ZZZZZZZZZZZZZZR1717[$Zf5],$ZZZZZZZZZZZm12."_".$ZZZZZC22[1],$ZZq16["sql"]);} $ZZT1919 = count($ZZq16["fields"]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZq16["fields"][$Zf5]["fieldname"],2);$ZZZZZZZZZZZm12 = array_search($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZp15);$ZZq16["fields"][$Zf5]["fieldname"] = $ZZZZZZZZZZZm12."_".$ZZZZZC22[1];$ZZq16["fields"][$Zf5]["module"] = $ZZZZZZZZZZZm12;} $ZZq16["cols"] = $ZZZZZZZZZZZZZZT1919;} function ZZZZZZZZZZZZZZU2020($ZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZZZZV2121,$ZZZZc2,$filters,$ZZZZZJ99 = array(),$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9 = false){$this->ZZZZZZZZZZZZZZt19 = array();$ZZZZZZZZZZZZZS1818 = array();$ZZZZZJ99 = $this->ZZZZZZZZZZZZZZC22($ZZZZZZZZZZZZZZV2121,$ZZZZZJ99);$ZZZZZZZZZZG66 = array_shift($ZZZZZJ99);$ZZT1919 = count($ZZZZZJ99);$filters = $this->ZZZZZZZZZZZZZZE44($filters);$ZZZZc2 = $this->ZZZZZZZZZZZZZZH77($ZZZZc2,$ZZZZZZZZZZG66->name);$ZZZO1414 = $this->ZZZZZZZZZZZZZZJ99($ZZZO1414,$ZZZZZZZZZZG66->name);$ZZZP1515 = $this->ZZZZZZZZZZZZZZL1111($ZZZP1515);if(count($ZZZZc2)== 0 || count($ZZZP1515)== 0 ||count($ZZZO1414)== 0){return null;} for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZS1818[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);} $module = new ZZZZZZZZZZH77($ZZZZZZZZZZG66->name,$this->db,$this->ZZZZZe4);$ZZq16 = $ZZZZZZZZZZZZZR1717->ZZZZZZZZZZZZZi8($module,$ZZZZc2,$filters,$ZZZZZZZZZZZZZS1818,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9);$this->ZZZZZZZZZZZZZZS1818($ZZq16);$ZZq16["commonFields"] = $this->ZZZZZZZZZZZZZZt19;return $ZZq16;} function ZZZZZZZZZZZZZZW2222($ZZZZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZR1717, $ZZZZZZZZZZZZZZY2424,$ZZZZZZZZZZZZZZs18,$ZZZO1414, $ZZZZZZZZZZZZZk10 = array()){$ZZZZZZZZZZS1818 = array();$ZZZZR1717 = array();$ZZZZZZZZZZZn13 = array("date_field"=>"Date");$ZZZc2 = array();$ZZT1919 = $this->commonFieldsCount;$ZZZZZZZZZZZZZZt19 = "";$ZZZZZZZZZZZZZZZ2525 = $ZZT1919;$field = array();$field["fieldname_org"] = "date_field";$field["fieldname"] = "date_field";$field["module"] = 0;$field["uitype"] = 'date';$ZZZc2[] = $field;if(!empty($ZZZZZZZZZZZZZZY2424[1]["commonFields"])){$ZZZZZZZZZZZZZZt19 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZt19[] = "`t{{i}}`.`c_".$Zf5."` = `u`.`c_".$Zf5."`";$ZZZZR1717[] = "`u`.`c_".$Zf5."` AS `".$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]."`";$ZZZZZC22 = explode("_",$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]],3);if($ZZZZZC22[0]=="00"){$field = array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "bareTitle"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "availableValues" =>array(),);}else{$field = $this->db->ZZU2020($ZZZZZC22[1],$ZZZZZC22[2]);} $field["fieldname_org"] = $field["fieldname"];$field["fieldname"] = $this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]];$field["module"] = $ZZZZZC22[0]-1;if($this->ZZZZZe4->ZZZZZI88($field,$this->db,false,$ZZZZZC22[1])){$ZZZZR1717[] = "`u`.`c_".$Zf5."_id` AS `".$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]."_id`";$ZZZZR1717[] = "`u`.`c_".$Zf5."_setype` AS `".$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]."_setype`";} $ZZZc2[] = $field;if($ZZZZZC22[0]=="00"){$ZZZZZZZZZZZn13[$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]] = "Assigned To";}else{$ZZZZZZZZZZZn13[$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]] = $this->ZZZZZe4->ZZZZZw22($ZZZZZC22[1],$ZZZZZC22[1])." ".$this->ZZZZZe4->ZZZZZw22($field["fieldlabel"],$ZZZZZC22[1]);}} $ZZZZZZZZZZZZZZt19 = " AND ".implode(" AND ",$ZZZZZZZZZZZZZZt19);} array_unshift($ZZZO1414,"tmp");$ZZT1919 = count($ZZZZZZZZZZZZZZY2424);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZY2424[$Zf5]!==null){$ZZZZZZZZZZS1818[$Zf5] = "LEFT JOIN ".$ZZZZZZZZZZZZZZY2424[$Zf5]["table"]." `t".$Zf5."` ON (`t".$Zf5."`.`date_field`=`u`.`date_field` ".str_replace("{{i}}",$Zf5,$ZZZZZZZZZZZZZZt19).")";$ZZZZZZZZZZZZZZR1717 = array_keys($ZZZZZZZZZZZZZZY2424[$Zf5]["cols"]);array_shift($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZR1717);for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZZZZZZZZZZZZZZ2525;$ZZZZZW2222++){array_shift($ZZZZZZZZZZZZZZR1717);} for($ZZZZZW2222=$ZZZZZZZZZZZZZZZ2525;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){$ZZZZR1717[] = "`t".$Zf5."`.`c_".$ZZZZZW2222."` AS `".$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222-$ZZZZZZZZZZZZZZZ2525]."`";$ZZZZZZZZZZZn13[$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222-$ZZZZZZZZZZZZZZZ2525]] = $ZZZZZZZZZZZZZZY2424[$Zf5]["cols"][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222-$ZZZZZZZZZZZZZZZ2525]];} array_shift($ZZZO1414);}} $ZZZZS1818 = array();$ZZT1919 = count($ZZZc2);if($ZZZO1414[0]["sortAction"] =="groupsort"){if($ZZZO1414[0]["sortDirection"]=="DESC"){$ZZZZZZZX2323 = "DESC";}else{$ZZZZZZZX2323 = "ASC";} if(isset($ZZZO1414[0]["dateGrouping"]) && ($ZZZO1414[0]["dateGrouping"]=="monthAndYear" ||$ZZZO1414[0]["dateGrouping"]=="weekAndYear")){$ZZZZS1818[] = "LEFT(`u`.`date_field`,4) $ZZZZZZZX2323, CAST(MID(`u`.`date_field`,6,2) AS UNSIGNED) $ZZZZZZZX2323";}else{$ZZZZS1818[] = "`u`.`date_field` $ZZZZZZZX2323 ";}} for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($ZZZc2[$Zf5]["fieldname"]== $ZZZO1414[$Zf5]["name"]){if($ZZZO1414[$Zf5]["sortAction"] =="groupsort"){if($ZZZO1414[$Zf5]["sortDirection"]=="DESC"){$ZZZZS1818[] = "`u`.c_".($Zf5-1)." DESC ";}else{$ZZZZS1818[] = "`u`.c_".($Zf5-1)." ASC ";}}}} if(!empty($ZZZZS1818)){$ZZZZS1818 = " ORDER BY ".implode(" ,",$ZZZZS1818);}else{$ZZZZS1818 = "";} $ZZq16 = "SELECT `u`.`date_field`, ";$ZZq16.= implode(", ",$ZZZZR1717);$ZZq16.= "FROM ".$ZZZZZZZZZZZZZZs18." `u` ";$ZZq16.= implode(" ",$ZZZZZZZZZZS1818).$ZZZZS1818;$ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZX2323,array());$ZZZZZZZZZZZZZs18 = $ZZZZZZZZZZZZZR1717->ZZZZZZZZZZZZZt19($ZZq16, array(), $ZZZZZZZZZZZZZk10);$ZZq16.= $ZZZZZZZZZZZZZs18["sql"];$ZZZZZZZZZZZZZZZa0 = "DROP TEMPORARY TABLE IF EXISTS ".$this->ZZZZZZZZZZZZZZs18;return array("sql" => $ZZq16, "params" => array(), "cols" => $ZZZZZZZZZZZn13, "fields" => $ZZZc2, "removeTable" => $ZZZZZZZZZZZZZZZa0, "meta" => $ZZZZZZZZZZZZZs18["meta"],);} function ZZZZZZZZZZZZZZZb1($ZZZZZJ99){$this->ZZZZZZZZZZZZZZv21($ZZZZZJ99);$ZZS1818 = array();foreach($this->ZZZZZZZZZZZZZZn13 as $ZZZZZZZZZZZZZZy24){$ZZS1818[] = $ZZZZZZZZZZZZZZy24+1;} return $ZZS1818;} function ZZZZZZZZZZZZZZZc2($ZZZZZJ99){$ZZZZZZZZZZZZZZZd3 = $this->ZZZZZZZZZZZZZZZb1($ZZZZZJ99);$ZZZZZZZZZZZZZZZe4 = array();$ZZZZZZZZZZZZZZZf5 = array("00");$ZZS1818 = array();$ZZT1919 = count($ZZZZZJ99);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZZJ99[$Zf5]->name,$this->ZZZZZZZZZZZZZZq16)){$ZZZZZZZZZZZZZZZf5[] = $Zf5+1;if(in_array($ZZZZZJ99[$Zf5]->name,$ZZZZZZZZZZZZZZZe4)){$ZZS1818[] = $Zf5;}else{$ZZZZZZZZZZZZZZZe4[] = $ZZZZZJ99[$Zf5]->name;}}} return array("skip"=>$ZZS1818,"common"=>$this->ZZZZZZZZZZZZZZq16,"commonIds"=>$ZZZZZZZZZZZZZZZf5);} function ZZZZZZZZZZZZZZZg6($ZZZc2){$this->ZZZY2424 = $ZZZc2;} function ZZZZZZZZZZZZZZZh7(&$ZZZZJ99){$ZZZZZC22 = null;$ZZT1919 = count($this->ZZZY2424);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZJ99[0]["name"],$this->ZZZY2424)){$ZZZZZC22 = array_shift($ZZZZJ99);}}} function ZZZZZZZZZZZZZN1313($module,$ZZZZc2,$filters,$ZZZZZJ99 = array(),$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9 = false,$isCrosstab = true,$ZZZZZZZZZZZZZO1414 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd", $ZZZZZZZZZZZZZP1515 = false, $ZZZT1919 = array(), $ZZZZZZZZZZZZZk10 = array(), ARUser $ZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZZZZR1717 = new ZZZZZZZZZZQ1616($this->db,$this->ZZZZZe4,true, $ZZZZZZZZZZZZZQ1616);$ZZZZZZZj9 = $this->ZZZZZZZZZZZZZZv21($ZZZZZJ99);$ZZZZZZZZZZZZZZZi8 = str_replace('-', '_', session_id());$ZZq16 = array();for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){$ZZq16[$Zf5] = $this->ZZZZZZZZZZZZZZU2020($ZZZZZZZZZZZZZR1717,$this->ZZZZZZZZZZZZZZn13[$Zf5],$ZZZZc2,$filters,$ZZZZZJ99,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9);} for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){if($ZZq16[$Zf5]!==null){$this->ZZZZZZZZZZZZZZQ1616($ZZq16[$Zf5],$Zf5.$ZZZZZZZZZZZZZZZi8);}} for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["removeTable"],array());$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["createTmpTable"],$ZZq16[$Zf5]["params"]);$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["fixTable"],array());}} $ZZZZZZZZZZZZZZX2323 = $this->ZZZZZZZZZZZZZZM1212($ZZq16,"report".$ZZZZZZZZZZZZZZZi8);$ZZZZZZZZZZZZZZZj9 = $this->ZZZZZZZZZZZZZZW2222($ZZZZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZR1717, $ZZq16,$this->ZZZZZZZZZZZZZZs18,$ZZZO1414,$ZZZZZZZZZZZZZk10);$ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZZj9["removeTable"],array());$ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZX2323,array());$ZZS1818 = $this->db->ZZZE44($ZZZZZZZZZZZZZZZj9["sql"],array());for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["removeTable"],array());} $ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZZj9["removeTable"],array());$ZZT1919 = count($ZZZZZJ99);$ZZZZZZZZZZZZZS1818 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZS1818[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);} $ZZZZZZZZZZZZZT1919 = new ZZZZZZZZZZZZZU2020($ZZZO1414,$ZZZZZZZZZZZZZZZj9["fields"],$ZZZZZZZZZZZZZj9);$ZZZZZZZZZZZZZT1919->ZZZZZZZZZZZZZV2121($ZZS1818);$ZZZO1414[] = array("name"=>"date_field","dateGrouping"=>$ZZZO1414[0]["dateGrouping"],"sortAction"=>$ZZZO1414[0]["sortAction"],"position" =>$ZZZO1414[0]["position"]);$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZX2323($this->ZZZZZe4,$this->db,$ZZZZZZZZZZZZZZZj9["fields"],$ZZZO1414,$ZZZZZZZZZZZZZS1818,$dateFormat,$ZZZZZZZZZZZZZP1515);$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818);if($ZZZO1414[0]["sortAction"]=="nogroup"){unset($ZZZZZZZZZZZZZZZj9["cols"]['date_field']);} $ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZK1010($ZZZZZZZZZZZZZZZj9["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){$this->ZZZZZZZZZZZZZZZh7($ZZZO1414);if($aggregateColumn){$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZ2525($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);}else{$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZa0($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);} $ZZS1818 = $ZZZZZZZZZZZZZY2424->ZZZZZZZZZZZZZZb1($ZZS1818,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZZZj9["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZK1010($ZZS1818["cols"]);$ZZS1818["meta"] = $ZZZZZZZZZZZZZZZj9["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZZd3($ZZZZZZZZZZZZZS1818, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);if($ZZZZZZZZZZZZZO1414){$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZZc2();$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818["data"]);} return $ZZS1818;}} class ZZZZZZZZZZZZZZa0{protected $ZZZZZZZZZZZZZZZk10;protected $ZZZP1515;protected $ZZZZZZZZZZZZZZZl11;protected $ZZZZZe4;protected $db;protected $ZZZZZZZZZZu20;function __construct($db, $ZZZZZe4,$ZZZZZZZZZZu20) {$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZZZZZZZZu20 = $ZZZZZZZZZZu20;} function ZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZn13,$ZZZZZZZZZZZZZZZk10){$ZZZZZZZZZZZZZZZo14 = count($ZZZZZZZZZZZZZZZn13);$ZZS1818 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZo14;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZn13[$Zf5]] = array();} $ZZT1919 = count($ZZZZZZZZZZZZZZZk10);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){for($ZZZZZW2222=0;$ZZZZZW2222<$ZZZZZZZZZZZZZZZo14;$ZZZZZW2222++){if(!in_array($ZZZZZZZZZZZZZZZk10[$Zf5][$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]],$ZZS1818[$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZS1818[$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]][] = $ZZZZZZZZZZZZZZZk10[$Zf5][$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]];}}} return $ZZS1818;} function ZZZZZZZZZZZZZZZp15($ZZZZZz25,$ZZZZZZZZZZZZZZZq16 = false){$ZZZH77 = $ZZZZZz25;$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZH77[$Zf5] = strtoupper(trim($ZZZZZz25[$Zf5]));} if($ZZZZZZZZZZZZZZZq16){arsort($ZZZH77);}else{asort($ZZZH77);} $ZZS1818 = array();foreach($ZZZH77 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZS1818[] = $ZZZZZz25[$ZZZZa0];} return $ZZS1818;} function ZZZZZZZZZZZZZZZs18(&$ZZZZZZZZZZZZZZZt19,$ZZZZZZZZZZZZZZZu20,$ZZZZZZZZZZZZZZZv21){$ZZT1919 = count($ZZZZZZZZZZZZZZZt19);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZt19[$Zf5]["values"] = $ZZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZZt19[$Zf5]["name"]];if($ZZZZZZZZZZZZZZZv21 && $ZZZZZZZZZZZZZZZt19[$Zf5]["sort"] === 1){$ZZZZZZZZZZZZZZZt19[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZp15($ZZZZZZZZZZZZZZZt19[$Zf5]["values"]);} if($ZZZZZZZZZZZZZZZv21 && $ZZZZZZZZZZZZZZZt19[$Zf5]["sort"] === 2){$ZZZZZZZZZZZZZZZt19[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZp15($ZZZZZZZZZZZZZZZt19[$Zf5]["values"],true);}}} function ZZZZZZZZZZZZZZZw22($ZZZc2,$ZZZZZZZZZZZZZZZx23){$ZZS1818 = $ZZZZZZZZZZZZZZZx23;$ZZT1919 = count($ZZZc2);for($Zf5 = $ZZT1919;$Zf5>0;$Zf5--){$ZZZH77 = $ZZZc2[$Zf5-1];$ZZZH77["data"] = array();$ZZZH77["next"] = $ZZS1818;$ZZS1818 = $ZZZH77;} return $ZZS1818;} function ZZZZZZZZZZZZZZZy24($ZZZZZZG66,&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZA00,$ZZZP1515){if($ZZZZZZZZZZZZZZZA00){$Zf5 =array_search($ZZZZZZG66[$ZZZZZZZZZZZZZZZz25["name"]],$ZZZZZZZZZZZZZZZz25["values"]);if(!isset($ZZZZZZZZZZZZZZZz25["data"][$Zf5])){$ZZZZZZZZZZZZZZZz25["data"][$Zf5] = $ZZZZZZZZZZZZZZZz25["next"];} $this->ZZZZZZZZZZZZZZZy24($ZZZZZZG66,$ZZZZZZZZZZZZZZZz25["data"][$Zf5],$ZZZZZZZZZZZZZZZA00-1,$ZZZP1515);}else{$ZZT1919 = count($ZZZP1515);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if($ZZZP1515[$Zf5]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZz25["data"][$ZZZP1515[$Zf5]["selectedField"]."_sum"] = $ZZZZZZG66[$ZZZP1515[$Zf5]["selectedField"]."_sum"];} if($ZZZP1515[$Zf5]["value"]["count"]==true){$ZZZZZZZZZZZZZZZz25["data"][$ZZZP1515[$Zf5]["selectedField"]."_cnt"] = $ZZZZZZG66[$ZZZP1515[$Zf5]["selectedField"]."_cnt"];} if($ZZZP1515[$Zf5]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZz25["data"][$ZZZP1515[$Zf5]["selectedField"]."_avg"] = $ZZZZZZG66[$ZZZP1515[$Zf5]["selectedField"]."_avg"];}}}} function ZZZZZZZZZZZZZZZB11(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZC22,$ZZZZZZZZZZZZZZZD33,$ZZZP1515,$ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZl11){$ZZZZZZZZZZZZZZZA00 = $ZZZZZZZZZZZZZZZC22+$ZZZZZZZZZZZZZZZD33;if($ZZZZZZZZZZZZZZZE44<($ZZZZZZZZZZZZZZZA00 -1)) {if($ZZZZZZZZZZZZZZZz25["sort"] === 1 || $ZZZZZZZZZZZZZZZz25["sort"] === 2){ksort($ZZZZZZZZZZZZZZZz25["data"]);} foreach($ZZZZZZZZZZZZZZZz25["data"] as $ZZZZa0 =>$ZZZZZZZZZZZZZZZr17){$this->ZZZZZZZZZZZZZZZB11($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0],$ZZZZZZZZZZZZZZZC22,$ZZZZZZZZZZZZZZZD33,$ZZZP1515,$ZZZZZZZZZZZZZZZE44+1,$ZZZZZZZZZZZZZZZl11);} if($ZZZZZZZZZZZZZZZD33 -1 <$ZZZZZZZZZZZZZZZE44){$this->ZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZA00);if($ZZZZZZZZZZZZZZZE44== 0){$this->ZZZZZZZZZZZZZZZG66($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515);}}else{$this->ZZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZZZz25,($ZZZZZZZZZZZZZZZE44 === $ZZZZZZZZZZZZZZZD33-1));}}else{$this->ZZZZZZZZZZZZZZZI88($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515);if($ZZZZZZZZZZZZZZZE44== 0){$this->ZZZZZZZZZZZZZZZG66($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515);}}} function ZZZZZZZZZZZZZZZG66(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZS1818 = array("cols"=>array(),"data"=>array(array()));$ZZZZZZZZZZZZZZF55 = count($ZZZP1515);$ZZZZZZZZZZZZZZZJ99 = array();for($ZZZZZW2222 =0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZP1515[$ZZZZZW2222]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"];} if($ZZZP1515[$ZZZZZW2222]["value"]["count"]==true){$ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"];} if($ZZZP1515[$ZZZZZW2222]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"];}} foreach($ZZZZZZZZZZZZZZZz25["cols"] as $ZZZZa0=>$ZZZZZZZZZZZZZZZr17){foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZK1010=>$ZZZZZZZZZZZZZZZL1111) {$ZZS1818["data"][0][$ZZZZa0] = (isset($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]))?($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]):"";$ZZS1818["cols"][$ZZZZa0] = $ZZZZZZZZZZZZZZZr17;}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZF55(&$ZZZZZZZZZZZZZZZz25){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);reset($ZZZZZZZZZZZZZZZz25["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZz25["data"]);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {foreach($ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"] as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZS1818["cols"]["v".$Zf5."_".$ZZZZa0] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZr17;}} foreach($ZZZZZZZZZZZZZZZz25["data"] as $ZZZZa0 =>$ZZZZZZZZZZZZZZZr17){foreach($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"] as $ZZZZZZZZZZZZZZZK1010 =>$ZZZZZZZZZZZZZZZL1111){$ZZS1818["data"]["v".$ZZZZa0."_".$ZZZZZZZZZZZZZZZK1010] = $ZZZZZZZZZZZZZZZL1111;}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZH77(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZM1212){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZS1818["cols"][$ZZZZZZZZZZZZZZZz25["name"]] = $ZZZZZZZZZZZZZZZz25["title"];reset($ZZZZZZZZZZZZZZZz25["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZz25["data"]);$ZZS1818["cols"] = array_merge($ZZS1818["cols"],$ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);foreach ($ZZZZZZZZZZZZZZZz25["data"] as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){if($ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0]===null){$ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0] = " - ";} if($ZZZZZZZZZZZZZZZM1212){$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZZZZZz25["name"]] = $ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"];}else{$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"]);for ($ZZZZZW2222 = 0;$ZZZZZW2222 < $ZZZZZZZZZZZZZZF55;$ZZZZZW2222++) {$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZW2222][$ZZZZZZZZZZZZZZZz25["name"]] = $ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZW2222];}}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$Zf5])){foreach($ZZZZZZZZZZZZZZZz25["data"][$Zf5]["data"] as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$this->ZZZZZZZZZZZZZZZJ99[$ZZZZa0] = $ZZZZZZZZZZZZZZZl11[$ZZZZa0];$ZZS1818["cols"]["v".$Zf5."_".$ZZZZa0] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZZa0];$ZZS1818["data"]["v".$Zf5."_".$ZZZZa0] = $ZZZZZZZZZZZZZZZr17;}}else{$ZZZZZZZZZZZZZZF55 = count($ZZZP1515);for($ZZZZZW2222 =0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZP1515[$ZZZZZW2222]["value"]["sum"]==true){$this->ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"];} if($ZZZP1515[$ZZZZZW2222]["value"]["count"]==true){$this->ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"];} if($ZZZP1515[$ZZZZZW2222]["value"]["avg"]==true){$this->ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"];}}}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZb1($r17,$ZZZO1414,$ZZZP1515,$ZZZc2){$ZZZZZZZZZZZZZZZN1313 = $r17["data"];$ZZZZZZZZZZZZZZZO1414 = array();$ZZZZZZZZZZh7 = $this->ZZZZZe4->ZZZZZT1919($ZZZc2, $ZZZO1414);$ZZZZZZZZZZZZZZZP1515 = array();$ZZZZZZZZZZZZZZZQ1616 = array();$ZZZZZZZZZZZZZZZR1717 = array();$ZZT1919 = count($ZZZO1414);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if(($ZZZO1414[$Zf5]["sortAction"]=="group" || $ZZZO1414[$Zf5]["sortAction"]=="groupsort")){if($ZZZO1414[$Zf5]["name"]!="date_field" && isset($ZZZO1414[$Zf5]['dateGrouping']) && !empty($ZZZO1414[$Zf5]['dateGrouping'])) {$ZZZO1414[$Zf5]['name'] = $ZZZO1414[$Zf5]['name'] . '_' . $ZZZO1414[$Zf5]['dateGrouping'];} if(isset($r17["cols"][$ZZZO1414[$Zf5]["name"]])){$ZZZH77 = array("name" =>$ZZZO1414[$Zf5]["name"], "title" => $r17["cols"][$ZZZO1414[$Zf5]["name"]], "sort" => false);if($ZZZO1414[$Zf5]["sortAction"]=="groupsort"){if(isset($ZZZO1414[$Zf5]["sortDirection"]) && $ZZZO1414[$Zf5]["sortDirection"] == "ASC"){$ZZZH77["sort"] = 1;}else{$ZZZH77["sort"] = 2;}} $ZZZZZZZZZZZZZZZR1717[] = $ZZZO1414[$Zf5]["name"];if($ZZZO1414[$Zf5]["position"] == "row" || $ZZZO1414[$Zf5]["position"] == ""){if($ZZZO1414[$Zf5]["name"] == "00_ALL_assigned_user_id"){$ZZZZZZZZZZZZZZZS1818 = false;}else{$ZZZZZZZZZZZZZZZS1818 = $this->ZZZZZe4->ZZZZZI88($ZZZZZZZZZZh7[$ZZZO1414[$Zf5]["name"]],$this->db,$this->ZZZZZZZZZZu20);} if($ZZZZZZZZZZZZZZZS1818){$ZZZZZZZZZZZZZZZQ1616[] = array("name" =>$ZZZO1414[$Zf5]["name"]."_id", "title" => $r17["cols"][$ZZZO1414[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZQ1616[] = array("name" =>$ZZZO1414[$Zf5]["name"]."_setype", "title" => $r17["cols"][$ZZZO1414[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZO1414[] = $ZZZO1414[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZO1414[] = $ZZZO1414[$Zf5]["name"]."_setype";$ZZZZZZZZZZZZZZZR1717[] = $ZZZO1414[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZR1717[] = $ZZZO1414[$Zf5]["name"]."_setype";} $ZZZZZZZZZZZZZZZQ1616[] = $ZZZH77;}else{$ZZZZZZZZZZZZZZZP1515[] = $ZZZH77;}}}} $ZZZZZZZZZZZZZZZT1919 = $this->ZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZZZZZN1313);$this->ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZQ1616,$ZZZZZZZZZZZZZZZT1919,true);$this->ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZZZZT1919,false);$ZZZZZZZZZZZZZZZU2020 = $this->ZZZZZZZZZZZZZZZw22($ZZZZZZZZZZZZZZZP1515,array());$ZZZZZZZZZZZZZZZz25 = $this->ZZZZZZZZZZZZZZZw22($ZZZZZZZZZZZZZZZQ1616,$ZZZZZZZZZZZZZZZU2020);$ZZZZZZZZZZZZZZZA00 = count($ZZZZZZZZZZZZZZZQ1616) + count($ZZZZZZZZZZZZZZZP1515);$ZZT1919 = count($ZZZZZZZZZZZZZZZN1313);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZy24($ZZZZZZZZZZZZZZZN1313[$Zf5],$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZA00,$ZZZP1515);} $this->ZZZZZZZZZZZZZZZk10 = $ZZZZZZZZZZZZZZZQ1616;$this->ZZZP1515 = $ZZZP1515;$this->ZZZZZZZZZZZZZZZl11 = $r17["cols"];$this->ZZZZZZZZZZZZZZZB11($ZZZZZZZZZZZZZZZz25,count($ZZZZZZZZZZZZZZZP1515),count($ZZZZZZZZZZZZZZZQ1616),$ZZZP1515,0,$r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZZO1414);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){unset($ZZZZZZZZZZZZZZZz25["cols"][$ZZZZZZZZZZZZZZZO1414[$Zf5]]);} return $ZZZZZZZZZZZZZZZz25;}} class ZZZZZZZZZZZZZZ2525 extends ZZZZZZZZZZZZZZa0{function ZZZZZZZZZZZZZZZF55(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZA00){if($ZZZZZZZZZZZZZZZE44 == $ZZZZZZZZZZZZZZZA00 - 1){$ZZS1818 = array("cols"=>array(""=>""),"data"=>array());$ZZZZZZZZZZZZZZZz25 = $ZZS1818;}else{parent::ZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZz25);}} function ZZZZZZZZZZZZZZZG66(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZS1818 = array("cols"=>array("aggregates"=>"Aggregate"),"data"=>array(array()));$ZZZH77 = array();foreach($ZZZZZZZZZZZZZZZz25["cols"] as $ZZZZa0=>$ZZZZZZZZZZZZZZZr17){$ZZS1818["cols"][$ZZZZa0] = $ZZZZZZZZZZZZZZZr17;if(isset($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]))foreach ($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"] as $ZZZZZZZZZZZZZZZK1010=>$ZZZZZZZZZZZZZZZL1111) {if(!isset($ZZZH77[$ZZZZZZZZZZZZZZZK1010])){$ZZZH77[$ZZZZZZZZZZZZZZZK1010] = array("aggregates"=>$ZZZZZZZZZZZZZZZl11[$ZZZZZZZZZZZZZZZK1010]);} $ZZZH77[$ZZZZZZZZZZZZZZZK1010][$ZZZZa0] = (is_array($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"]) && isset($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZZZZZK1010]))?($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZZZZZK1010]):"";}} $ZZS1818["data"] = array_values($ZZZH77);$ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZH77(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZV2121){if($ZZZZZZZZZZZZZZZV2121){$ZZZZZZZZZZZZZZZl11 = $this->ZZZZZZZZZZZZZZZl11;$ZZZP1515 = $this->ZZZP1515;$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);$ZZZZZZZZZZZZZZZW2222["aggregates"] = "Aggregate";reset($ZZZZZZZZZZZZZZZz25["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZz25["data"]);$ZZZZZZZZZZZZZZZW2222 = array_merge($ZZZZZZZZZZZZZZZW2222,$ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);$ZZZZZZZZZZZn13 = array_keys($ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZZX2323 = count($ZZZP1515);$ZZZZZC22 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZX2323;$Zf5++){$ZZZZZZZZZZZZZZZY2424 = array("aggregates"=>($ZZZP1515[$Zf5]["value"]["sum"]==true)?$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$Zf5]["selectedField"]."_sum"]:"");$ZZZZZZZZZZZZZZZZ2525 = array("aggregates"=>($ZZZP1515[$Zf5]["value"]["count"]==true)?$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$Zf5]["selectedField"]."_cnt"]:"");$ZZZZZZZZZZZZZZZZa0 = array("aggregates"=>($ZZZP1515[$Zf5]["value"]["avg"]==true)?$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$Zf5]["selectedField"]."_avg"]:"");for($ZZZZa0 = 0;$ZZZZa0<$ZZT1919;$ZZZZa0++){$ZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZZZY2424;$ZZn13 = $ZZZZZZZZZZZZZZZZ2525;$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZZZZZZZa0;for($ZZZZZW2222=0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZP1515[$Zf5]["value"]["sum"]==true){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZZZZZZZZZZZZZZZb1[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]]["data"][$ZZZP1515[$Zf5]["selectedField"]."_sum"];}} if($ZZZP1515[$Zf5]["value"]["count"]==true){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZn13[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]]["data"][$ZZZP1515[$Zf5]["selectedField"]."_cnt"];}} if($ZZZP1515[$Zf5]["value"]["avg"]==true){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZZZZZZZZZZZZZZZc2[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]]["data"][$ZZZP1515[$Zf5]["selectedField"]."_avg"];}}} if(!isset($ZZZZZC22[$ZZZZa0])){$ZZZZZC22[$ZZZZa0] = array();} if(count($ZZZZZZZZZZZZZZZZb1)>1){$ZZZZZC22[$ZZZZa0][]=$ZZZZZZZZZZZZZZZZb1;} if(count($ZZn13)>1){$ZZZZZC22[$ZZZZa0][]=$ZZn13;} if(count($ZZZZZZZZZZZZZZZZc2)>1){$ZZZZZC22[$ZZZZa0][]=$ZZZZZZZZZZZZZZZZc2;}}} for($ZZZZZW2222=0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZZZZZZZZZZZZZW2222[$ZZZZZZZZZZZn13[$ZZZZZW2222]] === null){$ZZZZZZZZZZZZZZZW2222[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = "-";}} for($ZZZZa0 = 0;$ZZZZa0<$ZZT1919;$ZZZZa0++){if(!empty($ZZZZZC22[$ZZZZa0])){$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["cols"] = $ZZZZZZZZZZZZZZZW2222;$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"] = $ZZZZZC22[$ZZZZa0];}}} parent::ZZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZZZz25,false);} function ZZZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZS1818["cols"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5];if(isset($ZZZZZZZZZZZZZZZz25["data"][$Zf5])){$ZZS1818["data"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZz25["data"][$Zf5];}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;}}
class ZZZZZZZZZZZZZX2323{protected $ZZZZZZZZZZZZZZZZd3 = array();protected $ZZZZZZZZZZZZZS1818 = array();protected $ZZT1919 = 0;protected $ZZZZZe4;protected $db;protected $dateFormat;protected $ZZZc2;protected $ZZZZZZZZZZZZZP1515;function __construct($ZZZZZe4,$db,$ZZZc2,$ZZZO1414,$ZZZZZZZZZZZZZS1818,$dateFormat,$ZZZZZZZZZZZZZP1515) {$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZZZZZZZZZZZZZZd3 = $this->ZZZZZZZZZZZZZZZZe4($ZZZc2,$ZZZO1414);$this->ZZT1919 = count($this->ZZZZZZZZZZZZZZZZd3);$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZZS1818 = $ZZZZZZZZZZZZZS1818;$this->dateFormat = $dateFormat;$this->ZZZZZZZZZZZZZP1515 = $ZZZZZZZZZZZZZP1515;} protected function ZZZZZZZZZZZZZZZZe4($ZZZc2,$ZZZO1414){$ZZS1818 = array();$ZZZZZZZZZZZZZZZZf5 = array();$ZZZZZR1717 = 0;$ZZT1919 = count($ZZZc2);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZc2[$Zf5]["uitype"],array('date', 'datetime', 'datetimecombo', 'enum', 'multienum', 'currency', 'dynamicenum'))){$ZZS1818[$ZZZZZR1717] = $ZZZc2[$Zf5];$ZZZZZZZZZZZZZZZZf5[$ZZZc2[$Zf5]["fieldname"]] = &$ZZS1818[$ZZZZZR1717];$ZZZZZR1717++;}} $ZZT1919 = count($ZZZO1414);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZZZZZf5[$ZZZO1414[$Zf5]["name"]])){if(isset($ZZZO1414[$Zf5]["dateGrouping"])){$ZZZZZZZZZZZZZZZZf5[$ZZZO1414[$Zf5]["name"]]["dateGrouping"]= $ZZZO1414[$Zf5]["dateGrouping"];}}} $ZZZZZZZZZZZZZZZZg6 = array();foreach($ZZS1818 as $ZZZZZZZZZZZZZZZZh7) {if(isset($ZZZZZZZZZZZZZZZZh7['dateGrouping']) && !empty($ZZZZZZZZZZZZZZZZh7['dateGrouping']) && $ZZZZZZZZZZZZZZZZh7['fieldname']!="date_field") {foreach($ZZZO1414 as $ZZZZZZZZZZZZZZZZi8) {$ZZZZZZZZZZZZZZZZj9 = $ZZZZZZZZZZZZZZZZi8['name'] . '_' . $ZZZZZZZZZZZZZZZZi8['dateGrouping'];if($ZZZZZZZZZZZZZZZZh7['fieldname'] == $ZZZZZZZZZZZZZZZZi8['name']) {$ZZZZZZZZZZZZZZZZk10 = $ZZZZZZZZZZZZZZZZh7;$ZZZZZZZZZZZZZZZZk10['fieldname'] = $ZZZZZZZZZZZZZZZZj9;$ZZZZZZZZZZZZZZZZk10['dateGrouping'] = $ZZZZZZZZZZZZZZZZi8['dateGrouping'];$ZZZZZZZZZZZZZZZZg6[] = $ZZZZZZZZZZZZZZZZk10;} else if ($ZZZZZZZZZZZZZZZZh7['fieldname'] == $ZZZZZZZZZZZZZZZZj9){$ZZZZZZZZZZZZZZZZg6[] = $ZZZZZZZZZZZZZZZZh7;}}} else {$ZZZZZZZZZZZZZZZZg6[] = $ZZZZZZZZZZZZZZZZh7;}} $ZZS1818 = $ZZZZZZZZZZZZZZZZg6;return $ZZS1818;} function ZZZZZZZZZZZZZZZZl11($ZZZZZZZZZZZZZZZZm12){$ZZZH77 = explode(" ",$ZZZZZZZZZZZZZZZZm12,2);$ZZZZZZZZZZZZx23 = explode("-",$ZZZH77[0],3);if(count($ZZZZZZZZZZZZx23) == 1) {return $this->ZZZZZe4->ZZZZZQ1616($ZZZZZZZZZZZZx23[0]);} if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZx23[1])){return $ZZZZZZZZZZZZZZZZm12;} $ZZZZZZZZZZZZx23[1] = $this->ZZZZZe4->ZZZZZQ1616(intval($ZZZZZZZZZZZZx23[1],10));switch($this->dateFormat){case "mm-dd-yyyy": $ZZZH77[0] = $ZZZZZZZZZZZZx23[1]."-".$ZZZZZZZZZZZZx23[2]."-".$ZZZZZZZZZZZZx23[0];break;case "dd-mm-yyyy": $ZZZH77[0] = $ZZZZZZZZZZZZx23[2]."-".$ZZZZZZZZZZZZx23[1]."-".$ZZZZZZZZZZZZx23[0];break;case "yyyy-mm-dd": default: $ZZZH77[0] = $ZZZZZZZZZZZZx23[0]."-".$ZZZZZZZZZZZZx23[1]."-".$ZZZZZZZZZZZZx23[2];break;} $ZZS1818 = $ZZZH77[0];if(isset($ZZZH77[1])){$ZZS1818.=" ".$ZZZH77[1];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZn13($value,$field,$ZZZZZZZZZZu20){static $ZZZx23 = array('its_currencies' =>array());$ZZS1818 = $value;switch ($field['uitype']){case 'date': case 'datetime': case 'datetimecombo': if(!isset($field["dateGrouping"]) || in_array($field["dateGrouping"],array("day","month","monthAndYear"))){if(count(explode("-",$value))==2){$ZZZH77 = explode(" ",$value,2);$ZZZZZZZZZZZZx23 = explode("-",$ZZZH77[0],3);if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZx23[1])){return $ZZS1818;} $ZZZZZZZZZZZZx23[1] = $this->ZZZZZe4->ZZZZZQ1616(intval($ZZZZZZZZZZZZx23[1],10));$ZZZH77[0] = implode("-",$ZZZZZZZZZZZZx23);$ZZS1818 = implode(" ",$ZZZH77);}else{if(!empty($value)){$ZZS1818 = $this->ZZZZZZZZZZZZZZZZl11($value);}}} break;case 'multienum': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZy24($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} $ZZZZZZZZZZZZZZZZq16 = str_replace('^', '', $value);$ZZZZZZZZZZZZZZZZr17 = explode(",", $ZZZZZZZZZZZZZZZZq16);$ZZZZZZZZZZZZZZZZs18 = array();foreach ($ZZZZZZZZZZZZZZZZr17 as $ZZZZZZZZZZZZZZZZt19) {if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZt19])){$ZZZZZZZZZZZZZZZZs18[] = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZt19];}} if(count($ZZZZZZZZZZZZZZZZs18) > 0){$ZZS1818 = implode(", ", $ZZZZZZZZZZZZZZZZs18);} break;case 'enum': case 'dynamicenum': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZy24($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value])){$ZZS1818 = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value];} break;case '33': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZy24($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} $ZZZZZZZZZZZZZZZZu20 = explode(" |##| ", $value);$ZZZZZZZZZZZZZZZZv21 = array();foreach($ZZZZZZZZZZZZZZZZu20 as $ZZZZZZZZZZZZZZZZw22){if(!empty($ZZZZZZZZZZZZZZZZw22)){$ZZZZZZZZZZZZZZZZx23 = $ZZZZZZZZZZZZZZZZw22;if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZw22])){$ZZZZZZZZZZZZZZZZx23 = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZw22];} $ZZZZZZZZZZZZZZZZv21[] = $ZZZZZZZZZZZZZZZZx23;}} if(!empty($ZZZZZZZZZZZZZZZZv21)){$ZZS1818 = implode(", ",$ZZZZZZZZZZZZZZZZv21);} break;case '117': if(!isset($ZZZx23['its_currencies'][$value])){$ZZZZZZZZZZZZZZZZy24 = $this->db->ZZQ1616($value);$ZZZx23['its_currencies'][$value] = ($ZZZZZZZZZZZZZZZZy24)?($ZZZZZZZZZZZZZZZZy24):($value);} if(isset($ZZZx23['its_currencies'][$value])){$ZZS1818 = $ZZZx23['its_currencies'][$value];} break;case '-24': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZA00($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value])){$ZZS1818 = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value];} break;default: break;} return $ZZS1818;} function ZZZZZZZZZZZZZV2121(&$ZZZZZZZZZZZZZZZk10){$ZZT1919 = count($ZZZZZZZZZZZZZZZk10);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZZZk10[$Zf5]);}} function ZZZZZZZZZZZZZZZZz25(&$ZZr17){for($Zf5 = 0;$Zf5<$this->ZZT1919;$Zf5++){foreach($ZZr17 as $Zu20 => $value) {$ZZr17[$Zu20] = html_entity_decode($value, ENT_QUOTES, "UTF-8");} if(isset($ZZr17[$this->ZZZZZZZZZZZZZZZZd3[$Zf5]["fieldname"]])){$ZZr17[$this->ZZZZZZZZZZZZZZZZd3[$Zf5]["fieldname"]] = $this->ZZZZZZZZZZZZZZZZn13($ZZr17[$this->ZZZZZZZZZZZZZZZZd3[$Zf5]["fieldname"]],$this->ZZZZZZZZZZZZZZZZd3[$Zf5],$this->ZZZZZZZZZZZZZS1818);}} if($this->ZZZZZZZZZZZZZP1515){$ZZZZZZZZZZZZZZF55 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZF55;$Zf5++){if(isset($ZZr17[$this->ZZZc2[$Zf5]["fieldname"]]) && $ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] === null){$ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] = 0;}}}}} class ZZZZZZZZZZZZZU2020{protected $ZZZZZZZZZZZZZZZZA00 = array();protected $ZZZc2;protected $ZZZZZZZZZZZZZZZZB11 = 0;protected $ZZZO1414;protected $ZZZZZZZZZZZZZj9 = false;protected $ZZZZZZZZZZZZZZZZC22 = array();protected $ZZZZZZZZZZZZZZZZD33 = array();function ZZZZZZZZZZZZZZZZE44(){$ZZS1818 = array();$ZZZZZZZZZZZZZZZl11 = array();$ZZT1919 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZC22[$this->ZZZc2[$Zf5]["fieldname"]] = $this->ZZZc2[$Zf5]["uitype"];$ZZZZZZZZZZZZZZZl11[] = $this->ZZZc2[$Zf5]["fieldname"];} $ZZT1919 = count($this->ZZZO1414);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($this->ZZZO1414[$Zf5]["name"],$ZZZZZZZZZZZZZZZl11) && $this->ZZZZZZZZZZZZZZZZC22[$this->ZZZO1414[$Zf5]["name"]] == 33 && !empty($this->ZZZO1414[$Zf5]["transform"])){$ZZS1818[] = $this->ZZZO1414[$Zf5];} if(in_array($this->ZZZO1414[$Zf5]["name"],$ZZZZZZZZZZZZZZZl11)){$this->ZZZZZZZZZZZZZZZZD33[] = $this->ZZZO1414[$Zf5]["name"];}} return $ZZS1818;} function __construct($ZZZO1414,$ZZZc2,$ZZZZZZZZZZZZZj9){$this->ZZZO1414= $ZZZO1414;$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZZj9 = $ZZZZZZZZZZZZZj9;$this->ZZZZZZZZZZZZZZZZA00 = $this->ZZZZZZZZZZZZZZZZE44();} function ZZZZZZZZZZZZZZZZF55($ZZZZy24,$r17){$ZZZZZZZZZZZZZZZT1919 = array();for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZB11;$Zf5++){if(!in_array($r17[$Zf5][$ZZZZy24],$ZZZZZZZZZZZZZZZT1919)){$ZZZZZZZZZZZZZZZT1919[] = $r17[$Zf5][$ZZZZy24];}} $ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZT1919);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZT1919[$Zf5]] = explode(' |##| ',$ZZZZZZZZZZZZZZZT1919[$Zf5]);if(count($ZZS1818[$ZZZZZZZZZZZZZZZT1919[$Zf5]]) == 1){unset($ZZS1818[$ZZZZZZZZZZZZZZZT1919[$Zf5]]);}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZG66($ZZZZZa0,$r17){} function ZZZZZZZZZZZZZZZZH77($ZM1212,$ZZZZZZZZZZZZZZZZI88){$ZZZZZZZZZZZZZZZZJ99 = true;$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZD33);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZM1212[$this->ZZZZZZZZZZZZZZZZD33[$Zf5]] !== $ZZZZZZZZZZZZZZZZI88[$this->ZZZZZZZZZZZZZZZZD33[$Zf5]]){$ZZZZZZZZZZZZZZZZJ99 = false;}} return $ZZZZZZZZZZZZZZZZJ99;} function ZZZZZZZZZZZZZZZZK1010(&$r17,$ZZZZZZG66,$ZZZZZZZZZZZZZZZZL1111,$field,&$ZZZZZZZZZZZZZZZZM1212,&$ZZZZZZZZZZZZZZZZN1313){$ZZZZZZZZZZZZZZR1717 = array_merge(array_keys($r17[$ZZZZZZZZZZZZZZZZL1111]),array_keys($r17[$ZZZZZZG66]));$ZZZZZZZZZZZZZZR1717 = array_unique($ZZZZZZZZZZZZZZR1717);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(is_numeric($r17[$ZZZZZZG66][$ZZZZZZZZZZZZZZR1717[$Zf5]]) && !in_array($ZZZZZZZZZZZZZZR1717[$Zf5],$this->ZZZZZZZZZZZZZZZZD33)){$r17[$ZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZR1717[$Zf5]] = (string)round((floatval($r17[$ZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZR1717[$Zf5]]) + floatval($r17[$ZZZZZZG66][$ZZZZZZZZZZZZZZR1717[$Zf5]])),$ZZZZZZZZZZZF55);}} array_splice($r17,$ZZZZZZG66,1);$this->ZZZZZZZZZZZZZZZZB11--;if($ZZZZZZZZZZZZZZZZL1111>$ZZZZZZG66){$ZZZZZZZZZZZZZZZZL1111--;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZM1212);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZM1212[$Zf5]>$ZZZZZZG66){$ZZZZZZZZZZZZZZZZM1212[$Zf5]--;}} $ZZZZZZZZZZZZZZZZO1414 = array_search($ZZZZZZG66,$ZZZZZZZZZZZZZZZZN1313[$r17[$ZZZZZZZZZZZZZZZZL1111][$field]]);array_splice($ZZZZZZZZZZZZZZZZN1313[$r17[$ZZZZZZZZZZZZZZZZL1111][$field]],$ZZZZZZZZZZZZZZZZO1414,1);foreach ($ZZZZZZZZZZZZZZZZN1313 as &$ZZZZZz25) {$ZZT1919 = count($ZZZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZz25[$Zf5]>$ZZZZZZG66){$ZZZZZz25[$Zf5]--;}}}} function ZZZZZZZZZZZZZZZZP1515($ZZZZZZZZZZZZZZZZQ1616,$field,&$r17){$ZZZZZZZZZZZZZZZZR1717 = array();$ZZZZZZZZZZZZZZZZS1818 = array();foreach($ZZZZZZZZZZZZZZZZQ1616 as $ZZZZZz25){$ZZT1919 = count($ZZZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!isset($ZZZZZZZZZZZZZZZZR1717[$ZZZZZz25[$Zf5]])){$ZZZZZZZZZZZZZZZZR1717[$ZZZZZz25[$Zf5]] = array();}}} for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZB11;$Zf5++){if(isset($ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]])){$ZZZH77 = $r17[$Zf5];$ZZZZZZZZZZZZZZZZT1919 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]]);for($ZZZZZW2222 = 0;$ZZZZZW2222 < $ZZT1919;$ZZZZZW2222++){$ZZZZZZZZZZZZZZZZT1919[$ZZZZZW2222] = $ZZZH77;$ZZZZZZZZZZZZZZZZT1919[$ZZZZZW2222][$field] = $ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]][$ZZZZZW2222];$ZZZZZZZZZZZZZZZZS1818[] = $Zf5+$ZZZZZW2222;$ZZZZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]][$ZZZZZW2222]][] = $Zf5+$ZZZZZW2222;} $this->ZZZZZZZZZZZZZZZZB11 = $this->ZZZZZZZZZZZZZZZZB11 + $ZZT1919 -1;array_splice($r17,$Zf5,1,$ZZZZZZZZZZZZZZZZT1919);$Zf5 = $Zf5 + $ZZT1919 -1;}elseif(isset($ZZZZZZZZZZZZZZZZR1717[$r17[$Zf5][$field]])){$ZZZZZZZZZZZZZZZZR1717[$r17[$Zf5][$field]][] = $Zf5;}} if ($this->ZZZZZZZZZZZZZj9) {$ZZT1919 = count($ZZZZZZZZZZZZZZZZS1818);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]]);for ($ZZZZZW2222 = 0;$ZZZZZW2222 < $ZZZZZZZZZZZZZZF55;$ZZZZZW2222++) {if ($ZZZZZZZZZZZZZZZZS1818[$Zf5] != $ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]][$ZZZZZW2222]) {if ($this->ZZZZZZZZZZZZZZZZH77($r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]], $r17[$ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]][$ZZZZZW2222]])) {$this->ZZZZZZZZZZZZZZZZK1010($r17, $ZZZZZZZZZZZZZZZZS1818[$Zf5], $ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]][$ZZZZZW2222], $field, $ZZZZZZZZZZZZZZZZS1818, $ZZZZZZZZZZZZZZZZR1717);break;}}}}}} function ZZZZZZZZZZZZZV2121(&$r17){$this->ZZZZZZZZZZZZZZZZB11 = count($r17);$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZA00);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZQ1616 = $this->ZZZZZZZZZZZZZZZZF55($this->ZZZZZZZZZZZZZZZZA00[$Zf5]["name"],$r17);$this->ZZZZZZZZZZZZZZZZP1515($ZZZZZZZZZZZZZZZZQ1616,$this->ZZZZZZZZZZZZZZZZA00[$Zf5]["name"],$r17);}}}
class ZZZZZZZZZZZZZZc2{protected $id = 0;function ZZZZZZZZZZZZZV2121(&$ZZZZZZZZZZZZZZZk10){$ZZT1919 = count($ZZZZZZZZZZZZZZZk10);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZZZk10[$Zf5]);}} function ZZZZZZZZZZZZZZZZz25(&$ZZr17){$this->id++;$ZZr17["id"] = $this->id;}} class ZZZZZZZZZZH77 {public $name;protected $db;protected $ZZZZZe4;public $prefix = "";public $fieldTitlePrefix = "";public $relationDescr = null;function __construct($name, ZZp15 $db, ZZZZZf5 $ZZZZZe4){$this->name = $name;$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->prefix = "0_".$this->name."_";} function ZZZZZZZZZZZZZZZZU2020($field){$ZZZZZz25 = $this->ZZZZZe4->ZZZZZy24($field['fieldname'],$this->name,$this->db);$ZZS1818 = array();foreach($ZZZZZz25 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZS1818[] = array("val" => $ZZZZa0,"title" => $ZZZZZZZZZZZZZZZr17);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZV2121($field){$ZZZZZZZZZZZZZZZu20 = array();switch ($field['uitype']) {case 'name': case 'text': case 'varchar': $type = "txt";break;case 'enum': case 'multienum': case 'dynamicenum': $type = "select";$ZZZZZZZZZZZZZZZu20 = $this->ZZZZZZZZZZZZZZZZU2020($field);break;case 'id': $type = "txt";break;case 'int': $type = "integer";break;case 'currency': case 'float': case 'decimal': $type = "number";break;case 'datetimecombo': case 'datetime': $type = "datetime";break;case 'date': $type = "date";break;case 'bool': $type = "checkbox";break;case 'relate': if(in_array($field["fieldname"], array("assigned_user_id"))) {$type = "user";} else {$type = "txt";} break;case 'assigned_user_name': $type = "user";break;default: $type = "txt";break;} $ZZZZZZZZZZZZZZZZW2222 = explode("~", $field['typeofdata']);if($ZZZZZZZZZZZZZZZZW2222[0]=="D"){$type = "date";} if($ZZZZZZZZZZZZZZZZW2222[0]=="N"||$ZZZZZZZZZZZZZZZZW2222[0]=="I"){if(!$this->ZZZZZe4->ZZZZZK1010($field)){$type = "number";}} return array("name"=>$this->prefix.$field['fieldname'], "column"=>$field['columnname'], "table"=>$field['tablename'], "uitype"=>$field['uitype'], "type"=>$type, "title"=>$this->fieldTitlePrefix.$this->ZZZZZe4->ZZZZZw22($field['fieldlabel'],$this->name), "availableValues" =>$ZZZZZZZZZZZZZZZu20, "bareTitle"=>$this->ZZZZZe4->ZZZZZw22($field['fieldlabel'],$this->name),);} function ZZZZZZZZZZZP1515(){return $this->ZZZZZe4->ZZZZZB11($this->name);} function ZZZZZZZZZZZZV2121(){$ZZZH77 = $this->ZZZZZe4->ZZZZZE44($this->name);$ZZZe4 = ZZZf5::getInstance();$ZZZg6 = $ZZZe4->ZZZh7();if(isset($ZZZg6->enableAudit) && $ZZZg6->enableAudit){ZZZi8::ZZZj9(ZZZk10::load('hooks', 'addAuditTable'));$ZZZH77 = ZZZi8::ZZZZZZZZZZZZZZZZX2323($this->name, $ZZZH77, $this->db);} if(isset($ZZZg6->enableCustomTables) && $ZZZg6->enableCustomTables) {ZZZi8::ZZZj9(ZZZk10::load('hooks', 'addCustomTable'));$ZZZH77 = ZZZi8::ZZZZZZZZZZZZZZZZX2323($this->name, $ZZZH77, $this->db);} $ZZT1919 = count($ZZZH77);$ZZS1818 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZH77[$Zf5]['name']] = $ZZZH77[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZZZZZh7(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZV2121($ZZZc2[$Zf5]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZY2424($ZZZZz25,$ZZZZZZZZZZZZZZZZZ2525 = false){if($ZZZZz25['label'] == "---"){$ZZS1818 = array("title" => $this->ZZZZZe4->ZZZZZw22($this->name,$this->name), "fields" => array(),);}else{$ZZS1818 = array("title" => $this->ZZZZZe4->ZZZZZw22($ZZZZz25['label'],$this->name), "fields" => array(),);} if($ZZZZz25['id'] === 52){$ZZS1818["title"] = $this->ZZZZZe4->ZZZZZw22($ZZZZz25['label'],"Invoice");} $ZZT1919 = count($ZZZZz25['fields']);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!$ZZZZZZZZZZZZZZZZZ2525 || !($ZZZZz25['fields'][$Zf5]['tablename']== "vtiger_crmentity" && $ZZZZz25['fields'][$Zf5]['columnname']=='assigned_user_id')){$ZZS1818['fields'][] = $this->ZZZZZZZZZZZZZZZZV2121($ZZZZz25['fields'][$Zf5]);}} return $ZZS1818;} function ZZZZZZZZZZg6(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]["module"] = 0;$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = "0_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZZe4->ZZZZZw22($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZM1212($ZZZZZZZZZZZZZZZZZ2525 = false){$ZZZZZZZZZZZZZZZZZa0 = $this->db->ZZZz25($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZa0);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZY2424($ZZZZZZZZZZZZZZZZZa0[$Zf5],$ZZZZZZZZZZZZZZZZZ2525);} return $ZZS1818;}} class ZZZZZZZZZZI88 extends ZZZZZZZZZZH77{public $relationDescr;public $prefix = "";public $ZZZZZZZZZZZZZZZZZb1 = "";function __construct($name, ZZp15 $db, ZZZZZf5 $ZZZZZe4,$relationDescr){parent::__construct($name,$db,$ZZZZZe4);$this->relationDescr = $relationDescr;} function ZZZZZZZZZZZZZZZZY2424($ZZZZz25,$ZZZZZZZZZZZZZZZZZ2525 = false){$ZZS1818 = parent::ZZZZZZZZZZZZZZZZY2424($ZZZZz25,$ZZZZZZZZZZZZZZZZZ2525);$ZZS1818["title"] = $this->ZZZZZZZZZZZZZZZZZb1.$ZZS1818["title"];return $ZZS1818;} function ZZZZZZZZZZg6($ZZZZZZZZZZZm12 = 0){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = $ZZZZZZZZZZZm12."_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZZe4->ZZZZZw22($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZZc2[$Zf5]['module'] = $ZZZZZZZZZZZm12;$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;}}
;class ZZZZZZZZZZZZZZZZZc2 {public $ZZZZZZZZZZZZZZZZZd3 = array();public $ZZZZZZZZZZZZZZZZZe4 = array();function ZZZZZZZZZZZZZZZZZc2($ZZZZZZZZZZZZZZZZZe4) {$this->ZZZZZZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZZZZZZe4;} function ZZZZZZZZZZZZZZZZZf5() {return $this->ZZZZZZZZZZZZZZZZZd3;} function ZZZZZZZZZZZZZZZZZg6($title) {if(isset($this->ZZZZZZZZZZZZZZZZZe4[$title]) && !empty($this->ZZZZZZZZZZZZZZZZZe4[$title])) {$title = $this->ZZZZZZZZZZZZZZZZZe4[$title];} return $title;} function ZZZZZZZZZZZZZZZZZh7($ZZZW2222, $ZZZZZZZZZZZZZZZZZi8, $db,$ZZZZZe4,$current_user, $ZZZZh7) {$G66 = array();$ZZZZe4 = $ZZZZZe4->ZZZZZg6($current_user);$ZZZZf5 = $ZZZZZe4->ZZZZZh7($current_user);$ZZZZJ99 = $ZZZZZe4->getUserGroups($ZZZZf5);$ZZZZZZZZZZZZZZZZZj9 = $db->listReports($ZZZZe4, $ZZZZf5, $ZZZZJ99, $ZZZW2222, $ZZZZh7);$ZZZZZZZZZZZZZZZZZk10 = $ZZZZZZZZZZZZZZZZZi8 . $ZZZW2222;foreach($ZZZZZZZZZZZZZZZZZj9 as $ZZZZZZG66) {if(($ZZZZZZG66["can_edit"]+$ZZZZZZG66["can_delete"])>0){$this->ZZZZZZZZZZZZZZZZZd3[] = $ZZZZZZG66["id"];} $ZZZZZZZZZZZZZZZZZl11 = "";if($ZZZZZZG66["can_delete"] > 0) {$ZZZZZZZZZZZZZZZZZl11 .= '<a href="index.php?module=AnalyticReporting&action=Delete&record='.$ZZZZZZG66["id"].'" data-action="deleteItem" data-id="'.$ZZZZZZG66["id"].'" onclick="return confirm(\''.$ZZZZZe4->ZZZZZw22('label_delete', 'AnalyticReporting').': '.htmlspecialchars($ZZZZZZG66["title"]).' ?\')">'.$ZZZZZe4->ZZZZZw22('label_delete', 'AnalyticReporting').'</a>';} if($ZZZZe4) {$ZZZZZZZZZZZZZZZZZl11 .= ' | ';if($ZZZZZZG66["visible"] == 1) {$ZZZZZZZZZZZZZZZZZl11 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=report&record='.$ZZZZZZG66["id"].'&value=0&to_pdf=1">'.$ZZZZZe4->ZZZZZw22('label_hide', 'AnalyticReporting').'</a>';} else {$ZZZZZZZZZZZZZZZZZl11 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=report&record='.$ZZZZZZG66["id"].'&value=1&to_pdf=1">'.$ZZZZZe4->ZZZZZw22('label_unhide', 'AnalyticReporting').'</a>';}} $G66[] = array("id" => $ZZZZZZG66['id'], "parent" => $ZZZZZZZZZZZZZZZZZk10, "text" => $this->ZZZZZZZZZZZZZZZZZg6($ZZZZZZG66["title"]), "data" => array("description" => $ZZZZZZG66["description"], "tools"	=> $ZZZZZZZZZZZZZZZZZl11,), "a_attr" => array("href" => "index.php?module=AnalyticReporting&action=report&record=".$ZZZZZZG66["id"],), "type" => "report");} return $G66;} function ZZZZZZZZZZZZZZZZZm12($db, $ZZZZZe4, $current_user, $ZZZZh7) {$ZZZZZZZZZZZZZZZZZn13 = array();$ZZZZZZZZZZZZZZZZZi8 = "c_";$ZZZZe4 = $ZZZZZe4->ZZZZZg6($current_user);$ZZZZZZZZZZZZZZZZZo14 = " WHERE `visible` = 1 ";$ZZZZZZZe4 = " AND `visible` = 1 ";if($ZZZZh7) {$ZZZZZZZZZZZZZZZZZo14 = "";$ZZZZZZZe4 = "";} $ZZq16 = "SELECT * FROM `advancedreports_categories` $ZZZZZZZZZZZZZZZZZo14 ORDER BY `sequence` ASC";$ZZZZT1919 = $db->ZZZC22($ZZq16);foreach($ZZZZT1919 as $ZZZZZZZZZZZZZZZZZp15) {$ZZZW2222 = $ZZZZZZZZZZZZZZZZZp15["id"];$ZZZZZZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZZZZZZp15["parent_id"];$ZZZZZZZZZZZZZZZZZr17 = $db->ZZZC22("SELECT COUNT(*) FROM `advancedreports` WHERE `category_id` = ". (int)$ZZZW2222 . " " . $ZZZZZZZe4);$ZZZZZZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZZZZZZr17[0]['COUNT(*)'];$ZZZZZZZZZZZZZZZZZk10 = $ZZZZZZZZZZZZZZZZZi8 . $ZZZW2222;$ZZZZZZZZZZZZZZZZZs18 = $ZZZZZZZZZZZZZZZZZi8 . $ZZZZZZZZZZZZZZZZZq16;if(!$ZZZZZZZZZZZZZZZZZq16 || $ZZZZZZZZZZZZZZZZZq16 == 0) {$ZZZZZZZZZZZZZZZZZs18 = "#";} $ZZZZZZZZZZZZZZZZZl11 = "";if($ZZZZZZZZZZZZZZZZZr17 == 0) {$ZZZZZZZZZZZZZZZZZl11 .= '<a href="#" data-action="deleteCategory" data-id="'.$ZZZW2222.'">'.$ZZZZZe4->ZZZZZw22('label_delete', 'AnalyticReporting').'</a>';$ZZZZZZZZZZZZZZZZZl11 .= ' | ';} $ZZZZZZZZZZZZZZZZZl11 .= '<a href="#" data-action="editCategory" data-id="'.$ZZZW2222.'" data-title="'.$ZZZZZZZZZZZZZZZZZp15["title"].'" data-description="'.$ZZZZZZZZZZZZZZZZZp15["description"].'">'.$ZZZZZe4->ZZZZZw22('label_edit', 'AnalyticReporting').'</a>';$ZZZZZZZZZZZZZZZZZl11 .= ' | ';$ZZZZZZZZZZZZZZZZZl11 .= '<a href="#" data-action="addCategory" data-id="'.$ZZZW2222.'">'.$ZZZZZe4->ZZZZZw22('label_add_folder', 'AnalyticReporting').'</a>';if($ZZZZe4) {$ZZZZZZZZZZZZZZZZZl11 .= ' | ';if($ZZZZZZZZZZZZZZZZZp15["visible"] == 1) {$ZZZZZZZZZZZZZZZZZl11 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=category&record='.$ZZZW2222.'&value=0&to_pdf=1">'.$ZZZZZe4->ZZZZZw22('label_hide', 'AnalyticReporting').'</a>';} else {$ZZZZZZZZZZZZZZZZZl11 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=category&record='.$ZZZW2222.'&value=1&to_pdf=1">'.$ZZZZZe4->ZZZZZw22('label_unhide', 'AnalyticReporting').'</a>';}} $ZZZZZZZZZZZZZZZZZn13[] = array("id" => $ZZZZZZZZZZZZZZZZZk10, "parent" => $ZZZZZZZZZZZZZZZZZs18, "text" => $this->ZZZZZZZZZZZZZZZZZg6($ZZZZZZZZZZZZZZZZZp15["title"]), "data" => array("description" => $ZZZZZZZZZZZZZZZZZp15["description"], "tools"	=> $ZZZZZZZZZZZZZZZZZl11), "type" => "category");$ZZZZZZZZZZZZZZZZZt19 = $this->ZZZZZZZZZZZZZZZZZh7($ZZZW2222, $ZZZZZZZZZZZZZZZZZi8, $db, $ZZZZZe4, $current_user, $ZZZZh7);$ZZZZZZZZZZZZZZZZZn13 = array_merge($ZZZZZZZZZZZZZZZZZt19, $ZZZZZZZZZZZZZZZZZn13);} return $ZZZZZZZZZZZZZZZZZn13;}}
;class ZZZZZZZZZZZZZZZZZu20 {protected $db;protected $ZZZZZe4;function __construct($db, $ZZZZZe4) {$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;} function ZZZZZZZZZZZZZZZZZv21($ZZZZZZZZZZZZZZZZZw22,$ZZZZZZZZZZZZZZZZZx23,$ZZZZZZZZZZZZZZZZZy24){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZw22);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array('id'=>$ZZZZZZZZZZZZZZZZZx23.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"], 'name'=>$ZZZZZZZZZZZZZZZZZy24.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["name"]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZZZZZw22,$prefix){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZw22);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZZw22[$Zf5]["level"]==2) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"]] = "DELETE";elseif($ZZZZZZZZZZZZZZZZZw22[$Zf5]["level"]==1) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"]] = "EDIT";else $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"]] = "VIEW";} return $ZZS1818;} function ZZZZq16(){return $this->db->ZZZZq16();} function ZZZZZZZZZZZZZZZZZA00(){$ZZZZL1111 = $this->db->ZZZZq16();$ZZZZL1111 = $this->ZZZZZZZZZZZZZZZZZv21($ZZZZL1111,"u_",$this->ZZZZZe4->ZZZZZw22("label_user","AnalyticReporting")."::");$ZZZZP1515 = $this->db->ZZZZC22();$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZv21($ZZZZP1515,"r_",$this->ZZZZZe4->ZZZZZw22("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZZZL1111, $ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZB11($ZZZK1010){$ZZZZL1111 = $this->db->ZZZZr17($ZZZK1010);$ZZZZL1111 = $this->ZZZZZZZZZZZZZZZZZz25($ZZZZL1111,"u_");$ZZZZP1515 = $this->db->ZZZZA00($ZZZK1010);$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZz25($ZZZZP1515,"r_");$ZZS1818 = array_merge($ZZZZL1111,$ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZC22(){$ZZS1818 = $this->ZZZZZZZZZZZZZZZZZA00();$ZZZZP1515 = $this->db->ZZZZC22();$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZv21($ZZZZP1515,"r_",$this->ZZZZZe4->ZZZZZw22("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZS1818,$ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZD33($prefix,$name,$ZZZZZZZZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZj9);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $prefix.$ZZZZZZZZZZZZZZZZZj9[$Zf5][$name];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZE44($ZZZK1010){$ZZZZL1111 = $this->db->ZZZZs18($ZZZK1010);$ZZZZL1111 = $this->ZZZZZZZZZZZZZZZZZD33("u_","user",$ZZZZL1111);$ZZZZP1515 = $this->db->ZZZZu20($ZZZK1010);$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZD33("r_","role",$ZZZZP1515);$ZZS1818 = array_merge($ZZZZL1111,$ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZF55($ZZZK1010){$ZZZH77 = $this->db->ZZZC22("SELECT * FROM advancedreports_schedule WHERE id = $ZZZK1010");$ZZS1818 = array("isScheduled" => false, "interval" => 0, "intervalOptions" => array("01","01"), "timeH" => "12", "timeM" => "00", "formats" =>new stdClass(),);if(!empty($ZZZH77)){$ZZS1818["isScheduled"] = true;$ZZS1818["interval"] = $ZZZH77[0]['interval'];$ZZZZZZZZZZZZZZZZZG66 = explode(":",$ZZZH77[0]["time"]);$ZZS1818["timeH"] = $ZZZZZZZZZZZZZZZZZG66[0];$ZZS1818["timeM"] = $ZZZZZZZZZZZZZZZZZG66[1];$ZZS1818["intervalOptions"] = $ZZZH77[0]["interval_options"];if(in_array($ZZS1818["interval"],array(2,4))){$ZZS1818["intervalOptions"] = explode("-",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==3){$ZZS1818["intervalOptions"] = array("01",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==1){$ZZS1818["intervalOptions"] = array($ZZS1818["intervalOptions"],"01");} if(!empty($ZZZH77[0]["formats"])){$ZZS1818["formats"] = json_decode($ZZZH77[0]["formats"]);}else{$ZZS1818["formats"] = json_decode('{"xlsx":true,"pdf":false,"url":false}');}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZH77($ZZZZZi8,$report){if($this->ZZZZZe4->ZZZZZg6($ZZZZZi8)){return 3;} $ZZZZf5 = $this->ZZZZZe4->ZZZZZh7($ZZZZZi8);$ZZZZJ99 = $this->ZZZZZe4->getUserGroups($ZZZZf5);$ZZZH77 = $this->db->ZZZZH77($ZZZZf5,$ZZZZJ99,$report);$ZZS1818 = ($ZZZH77[0]['level'] == null) ? 0 : $ZZZH77[0]['level'] + 1;return $ZZS1818;} function ZZZZZZZZZZZZZZZZZI88($ZZZK1010,$r17){$ZZZZJ99 = array();$ZZZZL1111 = array();foreach($r17 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZZH77 = explode("_",$ZZZZa0,2);if(count($ZZZH77) == 2){if($ZZZZZZZZZZZZZZZr17=="DELETE") $ZZZZZZZZZZZZZZZZZJ99 = 2;elseif ($ZZZZZZZZZZZZZZZr17=="EDIT") $ZZZZZZZZZZZZZZZZZJ99 = 1;else $ZZZZZZZZZZZZZZZZZJ99 = 0;if($ZZZH77[0]=="u"){$ZZZZL1111[] = array($ZZZK1010,$ZZZH77[1],$ZZZZZZZZZZZZZZZZZJ99);}else{$ZZZZJ99[] = array($ZZZK1010,$ZZZH77[1],$ZZZZZZZZZZZZZZZZZJ99);}}} $this->db->ZZZZI88($ZZZK1010,$ZZZZJ99);$this->db->ZZZZK1010($ZZZK1010,$ZZZZL1111);} function ZZZZZZZZZZZZZZZZZK1010($ZZZK1010,$r17){$ZZZZL1111 = array();$ZZZZJ99 = array();$ZZZZP1515 = array();$ZZT1919 = count($r17);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZH77 = explode("_",$r17[$Zf5], 2);switch($ZZZH77[0]){case "u": $ZZZZL1111[]= $ZZZH77[1];break;case "g": $ZZZZJ99[]= $ZZZH77[1];break;case "r": $ZZZZP1515[]= $ZZZH77[1];break;}} $this->db->ZZZZN1313($ZZZK1010,$ZZZZL1111);$this->db->ZZZZO1414($ZZZK1010,$ZZZZP1515);} function ZZZZZZZZZZZZZZZZZL1111($ZZZK1010){$this->db->ZZZI88("DELETE FROM advancedreports_schedule WHERE id = ?", array($ZZZK1010));$this->db->ZZZI88("DELETE FROM advancedreports_schedule_u WHERE id = ?", array($ZZZK1010));$this->db->ZZZI88("DELETE FROM advancedreports_schedule_r WHERE id = ?", array($ZZZK1010));} function ZZZZZZZZZZZZZZZZZM1212($ZZZZZZZZZZZZZZZZZN1313,$ZZZZZZZZZZZZZZZZZO1414,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZa0){$ZZZZZZZZZZZZZZZZZP1515 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZN1313){case 1: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("this ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414]);break;case 2: $ZZZZZZZZZZZZZZZZZO1414 = explode("-",$ZZZZZZZZZZZZZZZZZO1414,2);if($ZZZZZZZZZZZZZZZZZO1414[1] == 0){$ZZZZZZZZZZZZZZZZZR1717 = "first";$ZZZZZZZZZZZZZZZZZS1818 = "third";}else{$ZZZZZZZZZZZZZZZZZR1717 = "second";$ZZZZZZZZZZZZZZZZZS1818 = "fourth";} $ZZZZZZZZZZZZZZZZZT1919 = strtotime('today');$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZR1717." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of this month");if($ZZZZZZZZZZZZZZZZZT1919>$ZZZZZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZS1818." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of this month");} break;case 3: $ZZZH77 = date("Y-m-d");$ZZZH77 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZO1414,$ZZZH77);$ZZZZZZZZZZZZZZZZZU2020 = date('Y-m-d', strtotime('last day of this month'));if($ZZZH77>$ZZZZZZZZZZZZZZZZZU2020){$ZZZH77 = $ZZZZZZZZZZZZZZZZZU2020;} $ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 4: $ZZZZZZZZZZZL1111 = ((int)date("Y"));$ZZZH77 = $ZZZZZZZZZZZL1111."-".$ZZZZZZZZZZZZZZZZZO1414;$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 0: default: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("today");break;} $ZZZZZZZZZZZZB11 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZZZZZV2121 = $ZZZZZZZZZZZZB11.$ZZZZZZZZZZZZZZZZZG66.":00";$ZZZZZZZZZZZZZZZZZW2222 = date_default_timezone_get();date_default_timezone_set($ZZZZZZZa0);$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZZZZZZV2121);date_default_timezone_set($ZZZZZZZZZZZZZZZZZW2222);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZp15);} function ZZZZZZZZZZZZZZZZZX2323($ZZZZZZZZZZZZZZZZZN1313,$ZZZZZZZZZZZZZZZZZO1414,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZa0){$ZZZZZZZZZZZZZZZZZP1515 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZN1313){case 1: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("next ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414]);break;case 2: $ZZZZZZZZZZZZZZZZZO1414 = explode("-",$ZZZZZZZZZZZZZZZZZO1414,2);if($ZZZZZZZZZZZZZZZZZO1414[1] == 0){$ZZZZZZZZZZZZZZZZZR1717 = "first";$ZZZZZZZZZZZZZZZZZS1818 = "third";}else{$ZZZZZZZZZZZZZZZZZR1717 = "second";$ZZZZZZZZZZZZZZZZZS1818 = "fourth";} $ZZZZZZZZZZZZZZZZZT1919 = date("Y-m-d");$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZS1818." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of this month");if($ZZZZZZZZZZZZZZZZZT1919>=date("Y-m-d",$ZZZZZZZZZZZZZZZZZQ1616)){$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZR1717." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of next month");} break;case 3: $ZZZH77 = date("Y-m-d",strtotime("+1 month"));$ZZZH77 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZO1414,$ZZZH77);$ZZZZZZZZZZZZZZZZZU2020 = date('Y-m-d', strtotime('last day of next month'));if($ZZZH77>$ZZZZZZZZZZZZZZZZZU2020){$ZZZH77 = $ZZZZZZZZZZZZZZZZZU2020;} $ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 4: $ZZZZZZZZZZZL1111 = ((int)date("Y") + 1);$ZZZH77 = $ZZZZZZZZZZZL1111."-".$ZZZZZZZZZZZZZZZZZO1414;$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 0: default: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("+1 day");break;} $ZZZZZZZZZZZZB11 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZZZZZV2121 = $ZZZZZZZZZZZZB11.$ZZZZZZZZZZZZZZZZZG66.":00";$ZZZZZZZZZZZZZZZZZW2222 = date_default_timezone_get();date_default_timezone_set($ZZZZZZZa0);$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZZZZZZV2121);date_default_timezone_set($ZZZZZZZZZZZZZZZZZW2222);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZp15);} function ZZZZZZZZZZZZZZZZZY2424($id,$ZZZZZZZZZZZZZZZZZN1313,$ZZZZZZZZZZZZZZZZZZ2525,$ZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZb1,$ZZZN1313,$ZZZZZZZZZZZZZZZZZZc2){$ZZZZZi8 = new User();$ZZZZZi8->retrieve((int)$ZZZN1313);$ZZZZZZZZZZZZZZZZZZc2 = json_decode($ZZZZZZZZZZZZZZZZZZc2);if(is_a($ZZZZZZZZZZZZZZZZZZc2,"stdClass") && (property_exists($ZZZZZZZZZZZZZZZZZZc2,"xlsx") || property_exists($ZZZZZZZZZZZZZZZZZZc2,"pdf") || property_exists($ZZZZZZZZZZZZZZZZZZc2,"url"))){$ZZZZZZZZZZZZZZZZZZc2 = json_encode($ZZZZZZZZZZZZZZZZZZc2);}else{$ZZZZZZZZZZZZZZZZZZc2 = "";} $ZZZZZZZZZZZZZZZZZZd3 = TimeDate::userTimezone($ZZZZZi8);$ZZZZZZZZZZZZZZZZZG66 = $ZZZZZZZZZZZZZZZZZZ2525.":".$ZZZZZZZZZZZZZZZZZZa0;$ZZZg6 = "";if($ZZZZZZZZZZZZZZZZZN1313 == 1){$ZZZg6 = (int)$ZZZZZZZZZZZZZZZZZZb1[0];}else if($ZZZZZZZZZZZZZZZZZN1313 == 2){$ZZZg6 = ((int)$ZZZZZZZZZZZZZZZZZZb1[0])."-".((int)$ZZZZZZZZZZZZZZZZZZb1[1]) ;}else if($ZZZZZZZZZZZZZZZZZN1313 == 3){$ZZZg6 = $ZZZZZZZZZZZZZZZZZZb1[1];}else if($ZZZZZZZZZZZZZZZZZN1313 == 4){$ZZZg6 = $ZZZZZZZZZZZZZZZZZZb1[0]."-".$ZZZZZZZZZZZZZZZZZZb1[1];} $ZZZZZZZZZZZZZZZZZZe4 = $this->ZZZZZZZZZZZZZZZZZM1212($ZZZZZZZZZZZZZZZZZN1313,$ZZZg6,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZZZZZZZZZZZZd3);if($ZZZZZZZZZZZZZZZZZZe4<date("Y-m-d H:i:s")){$ZZZZZZZZZZZZZZZZZZe4 = $this->ZZZZZZZZZZZZZZZZZX2323($ZZZZZZZZZZZZZZZZZN1313,$ZZZg6,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZZZZZZZZZZZZd3);} $this->db->ZZZI88("INSERT INTO advancedreports_schedule (`id`, `interval`, `interval_options`, `time`,`nexttime`, `formats`) VALUES(?,?,?,?,'$ZZZZZZZZZZZZZZZZZZe4',?) ON DUPLICATE KEY UPDATE `interval`=VALUES(`interval`), `interval_options`=VALUES(`interval_options`), `time`=VALUES(`time`), `formats`=VALUES(`formats`), `nexttime`='$ZZZZZZZZZZZZZZZZZZe4' ", array($id,$ZZZZZZZZZZZZZZZZZN1313,$ZZZg6,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZZZZZZZZZZZZc2));}} ;class ZZZZZZZZZZZZZZZZZZf5{public static function ZZZZZZZZZZZZZZZZZZg6($ZZZZZZZZZZa0){global $mod_strings;$ZZZZZZZZZZZZZZZZZZh7 = array();if(empty($ZZZZZZZZZZa0['reportTitle'])){$ZZZZZZZZZZZZZZZZZZh7['statusCode'] = 2;$ZZZZZZZZZZZZZZZZZZh7['statusMessage'] = $mod_strings['noNameError'];}else{$ZZZZZZZZZZZZZZZZZZh7['statusCode'] = 1;} return $ZZZZZZZZZZZZZZZZZZh7;} public static function ZZZZZZZZZZZZZZZZZZi8($ZZZZZZZZZZa0, $ZZZZZZZZZZT1919){$ZZZZZZZZZZZZg6 = $ZZZZZZZZZZa0['selectedReportType'] == 'combined'?"":$ZZZZZZZZZZa0['selectedModules'][0]['moduleName'];$ZZZZZZZZZZZZZZZZZZj9 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZk10($ZZZZZZZZZZa0['selectedModules'][0]['children']);$ZZZZZZZZZZZZZZZZZZl11 = "'[".implode ("," , $ZZZZZZZZZZZZZZZZZZj9)."]'";$ZZZZZZZZZZZZZZZZZZm12 = $ZZZZZZZZZZa0;$ZZZZZZZZZZZZZZZZZZm12['selectedReportType'] = $ZZZZZZZZZZa0['selectedReportType'] == 'combined'?1:0;$ZZZZZZZZZZZZZZZZZZm12['selectedModules'] = $ZZZZZZZZZZZZZZZZZZl11;$ZZZZZZZZZZZZZZZZZZm12['mainModuleName'] = $ZZZZZZZZZZZZg6;$ZZZZZZZZZZZZZZZZZZm12['owner'] = $ZZZZZZZZZZT1919;return $ZZZZZZZZZZZZZZZZZZm12;} public static function ZZZZZZZZZZZZZZZZZZn13($ZZZZZZZZZZu20){$ZZZZZZZZZZZZZZZZZZo14 = array();foreach($ZZZZZZZZZZu20 as $module){$ZZZZZZZZZZZZZZZZZZo14[] = array('name' => $module, 'title' => $module);} return $ZZZZZZZZZZZZZZZZZZo14;} public static function ZZZZZZZZZZZZZZZZZZp15($ZZZZZZZZZZu20, $ZZZZZZZZZZZZZZZZZZq16){$ZZV2121 = array();foreach($ZZZZZZZZZZu20 as $module){$ZZV2121[$module]['fields'] = $ZZZZZZZZZZZZZZZZZZq16->ZZW2222($module);} return $ZZV2121;} public static function ZZZZZZZZZZZZZZZZZZr17($ZZZZZZZZZZZZZZZZZZs18){$ZZZZZZZZZZZZZZZZZZt19 = array();foreach($ZZZZZZZZZZZZZZZZZZs18 as $moduleName => $ZZZZZz25){$ZZZZZL1111 = "";$ZZZZZZZZZZZZZZZZZZu20 = array();$ZZZZZZZZZZZZZZZZZZv21 = array();if(isset($ZZZZZz25['nameField']['relation']['entityidfield'])){$ZZZZZL1111 = $ZZZZZz25['nameField']['relation']['entityidfield'];} foreach($ZZZZZz25['fields'] as $field){if(strpos($field['columnname'], 'id')!==false){$ZZZZZZZZZZZZZZZZZZu20[] = array('name' => $field['columnname'], 'title'=> $field['columnname']);}else{$ZZZZZZZZZZZZZZZZZZv21[] = array('name' => $field['columnname'], 'title'=> $field['columnname']);}} if(!empty($ZZZZZL1111)){$ZZZZZZZZZZZZZZZZZZt19[$moduleName][] = array('name' => 'decorator', 'title'=> '---Primary Key---', 'disabled'=>'disabled');$ZZZZZZZZZZZZZZZZZZt19[$moduleName][] = array('name' => $ZZZZZL1111, 'title'=> $ZZZZZL1111);} if(!empty($ZZZZZZZZZZZZZZZZZZu20)){$ZZZZZZZZZZZZZZZZZZt19[$moduleName][] = array('name' => 'decorator', 'title'=> '---Filtered IDs---', 'disabled'=>'disabled');$ZZZZZZZZZZZZZZZZZZt19[$moduleName] = array_merge($ZZZZZZZZZZZZZZZZZZt19[$moduleName], $ZZZZZZZZZZZZZZZZZZu20);} if(!empty($ZZZZZZZZZZZZZZZZZZv21)){$ZZZZZZZZZZZZZZZZZZt19[$moduleName][] = array('name' => 'decorator', 'title'=> '---Other---', 'disabled'=>'disabled');$ZZZZZZZZZZZZZZZZZZt19[$moduleName] = array_merge($ZZZZZZZZZZZZZZZZZZt19[$moduleName], $ZZZZZZZZZZZZZZZZZZv21);}} return $ZZZZZZZZZZZZZZZZZZt19;} public static function ZZZZZZZZZZZZZZZZZZk10($ZZZZZZZZZZu20, $ZZZZZR1717 = 0){$ZY2424 = array();static $ZZZZZZZZZZZZZZZZZZw22 = 0;if(empty($ZZZZZZZZZZu20)){return array();} foreach($ZZZZZZZZZZu20 as $module){$ZZZZZZZZZZw22 = ZZZZZZZZZZx23::ZZZb1($module['moduleName'], true);$ZZZn13 = $ZZZZZZZZZZw22->ZZZZZZZZZZs18('columnname', $module['moduleFieldName']);$ZZY2424 = PlatformConnector::ZZZZZZk10($module['moduleName']);if($ZZZn13 !== false){$ZZY2424 = $ZZZn13['tablename'];} $ZZZZZZZZZZw22 = ZZZZZZZZZZx23::ZZZb1($module['parentModuleName'], true);$ZZZZZZZZZZZZZZZZZZx23 = $ZZZZZZZZZZw22->ZZZZZZZZZZs18('columnname', $module['parentModuleFieldName']);$ZZZZZZZZZZZZZZZZZZy24 = PlatformConnector::ZZZZZZk10($module['parentModuleName']);if($ZZZZZZZZZZZZZZZZZZx23 !== false){$ZZZZZZZZZZZZZZZZZZy24 = $ZZZZZZZZZZZZZZZZZZx23['tablename'];} $ZZZZZZZZZZZZZZZZZZz25 = "";$ZZZZZZC22 = "inverse";if($module['relation'] == 'manyToMany'){$ZZZZZZC22="many";$ZZZZZZZZZZZZZZZZZZz25 = ", \"{$module['manyToMany']['tableName']}\", \"{$module['manyToMany']['mainModuleColumnName']}\", \"{$module['manyToMany']['subModuleColumnName']}\"";if($module['manyToMany']['roleRequired']=="true"){$ZZZZZZZZZZZZZZZZZZz25 .= ", \"{$module['manyToMany']['roleIndex']}\", \"{$module['manyToMany']['roleValue']}\"";}} $ZY2424[] = "[\"{$module['moduleName']}\",\"{$ZZZZZZC22}\",\"{$module['parentModuleFieldName']}\",\"{$module['moduleFieldName']}\",\"{$ZZZZZZZZZZZZZZZZZZy24}\",\"{$ZZY2424}\",{$ZZZZZR1717}{$ZZZZZZZZZZZZZZZZZZz25}]";$ZZZZZZZZZZZZZZZZZZw22++;if(isset($module['children']) && !empty($module['children'])){$ZZZZZZZZZZZZZZZZZZA00 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZk10($module['children'], $ZZZZZZZZZZZZZZZZZZw22);foreach($ZZZZZZZZZZZZZZZZZZA00 as $report){$ZY2424[] = $report;}}} return $ZY2424;} public static function ZZZZZZZZZZZZZZZZZZB11($ZZZZT1919){$ZZZZZZZZZZZZZZZZZZC22 = array();for($Zf5=0,$ZZZZZZZZZZv21=count($ZZZZT1919);$Zf5<$ZZZZZZZZZZv21;$Zf5++){$ZZZZZZZZZZZZZZZZZZC22[] = array('name' => $ZZZZT1919[$Zf5]['id'], 'title' => $ZZZZT1919[$Zf5]['title']);} return $ZZZZZZZZZZZZZZZZZZC22;}}
;require_once 'modules/AnalyticReporting/lib/PHPEXCEL/Classes/PHPExcel.php';function retrieveData($adb,$ZZZZZZZZZZZZZZZZZZD33 = false,$ZZZZZZZZZZZZZZZZZZE44 = null){$ZZZZZe4 = new ZZZZZf5();if(!$ZZZZZZZZZZZZZZZZZZD33){$db = new ZZp15($adb);$ZZZZZZZZZZZZZZZZZZE44 = $db->loadReport((int)$_REQUEST["record"]);}else{$db = $adb;$ZZZZZZZZZZZZZZZZZZE44["related_data"] = json_decode($ZZZZZZZZZZZZZZZZZZE44["related_data"]);} $ZZZZZZZZZZZZZQ1616 = PlatformConnector::ZZZZZZq16();$ZZZR1717 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["labels"],true):json_decode($_POST['labels'],true);if(isset($_REQUEST["combined"]) &&$_REQUEST["combined"] == 1){$module = null;$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZZm12($db, $ZZZZZe4, $ZZZR1717);}else{$module = new ZZZZZZZZZZH77($ZZZZZZZZZZZZZZZZZZE44["module"],$db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZI88($db, $ZZZZZe4, $ZZZR1717);} $ZZZZZZZZZZZZZZZZZZG66 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZE44["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZG66[] = new ZZZZZZZZZZE44($ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][9]);} $ZZZg6 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]):json_decode($_POST["options"]);if(!isset($ZZZg6->aggregateColumn)){$ZZZg6->aggregateColumn = false;} global $current_user;$id = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZI88 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZH77($current_user,$id);if($ZZZZZZZZZZZZZZZZZZI88 == 1){$_POST['columns'] = $ZZZZZZZZZZZZZZZZZZE44["fields"];$_POST['filters'] = $ZZZZZZZZZZZZZZZZZZE44["filters"];$_POST['labels'] = $ZZZZZZZZZZZZZZZZZZE44["labels"];} $r17 = $ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZN1313($module, ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["fields"]):json_decode($_POST['columns']), ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["filters"]):json_decode($_POST['filters']), $ZZZZZZZZZZZZZZZZZZG66, ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["grouping"],true):json_decode($_POST['grouping'],true), ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["aggregates"],true):json_decode($_POST['aggregates'],true), !$ZZZg6->includeDetails, $ZZZg6->isCrosstab, false, $ZZZg6->aggregateColumn, "yyyy-mm-dd", false, ($ZZZZZZZZZZZZZZZZZZD33) ? json_decode($ZZZZZZZZZZZZZZZZZZE44["calcFields"],true) : json_decode($_POST['calcFields'], true), array(), $ZZZZZZZZZZZZZQ1616);if((isset($_REQUEST['file']) && $_REQUEST['file'] == 'makePDF') || count($_REQUEST) == 0){$ZZZZZZZZZZZZZZZZZZJ99 = $ZR1717 = $ZZZZZZZZZZZZZZZZZZK1010 = $ZZZP1515 = $ZZZZZZZZZZZZZZZZZZL1111 = $ZZZZZZZZZZZZZZZZZZM1212 = array();$ZZZZZZZZZZZZZZZZZZJ99 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["grouping"],true):json_decode($_POST['grouping'],true);$ZZZZZZZZZZZZZZZZZZN1313 = 0;if(!$ZZZg6->includeDetails && !$ZZZg6->aggregateColumn){foreach ($ZZZZZZZZZZZZZZZZZZJ99 as $ZZZZy24) {if(!$ZZZg6->isCrosstab || $ZZZZy24['position'] == 'row'){if($ZZZZy24['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name']."_".$ZZZZy24['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name'];$ZZZZZZZZZZZZZZZW2222[] = $ZZZZZZZZZZZZZZZZZZO1414;if(isset($ZZZZy24['showAggregates'])){foreach($ZZZZy24['showAggregates'] as $ZZZZZZZZZZZZZZZZZZP1515 => $ZZZZZZZZZZZZZc2){if(isset($ZZZZZZZZZZZZZc2['sum']) && $ZZZZZZZZZZZZZc2['sum']) $ZZZP1515[] = $ZZZZZZZZZZZZZZZZZZP1515."_sum";if(isset($ZZZZZZZZZZZZZc2['count']) && $ZZZZZZZZZZZZZc2['count']) $ZZZP1515[] = $ZZZZZZZZZZZZZZZZZZP1515."_cnt";}}}} array_pop($ZZZZZZZZZZZZZZZW2222);$ZZZP1515 = array_unique($ZZZP1515);if(count($ZZZZZZZZZZZZZZZW2222)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZR1717) {foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818] != $ZZZZZZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZZZZZZS1818]){$ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919]))$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;unset($ZZZZZZZZZZZZZZZZZZA00);}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZZZZS1818);if($ZZZZZZZZZZZZZZZZZZS1818 == $ZZZZZZZZZZZZZZZW2222[0]) {foreach ($ZZZZZZZZZZZZZZZZZZK1010 as &$ZZZZZZZZZZZZZZZZZZU2020) $ZZZZZZZZZZZZZZZZZZU2020 = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZR1717 as $ZZZZZZZZZZZZZZZZZZV2121 => $ZZZZZZZZZZZZZZZZZZW2222) {$ZZZZZZZZZZZZZZZZZZX2323 = preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZV2121);foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZX2323, $ZZZP1515)){$ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] += $ZZZZZZZZZZZZZZZZZZW2222;} elseif((!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZX2323, $ZZZP1515)) || in_array($ZZZZZZZZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZZZW2222)){$ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] = $ZZZZZZZZZZZZZZZZZZW2222;}}}} $ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;if(!empty($ZR1717)){do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919]))$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;unset($ZZZZZZZZZZZZZZZZZZA00);}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZW2222[0]);} $r17["data"] = ZZZZZZZZZZZZZZZZZZY2424($r17["data"], $ZZZP1515);}}elseif ($ZZZg6->includeDetails) {foreach ($ZZZZZZZZZZZZZZZZZZJ99 as $ZZZZy24) {if($ZZZZy24['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name']."_".$ZZZZy24['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name'];$ZZZZZZZZZZZZZZZW2222[] = $ZZZZZZZZZZZZZZZZZZO1414;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZO1414] = 0;foreach($ZZZZy24['showAggregates'] as $ZZZZZZZZZZZZZZZZZZP1515 => $ZZZZZZZZZZZZZc2){if(isset($ZZZZZZZZZZZZZc2['sum']) && $ZZZZZZZZZZZZZc2['sum']) $ZZZZZZZZZZZZZZZZZZL1111[] = $ZZZZZZZZZZZZZZZZZZP1515;if(isset($ZZZZZZZZZZZZZc2['count']) && $ZZZZZZZZZZZZZc2['count']) $ZZZZZZZZZZZZZZZZZZM1212[] = $ZZZZZZZZZZZZZZZZZZP1515;} $ZZZZZZZZZZZZZZZZZZL1111 = array_unique($ZZZZZZZZZZZZZZZZZZL1111);$ZZZZZZZZZZZZZZZZZZM1212 = array_unique($ZZZZZZZZZZZZZZZZZZM1212);} if(count($ZZZZZZZZZZZZZZZW2222)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZR1717) {foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818] != $ZZZZZZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZZZZZZS1818]){$ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZZZZS1818);if($ZZZZZZZZZZZZZZZZZZS1818 == $ZZZZZZZZZZZZZZZW2222[0]) {foreach ($ZZZZZZZZZZZZZZZZZZK1010 as &$ZZZZZZZZZZZZZZZZZZU2020) $ZZZZZZZZZZZZZZZZZZU2020 = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZR1717 as $ZZZZZZZZZZZZZZZZZZV2121 => $ZZZZZZZZZZZZZZZZZZW2222) {foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZL1111)) $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] += $ZZZZZZZZZZZZZZZZZZW2222;elseif(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZM1212)) $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]++;elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && (in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZW2222) || in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZL1111))){$ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] = $ZZZZZZZZZZZZZZZZZZW2222;} elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZM1212)) $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] = 1;}}} $ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZW2222[0]);$r17["data"] = ZZZZZZZZZZZZZZZZZZY2424($r17["data"], $ZZZZZZZZZZZZZZZZZZM1212);}}} $r17["title"] = $ZZZZZZZZZZZZZZZZZZE44["title"];return $r17;} function ZZZZZZZZZZZZZZZZZZY2424($r17, $ZZZZZZZZZZZZZZZZZZM1212){global $current_user;$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZZ2525 = $ZZZZZe4->ZZZZZj9($current_user);$ZZZZZZZZZZZZZZZZZZZa0 = $ZZZZZZZZZZZZZZZZZZZ2525['decimal'];$ZZZZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZZZZZZZ2525['seperator'];$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();foreach ($r17 as $ZZZZZZZZZZZZZZZZZZZc2 => $ZZZZZZZZZZZZZZZZZZZd3) {foreach ($ZZZZZZZZZZZZZZZZZZZd3 as $ZZZZZZZZZZZZZZZZZZZe4 => $ZZZZZZZZZZZZZZZZZZZf5) {if(substr($ZZZZZZZZZZZZZZZZZZZf5, 0, 10) == "<SubTotal>" && is_numeric(str_replace("<SubTotal>", "", $ZZZZZZZZZZZZZZZZZZZf5))){if(substr($ZZZZZZZZZZZZZZZZZZZe4, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZZe4."_cnt", $ZZZZZZZZZZZZZZZZZZM1212) && !in_array($ZZZZZZZZZZZZZZZZZZZe4, $ZZZZZZZZZZZZZZZZZZM1212)){$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]),$ZZZZZZZZZZZF55,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4];}else{$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]),0,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4];}}}} return $r17;} function ZZZZZZZZZZZZZZZZZZZg6($r17){$ZZZZZZZZZZZZZZR1717 = array_keys($r17["cols"]);$ZZS1818 = array();$ZZS1818[] = array_values($r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZZZZF55 = count($r17["data"]);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZF55;$Zf5++){$ZZZH77 = array();for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZT1919;$ZZZZZW2222++){$ZZZH77[] = (isset($r17["data"][$Zf5][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222]]))?($r17["data"][$Zf5][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222]]):("");} $ZZS1818[] = $ZZZH77;} $ZZZZZZZZZZZZZZZZZZZh7 = new PHPExcel();$ZZZZZZZZZZZZZZZZZZZh7->getProperties()->setCreator("Advanced Reporting For vTiger") ->setLastModifiedBy("ITSAPIENS.EU") ->setTitle("REPORT") ->setSubject("REPORT") ->setDescription("REPORT");$ZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZZZZZZZZZZZh7->getActiveSheet();$ZZZZZZZZZZZZZZZZZZZi8->fromArray($ZZS1818);return $ZZZZZZZZZZZZZZZZZZZh7;} function ZZZZZZZZZZZZZZZZZZZj9($r17){if(file_exists(dirname(__FILE__)."/generatePDFHTML.php")) {require_once dirname(__FILE__)."/generatePDFHTML.php";}else{$ZZZZZZZZZZZn13 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZZk10 = count($ZZZZZZZZZZZn13);$ZZZZZZZZZZZZZZZZZZZl11 = "<style> thead{font-weight: bold;} th{font-weight: bold;font-size: 12pt;} td,th{border: solid 1px #000000;page-break-inside:avoid;} tr{page-break-inside:avoid;} table{white-space: nowrap;} </style> <h3>".$r17["title"]."</h3> ";$ZZZZZZZZZZZZZZZZZZZl11.= "<table><thead><tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZZk10;$Zf5++){$ZZZZZZZZZZZZZZZZZZZl11.= "<th><b>";$ZZZZZZZZZZZZZZZZZZZl11.= $r17["cols"][$ZZZZZZZZZZZn13[$Zf5]];$ZZZZZZZZZZZZZZZZZZZl11.= "</b></th>";} $ZZZZZZZZZZZZZZZZZZZl11.= "</tr></thead><tbody>";$ZZT1919 = count($r17["data"]);for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZT1919;$ZZZZZW2222++){$ZZZZZZZZZZZZZZZZZZZl11.= "<tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZZk10;$Zf5++){$ZZZZZZZZZZZZZZZZZZZl11.= "<td>";if(isset($r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]])){@$ZZZZZZZZZZZZZZZZZZZl11.= (($ZZZZZZZZZZZn13[$Zf5] == "grand_total" || $r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[0]] == "Grand Total" || substr($r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]], 0, 10) == "<SubTotal>") ? "<b>".$r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]]."</b>":$r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]]);} $ZZZZZZZZZZZZZZZZZZZl11.= "</td>";} $ZZZZZZZZZZZZZZZZZZZl11.= "</tr>";} $ZZZZZZZZZZZZZZZZZZZl11.= "</tbody></table>";} return $ZZZZZZZZZZZZZZZZZZZl11;}
function ZZZZZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZZZZZn13){if($ZZZZZZZZZZZZZZZZZZZn13 <= 760) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A4";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >= 761 && $ZZZZZZZZZZZZZZZZZZZn13 <= 1120) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A3";}elseif($ZZZZZZZZZZZZZZZZZZZn13 >=1121 && $ZZZZZZZZZZZZZZZZZZZn13 <= 1600) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A2";}elseif($ZZZZZZZZZZZZZZZZZZZn13 >=1601 && $ZZZZZZZZZZZZZZZZZZZn13 <= 2200) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A1";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >=2201 && $ZZZZZZZZZZZZZZZZZZZn13 <= 3360) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A0";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >=3361 && $ZZZZZZZZZZZZZZZZZZZn13 <= 4680) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "2A0";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >=4681 && $ZZZZZZZZZZZZZZZZZZZn13 <= 6490) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "4A0";}else{$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = array(round($ZZZZZZZZZZZZZZZZZZZn13/1.5),$ZZZZZZZZZZZZZZZZZZZn13);} return array($ZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZZZp15);}
;class ZZZk10{static private $ZZZZZZZZZZZZZZZZZZZq16 = 'modules/AnalyticReporting/config';static private $ZZZZZZZZZZZZZZZZZZZr17 = array('reportBuilder' => array('common' => 'common', 'manyToMany' => 'manyToMany',), 'common' => array('common' => 'common'), 'hooks' => array('addCustomTable' => 'addCustomTable'));static function load($type, $name){if(isset(ZZZk10::$ZZZZZZZZZZZZZZZZZZZr17[$type][$name])){$ZZZZZZZZZZZZZZZZZZZs18 = ZZZk10::$ZZZZZZZZZZZZZZZZZZZq16."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZt19 = $ZZZZZZZZZZZZZZZZZZZs18."Custom.php";$ZZZZZZZZZZZZZZZZZZZu20 = $ZZZZZZZZZZZZZZZZZZZs18."Default.php";if (file_exists($ZZZZZZZZZZZZZZZZZZZt19)){return include $ZZZZZZZZZZZZZZZZZZZt19;}elseif(file_exists($ZZZZZZZZZZZZZZZZZZZu20)){return include $ZZZZZZZZZZZZZZZZZZZu20;}} return false;} static function save($type, $name, $ZU2020){if(isset($ZZZZZZZZZZZZZZZZZZZr17[$type][$name])){$ZZZZZZZZZZZZZZZZZZZs18 = ZZZk10::$ZZZZZZZZZZZZZZZZZZZq16."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZt19 = $ZZZZZZZZZZZZZZZZZZZs18."Custom.php";file_put_contents($ZZZZZZZZZZZZZZZZZZZt19, "<?"."php return " . var_export($ZU2020, true) . ";");return true;} return false;}}
;class ZZZZZZZZZZZZZZZZZZZv21
{public $ZZZZZZZZZZZZZZZZZZZw22 = array();public $ZZZZZZZZZZZZZZZZZZZx23 = false;function __construct() {set_time_limit(0);} function ZZZZZZZZZZZZZZZZZZZy24($url, $r17, $ZZZZZZZZZZZZZZZZZZZz25 = false) {$ZZZZZZZZZZZZZZZZZZZA00 = http_build_query($r17);$ZZZZZZZZZZZZZZZZZZZB11 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_POST, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_POSTFIELDS, $ZZZZZZZZZZZZZZZZZZZA00);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_VERBOSE, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_HEADER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_BINARYTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_RETURNTRANSFER, 1);$ZZZZZZZZZZZZZZZZZZh7 = curl_exec($ZZZZZZZZZZZZZZZZZZZB11);$this->ZZZZZZZZZZZZZZZZZZZw22[] = curl_error($ZZZZZZZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZZZZZZZC22 = curl_getinfo($ZZZZZZZZZZZZZZZZZZZB11, CURLINFO_HEADER_SIZE);curl_close ($ZZZZZZZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZZZZZZZD33 = substr($ZZZZZZZZZZZZZZZZZZh7, 0, $ZZZZZZZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZZZZZZZE44 = substr($ZZZZZZZZZZZZZZZZZZh7, $ZZZZZZZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZZZZZZZF55 = explode("\n", $ZZZZZZZZZZZZZZZZZZZD33);foreach($ZZZZZZZZZZZZZZZZZZZF55 as $ZZZZZZZZZZZZZZZZZZZG66) {$ZZZZZZZZZZZZZZZZZZZH77 = explode(':', $ZZZZZZZZZZZZZZZZZZZG66);if(count($ZZZZZZZZZZZZZZZZZZZH77) == 2) {$ZZZZZZZZZZZZZZZZZZZI88[$ZZZZZZZZZZZZZZZZZZZH77[0]] = trim($ZZZZZZZZZZZZZZZZZZZH77[1]);}} if($ZZZZZZZZZZZZZZZZZZZz25) {return $ZZZZZZZZZZZZZZZZZZZE44;} header('Content-type: ' . $ZZZZZZZZZZZZZZZZZZZI88['Content-Type']);header('Content-Disposition: ' . $ZZZZZZZZZZZZZZZZZZZI88['Content-Disposition']);echo $ZZZZZZZZZZZZZZZZZZZE44;} function retrieve($url, $ZZZZZZZZZZZZZZZZZZZJ99 = true, $ZZZZZZZZZZZZZZZZZZZK1010 = false) {$ZZZZZZZZZZZZZZZZZZZB11 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_RETURNTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_TIMEOUT, 50);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_FAILONERROR, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_FOLLOWLOCATION, true);if($ZZZZZZZZZZZZZZZZZZZK1010) {curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_NOPROGRESS, false);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_PROGRESSFUNCTION, $ZZZZZZZZZZZZZZZZZZZK1010);} $ZZZZZZZZZZZZZZZZZZh7 = curl_exec($ZZZZZZZZZZZZZZZZZZZB11);$this->ZZZZZZZZZZZZZZZZZZZw22[] = curl_error($ZZZZZZZZZZZZZZZZZZZB11);curl_close($ZZZZZZZZZZZZZZZZZZZB11);if($ZZZZZZZZZZZZZZZZZZZJ99) {return json_decode($ZZZZZZZZZZZZZZZZZZh7, true);} return $ZZZZZZZZZZZZZZZZZZh7;}}
;class ZZZi8{private static $ZZZZZZZZZZz25;private static $ZZZZZZZZZZZZZZZZZZZL1111;public static function ZZZj9($ZZZZZZZZZZz25){ZZZi8::$ZZZZZZZZZZz25 = $ZZZZZZZZZZz25;} public static function ZZZZZZZZZZZZZZZZZZZM1212($moduleName, $ZZZZZZZZZZC22, $ZZZZZZZZZZZZZJ99=""){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return $ZZZZZZZZZZZZZJ99;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {if($ZZZZZZZZZZZZZZZZZZZO1414['panelData']['id'] == $ZZZZZZZZZZC22){return $ZZZZZZZZZZZZZZZZZZZO1414['panelData']['label'];}} return $ZZZZZZZZZZZZZJ99;} public static function ZZZl11($moduleName, $ZZZ2525){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return $ZZZ2525;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {$ZZZ2525 = array_merge($ZZZ2525, $ZZZZZZZZZZZZZZZZZZZO1414['panelData']['fields']);} return $ZZZ2525;} public static function ZZZZZZZZZZZZZZZZX2323($moduleName, $ZZZZZZZZZZX2323, ZZp15 $ZZZZZZj9){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return $ZZZZZZZZZZX2323;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {$ZZZu20 = $ZZZZZZZZZZZZZZZZZZZO1414['tableName'];$ZZZZZZZZZZZZZZZZZZZP1515 = $ZZZZZZZZZZZZZZZZZZZO1414['parentModuleIdColumn'];if($ZZZZZZZZZZZZZZZZZZZO1414['view']){$ZZZZn13 = $ZZZZZZZZZZZZZZZZZZZO1414['viewSql'];$ZZZZo14 = $ZZZZZZZZZZZZZZZZZZZO1414['viewParameters'];$ZZZZZZj9->ZZZZm12($ZZZZn13, $ZZZZo14, $ZZZu20);} $ZZZZZZZZZZX2323[] = array('name' => $ZZZu20, 'idCol' => $ZZZZZZZZZZZZZZZZZZZP1515);} return $ZZZZZZZZZZX2323;} public static function ZZZZZZZZZZZZh7($moduleName, $ZZZZZZZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return null;$ZZZZZZZZZZZZf5 = null;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {if($ZZZZZZZZZZZZZZZZZZZO1414['tableName'] != $ZZZZZZZZZZZZZZZZZZZQ1616) continue;$ZZZZZZZZZZZZf5 = isset($ZZZZZZZZZZZZZZZZZZZO1414['mainTableId'])?$ZZZZZZZZZZZZZZZZZZZO1414['mainTableId'] : null;} return $ZZZZZZZZZZZZf5;} private static function ZZZZZZZZZZZZZZZZZZZN1313($moduleName){if(!isset(ZZZi8::$ZZZZZZZZZZz25[$moduleName])){return false;} return ZZZi8::$ZZZZZZZZZZz25[$moduleName];} private static function ZZZZZZZZZZZZZZZZZZZR1717($ZZZu20, $ZZZZZZZZZZZZZZZZZZZS1818, $type, $ZZZZZZZZZZZZZZZZZZZT1919){return array('tableName' => $ZZZu20, 'parentModuleIdColumn' => 'id', 'view' => false, 'viewSql' => "", 'viewParameters' => array(), 'panelData' => array('id' => $ZZZZZZZZZZZZZZZZZZZT1919, 'label' => "Snapshot {$ZZZZZZZZZZZZZZZZZZZS1818['columnName']} by {$type}", 'fields' => array(0 => array('tablename' => $ZZZu20, 'columnname' => 'date', 'fieldname' => "{$ZZZZZZZZZZZZZZZZZZZS1818['columnName']}_{$type}_date", 'fieldlabel' => 'Date', 'uitype' => 'datetime', 'typeofdata' => 'DT~O', 'block' => $ZZZZZZZZZZZZZZZZZZZT1919), 1 => array('tablename' => $ZZZu20, 'columnname' => 'value', 'fieldname' => "{$ZZZZZZZZZZZZZZZZZZZS1818['columnName']}_{$type}_value", 'fieldlabel' => 'Value', 'uitype' => $ZZZZZZZZZZZZZZZZZZZS1818['uitype'], 'typeofdata' => 'DT~O', 'block' => $ZZZZZZZZZZZZZZZZZZZT1919, 'options' => $ZZZZZZZZZZZZZZZZZZZS1818['options']),)));}}
;class ZZZf5 {private $ZZZZZZZZZZZZZZZZZZZU2020 = null;private static $ZZZZZZZZZZZZZZZZZZZV2121 = null;private function __construct() {} function ZZZZZZZZZZZZZZZZZZZW2222() {} static function getInstance() {if(is_null(self::$ZZZZZZZZZZZZZZZZZZZV2121)) {self::$ZZZZZZZZZZZZZZZZZZZV2121 = new self();} return self::$ZZZZZZZZZZZZZZZZZZZV2121;} function ZZZZZZZZZZZZZZZZZZZX2323($ZZZg6){$this->ZZZZZZZZZZZZZZZZZZZU2020 = $ZZZg6;} function ZZZh7() {return $this->ZZZZZZZZZZZZZZZZZZZU2020;}}
;class AnalyticReportingController extends SugarController {function ZZZZZZZZZZZZZZZZZZZY2424() {foreach($_POST as $Zu20 => &$value) {$value = $this->ZZZZZZZZZZZZZZZZZZZZ2525($value);} foreach($_REQUEST as $Zu20 => &$value) {$value = $this->ZZZZZZZZZZZZZZZZZZZZ2525($value);} foreach($_GET as $Zu20 => &$value) {$value = $this->ZZZZZZZZZZZZZZZZZZZZ2525($value);}} function ZZZZZZZZZZZZZZZZZZZZ2525($value) {if(isset($value)) {if(is_array($value)) {} else {$value = stripslashes(html_entity_decode($value));}} return $value;} function action_listview() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db, $ZZZZZe4);$this->view = 'list';$this->ZZZZZZZZZZZZZZZZZZZY2424();$ZZZZh7 = false;if(is_admin($current_user) && isset($_REQUEST["showHidden"]) && !empty($_REQUEST["showHidden"])) {$ZZZZh7 = true;} $ZZZZZZZZZZZZZZZZZn13 = new ZZZZZZZZZZZZZZZZZc2($mod_strings);$ZZZZZZZZZZZZZZZZZZZZa0 = $ZZZZZZZZZZZZZZZZZn13->ZZZZZZZZZZZZZZZZZm12($db, $ZZZZZe4, $current_user, $ZZZZh7);$ZZZZZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZZZZZn13->ZZZZZZZZZZZZZZZZZf5();$this->view_object_map['toggleHidden'] = ($ZZZZh7) ? 'false' : 'true';$this->view_object_map['reportTreeData'] = json_encode($ZZZZZZZZZZZZZZZZZZZZa0);$this->view_object_map['reportTreeDeletable'] = json_encode($ZZZZZZZZZZZZZZZZZZZZb1);$this->view_object_map["REPORTSCHEDULEUSERS"] = json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZC22());$this->view_object_map["REPORTACCESSUSERS"] = json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZA00());$this->view_object_map["REPORTUSERS"] = json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZq16());$this->view_object_map["isAdmin"] = is_admin($current_user)?1:0;} function action_loadReport() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db, $ZZZZZe4);$ZZZZZZZZZZZZZQ1616 = PlatformConnector::ZZZZZZq16();$this->ZZZZZZZZZZZZZZZZZZZY2424();$id = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZI88 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZH77($current_user, $id);if($ZZZZZZZZZZZZZZZZZZI88 == 0){$ZZZZZe4->ZZZZZs18();die();} $ZZZZZZZZZZZZZZZZZZE44 = $db->loadReport($id);if($ZZZZZZZZZZZZZZZZZZI88 == 1){$_POST['columns'] = $ZZZZZZZZZZZZZZZZZZE44["fields"];$_POST['filters'] = $ZZZZZZZZZZZZZZZZZZE44["filters"];$_POST['labels'] = $ZZZZZZZZZZZZZZZZZZE44["labels"];} $ZZZR1717 = array();if(!empty($_POST['labels'])) {$ZZZR1717 = json_decode(html_entity_decode($_POST['labels']), true);} $ZZZZZZZZZZZZZZZZZZZZc2 = false;if(isset($_GET["chart"]) && $_GET["chart"] == 1){$ZZZZZZZZZZZZZZZZZZZZc2 = true;} $ZZZg6 = json_decode(html_entity_decode($_POST["options"]));if(!isset($ZZZg6->aggregateColumn)){$ZZZg6->aggregateColumn = false;} if(!isset($ZZZg6->emptyAsZero)){$ZZZg6->emptyAsZero = false;} $ZZZe4 = ZZZf5::getInstance();$ZZZe4->ZZZZZZZZZZZZZZZZZZZX2323($ZZZg6);if(isset($_GET["combined"]) && $_GET["combined"] == 1) {$module = null;$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZZm12($db, $ZZZZZe4, $ZZZR1717);if(isset($_POST["combinedSelectedFields"])){$ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZZZg6(json_decode(html_entity_decode($_POST["combinedSelectedFields"]),true));}} else {$module = new ZZZZZZZZZZH77($ZZZZZZZZZZZZZZZZZZE44["module"],$db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZI88($db, $ZZZZZe4, $ZZZR1717);} $ZZZZZZZZZZZZZZZZZZG66 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZE44["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZG66[] = new ZZZZZZZZZZE44($ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][11]);} $ZZZg6 = json_decode(html_entity_decode($_POST["options"]));if(!isset($ZZZg6->aggregateColumn)){$ZZZg6->aggregateColumn = false;} $ZZZZZZZZZZZZZZZZZZZZd3 = true;$isCrosstab = $ZZZg6->isCrosstab;$ZZZZZZZZZZZZZZZZZZZZc2 = false;if(isset($_GET["chart"]) && $_GET["chart"] == 1){$ZZZZZZZZZZZZZZZZZZZZd3 = false;$ZZZZZZZZZZZZZZZZZZZZc2 = true;$isCrosstab = false;} if(isset($_GET["distinct"]) && !empty($_GET["distinct"])) {$isCrosstab = false;} if($isCrosstab) {$ZZZZZZZZZZZZZZZZZZZZd3 = false;} $ZZZZZZZZZZZZZk10 = array("pagination" => $ZZZZZZZZZZZZZZZZZZZZd3,);if(isset($_REQUEST['limit'])) {$ZZZZZZZZZZZZZk10["limit"] = $_REQUEST['limit'];} else if (isset($ZZZg6->limit)) {$ZZZZZZZZZZZZZk10["limit"] = $ZZZg6->limit;} else {$ZZv21 = new ZV2121($db);$ZZZZZZZZZZZZZk10["limit"] = $ZZv21->getValue("limit");} if(isset($_REQUEST['currentPage'])) {$ZZZZZZZZZZZZZk10["currentPage"] = (int) $_REQUEST['currentPage'];} $ZZZZZZZZZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZN1313($module, json_decode($_POST['columns']), json_decode($_POST['filters']), $ZZZZZZZZZZZZZZZZZZG66, json_decode($_POST['grouping'],true), json_decode($_POST['aggregates'],true), !$ZZZg6->includeDetails, $isCrosstab, true, $ZZZg6->aggregateColumn, $ZZZZZe4->ZZZZZq16($current_user), $ZZZZZZZZZZZZZZZZZZZZc2, isset($_POST['calcFields']) ? json_decode($_POST['calcFields'], true) : array(), $ZZZZZZZZZZZZZk10, $ZZZZZZZZZZZZZQ1616);if(isset($_GET["distinct"]) && !empty($_GET["distinct"])) {$ZZZZZZZZZZZZZZZZZZZZf5 = $_GET["distinct"];$ZZZZZZZZZZZZZZZZZZZZg6 = array();$ZZZZJ99 = array();foreach($ZZZZZZZZZZZZZZZZZZZZe4["data"] as $ZZZZZZZZZZZZZZZZZZZZh7) {if(isset($ZZZZZZZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZZZZZZZf5]) && !empty($ZZZZZZZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZZZZZZZf5])) {$ZZZZZZZZZZZZZZZZZZZZg6[] = $ZZZZZZZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZZZZZZZf5];}} $ZZZZZZZZZZZZZZZZZZZZg6 = array_unique($ZZZZZZZZZZZZZZZZZZZZg6);foreach($ZZZZZZZZZZZZZZZZZZZZg6 as $Zf5 => $ZZZZZZZZZZZZZZZZZZZZh7) {$ZZZZJ99[] = array("name" => $ZZZZZZZZZZZZZZZZZZZZh7, "title" => $ZZZZZZZZZZZZZZZZZZZZh7,);} $ZZZZZZZZZZZZZZZZZZZZe4 = $ZZZZJ99;} echo json_encode($ZZZZZZZZZZZZZZZZZZZZe4);exit();} function action_report() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$this->view = 'report';$this->ZZZZZZZZZZZZZZZZZZZY2424();$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZH77($current_user,$_REQUEST["record"]);if(!$ZZZZZZZZZZZZZZZZZZZZi8){$ZZZZZe4->ZZZZZs18();die;} $ZZZZZZZZZZZZZZZZZZZZj9 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZA00();$ZZZZZZZZZZZZZZZZZZE44 = $db->loadReport((int)$_REQUEST["record"]);$ZZZe4 = ZZZf5::getInstance();$ZZZe4->ZZZZZZZZZZZZZZZZZZZX2323(json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]));$module = new ZZZZZZZZZZH77($ZZZZZZZZZZZZZZZZZZE44["module"],$db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZG66 = array();$isCombined = false;if(isset($ZZZZZZZZZZZZZZZZZZE44["iscombined"])&&$ZZZZZZZZZZZZZZZZZZE44["iscombined"] == 1){$isCombined = true;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZZZE44["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZG66[] = new ZZZZZZZZZZE44($ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][11]);} $ZZZZZZZZZZZZZZZZZZZZk10 = new ZZZZZZZZZZF55($ZZZZZZZZZZZZZZZZZZE44["module"], $ZZZZZZZZZZZZZZZZZZG66, $db, $ZZZZZe4, $isCombined);$ZZZZZZZZZZZZZZZZZZZU2020 = json_decode($ZZZZZZZZZZZZZZZZZZE44["options"],true);$ZZZZZZZZZZZZZZZZZZZU2020['isCombined'] = $isCombined;$this->view_object_map['REPORTFIELDS'] = json_encode($ZZZZZZZZZZZZZZZZZZZZk10->ZZZZZZZZZZM1212());$this->view_object_map['REPORTCOLUMNS'] = $ZZZZZZZZZZZZZZZZZZE44['fields'];$this->view_object_map['REPORTCALCCOLUMNS'] = (isset($ZZZZZZZZZZZZZZZZZZE44['calcFields']) && !empty($ZZZZZZZZZZZZZZZZZZE44['calcFields']))?($ZZZZZZZZZZZZZZZZZZE44['calcFields']):"[]";$this->view_object_map['REPORTFILTERS'] = $ZZZZZZZZZZZZZZZZZZE44['filters'];$this->view_object_map['REPORTGROUPING'] = $ZZZZZZZZZZZZZZZZZZE44['grouping'];$this->view_object_map['REPORTAGGREGATES'] = $ZZZZZZZZZZZZZZZZZZE44['aggregates'];$this->view_object_map['REPORTTOTALAGGREGATES'] = $ZZZZZZZZZZZZZZZZZZE44['totalAggregates'];$this->view_object_map['REPORTOPTIONS'] = json_encode($ZZZZZZZZZZZZZZZZZZZU2020);$this->view_object_map['REPORTLABELS'] = !empty($ZZZZZZZZZZZZZZZZZZE44['labels']) ? ($ZZZZZZZZZZZZZZZZZZE44['labels']) : json_encode(false);$this->view_object_map['REPORTID'] = (int)$_REQUEST["record"];$this->view_object_map['REPORTTITLE'] = $ZZZZZZZZZZZZZZZZZZE44['title'];$this->view_object_map['REPORTDESCRIPTION'] = $ZZZZZZZZZZZZZZZZZZE44['description'];$ZZZZZZZZZZZZZZZZZZZZl11 = json_decode($ZZZZZZZZZZZZZZZZZZE44["chart"]);$this->view_object_map['CHARTTITLE'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartTitle)?($ZZZZZZZZZZZZZZZZZZZZl11->chartTitle):("")) ;$this->view_object_map['CHARTTYPE'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartType)?($ZZZZZZZZZZZZZZZZZZZZl11->chartType):("")) ;$this->view_object_map['CHARTCUMULATED'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartCumulated)?($ZZZZZZZZZZZZZZZZZZZZl11->chartCumulated):(true)) ;if(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues) && !empty($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues)){$ZZZZZZZZZZZZZZZZZZZZm12 = explode("_", $ZZZZZZZZZZZZZZZZZZZZl11->chartAxisX);array_shift($ZZZZZZZZZZZZZZZZZZZZm12);$moduleName = array_shift($ZZZZZZZZZZZZZZZZZZZZm12);$fieldName = implode("_", $ZZZZZZZZZZZZZZZZZZZZm12);$ZZZZZZZZZZZZZL1111 = $db->ZZN1313($fieldName, $moduleName);foreach($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues as &$ZZZZZZZZZZZZZZZZZZZZn13) {$ZZZZZZZZZZZZZZZZZZZZn13->value = $ZZZZZZZZZZZZZL1111[$ZZZZZZZZZZZZZZZZZZZZn13->key];}} $this->view_object_map['CHARTSORTABLEVALUES'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues)?($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues):(false)) ;$this->view_object_map['CHARTLABELS'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartLabels)?($ZZZZZZZZZZZZZZZZZZZZl11->chartLabels):("")) ;$this->view_object_map['CHARTAXISX'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisX)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisX):("")) ;$this->view_object_map['CHARTAXISY'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY):("")) ;$this->view_object_map['CHARTAXISY2'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY2)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY2):("")) ;$this->view_object_map['CHARTYAXISTYPE'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxisType)?($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxisType):("")) ;$this->view_object_map['CHARTYAXIS2TYPE'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxis2Type)?($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxis2Type):("")) ;$this->view_object_map['CHARTLEGEND'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartLegend)?($ZZZZZZZZZZZZZZZZZZZZl11->chartLegend):("")) ;$this->view_object_map['CHARTSTACKED'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartStacked)?($ZZZZZZZZZZZZZZZZZZZZl11->chartStacked):(false)) ;$this->view_object_map['CHARTBARS1STACKED'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartBars1Stacked)?($ZZZZZZZZZZZZZZZZZZZZl11->chartBars1Stacked):(false)) ;$this->view_object_map['CHARTBARS2STACKED'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartBars2Stacked)?($ZZZZZZZZZZZZZZZZZZZZl11->chartBars2Stacked):(false)) ;$this->view_object_map['CHARTSIZE'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartSize)?($ZZZZZZZZZZZZZZZZZZZZl11->chartSize):(50)) ;$this->view_object_map['CHARTHEIGHT'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartHeight)?($ZZZZZZZZZZZZZZZZZZZZl11->chartHeight):(0)) ;$this->view_object_map['CHARTSHOWPERCENTS'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartShowPercents)?($ZZZZZZZZZZZZZZZZZZZZl11->chartShowPercents):(false)) ;$this->view_object_map['CHARTSHOWLABELS'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartShowLabels)?($ZZZZZZZZZZZZZZZZZZZZl11->chartShowLabels):(false));$this->view_object_map['CHARTSHOWZONELABELS'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartShowZoneLabels)?($ZZZZZZZZZZZZZZZZZZZZl11->chartShowZoneLabels):(false));$this->view_object_map['CHARTVALUEZONES'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartValueZones)?($ZZZZZZZZZZZZZZZZZZZZl11->chartValueZones):(false)) ;$this->view_object_map['CHARTAXISXSEGMENT'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisXSegment)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisXSegment):(false)) ;$this->view_object_map['REPORTACCESSUSERS'] =json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZA00()) ;$this->view_object_map['REPORTACCESSUSERSSELECTED'] =json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZB11((int)$_REQUEST["record"])) ;$this->view_object_map['REPORTSCHEDULEUSERS'] =json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZC22());$this->view_object_map['REPORTSCHEDULEUSERSSELECTED'] =json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZE44((int)$_REQUEST["record"])) ;$this->view_object_map['REPORTSCHEDULESETTINGS'] =json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZF55((int)$_REQUEST["record"])) ;$this->view_object_map['REPORTSHARING'] =json_encode(($ZZZZZZZZZZZZZZZZZZE44['shared']==1)?("PUB"):("PRIV")) ;if($ZZZZZZZZZZZZZZZZZZE44['sharedlevel']==2){$ZZZZZZZZZZZZZZZZZZZZo14 = "DELETE";}elseif($ZZZZZZZZZZZZZZZZZZE44['sharedlevel']==1){$ZZZZZZZZZZZZZZZZZZZZo14 = "EDIT";}else{$ZZZZZZZZZZZZZZZZZZZZo14 = "VIEW";} $this->view_object_map['REPORTSHARINGLEVEL'] = json_encode($ZZZZZZZZZZZZZZZZZZZZo14) ;$this->view_object_map['REPORTOWNER'] = json_encode($ZZZZZZZZZZZZZZZZZZE44['owner']) ;$this->view_object_map['REPORTUSERS'] = json_encode($ZZZZZZZZZZZZZZZZZZH77->ZZZZq16());$this->view_object_map['CANEDIT'] = 1;$this->view_object_map['CANDELETE'] = ($ZZZZZZZZZZZZZZZZZZZZi8<3)?0:1;$this->view_object_map['NUMBERSETTINGS'] = json_encode($ZZZZZe4->ZZZZZj9($current_user));$this->view_object_map['significantDigits'] = json_encode(PlatformConnector::ZZZZZZL1111()) ;$ZY2424 = $db->ZZZC22("SELECT `id`, `title` FROM `advancedreports_categories` ");$num_rows=count($ZY2424);$ZZZZZZZZZZZZZZZZZZZZp15 = array();for($Zf5=0;$Zf5<$num_rows;$Zf5++){$ZZZZZZZZZZZZZZZZZZZZq16 = $ZY2424[$Zf5]['id'];$ZZZZZZZZZZZZZZZZZZZZr17 = $ZY2424[$Zf5]['title'];$ZZZZZZZZZZZZZZZZZZZZp15[$ZZZZZZZZZZZZZZZZZZZZq16] = $ZZZZZZZZZZZZZZZZZZZZr17;} $this->view_object_map['report_folders'] = $ZZZZZZZZZZZZZZZZZZZZp15;$this->view_object_map['current_report_folder'] = $ZZZZZZZZZZZZZZZZZZE44['category_id'];$ZZZZZZZZZZZZZZZZZZE44['isCombined'] = false;$this->view_object_map['REPORTCOMBINED'] = $isCombined;$ZZZZZZZZZZZZZZZZZZZZs18 = array();if($isCombined){$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZZm12($db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZZZt19 = $ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZZZc2($ZZZZZZZZZZZZZZZZZZG66);$ZZZZZZZZZZZZZZZZZZZZs18 = $ZZZZZZZZZZZZZZZZZZZZk10->ZZZZZZZZZZN1313($ZZZZZZZZZZZZZZZZZZZZt19["skip"],$ZZZZZZZZZZZZZZZZZZZZt19["common"]);$this->view_object_map['REPORTCOMBINEDMODULES'] = json_encode($ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZZZb1($ZZZZZZZZZZZZZZZZZZG66));$this->view_object_map['REPORTCOMBINEDFIELDS'] = $ZZZZZZZZZZZZZZZZZZE44["combinedfields"];$this->view_object_map['REPORTCOMMONMODULES'] = json_encode($ZZZZZZZZZZZZZZZZZZZZt19["commonIds"]);$this->view_object_map['SHOW_DETAILS'] = false;if(empty($ZZZZZZZZZZZZZZZZZZZZt19["common"])){$this->view_object_map['SHOW_TABLE'] = false;}else{$this->view_object_map['SHOW_TABLE'] = true;}}else{$this->view_object_map['SHOW_DETAILS'] = true;$this->view_object_map['SHOW_TABLE'] = true;} $this->view_object_map['REPORTSELECTABLEFIELDS'] = json_encode($ZZZZZZZZZZZZZZZZZZZZs18);} function action_massSchedule() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db, $ZZZZZe4);$this->ZZZZZZZZZZZZZZZZZZZY2424();$r17 = $_POST;function ZZZZZZZZZZZZZZZZZZZZu20($ZZZK1010, $r17, $db, $ZZZZZZZZZZZZZZZZZZH77) {$ZZZL1111 = $r17['globalSharing'];$ZZZM1212 = $r17['globalSharingRights'];$ZZZZZZZZZZZZZZZZZZZZv21 = json_decode($r17['userSharing'], true);$ZZZN1313 = (int) $r17['owner'];if($_REQUEST["updatePermissions"] == 1){$db->ZZZJ99($ZZZK1010, $ZZZL1111, $ZZZM1212, $ZZZN1313);$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZI88($ZZZK1010, $ZZZZZZZZZZZZZZZZZZZZv21);} if($_REQUEST["isScheduled"] == 1){ZZZZZZZZZZZZZZZZZZZZw22($r17, $ZZZZZZZZZZZZZZZZZZH77, $ZZZK1010, $ZZZN1313);}} function ZZZZZZZZZZZZZZZZZZZZw22($r17, $ZZZZZZZZZZZZZZZZZZH77, $id, $ZZZN1313){$ZZZZZZZZZZZZZZZZZZZZx23 = $r17["isScheduled"];if($ZZZZZZZZZZZZZZZZZZZZx23 == "1"){$ZZZZZZZZZZZZZZZZZZZZy24 = (isset($r17["scheduledRecipients"]))?($r17["scheduledRecipients"]):(array());$ZZZZZZZZZZZZZZZZZZb1 = (isset($r17["intervalOptions"]))?($r17["intervalOptions"]):(array());$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZY2424($id,$r17["interval"],$r17["intervalH"],$r17["intervalM"],$ZZZZZZZZZZZZZZZZZZb1,$ZZZN1313,$r17["scheduledFormats"]);$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZK1010($id,$ZZZZZZZZZZZZZZZZZZZZy24);}else{$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZL1111($id);}} if(isset($r17['reportIds']) && ($r17['reportIds']) > 0) {foreach($r17['reportIds'] as $ZZZK1010) {ZZZZZZZZZZZZZZZZZZZZu20($ZZZK1010, $r17, $db, $ZZZZZZZZZZZZZZZZZZH77);}} echo json_encode(array("status" => "ok"));exit;} function action_loadPicklists() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db, $ZZZZZe4);$this->ZZZZZZZZZZZZZZZZZZZY2424();$ZZZZZZZZZZZZZZZZZZh7 = array();$fieldName = $_REQUEST["fieldName"];list($Zf5, $moduleName, $fieldName) = $db->ZZZm12($fieldName);$ZZO1414 = $db->ZZN1313($fieldName, $moduleName);if($ZZO1414) {foreach($ZZO1414 as $ZZZZZZZZZZZZZZZZZZZZz25 => $ZZZZZZZZZZZZZZZZZZZZA00) {$ZZZZZZZZZZZZZZZZZZh7[] = array("key" => $ZZZZZZZZZZZZZZZZZZZZz25, "value" => $ZZZZZZZZZZZZZZZZZZZZA00);}} echo json_encode($ZZZZZZZZZZZZZZZZZZh7);exit;} function action_saveCategory() {$adb = DBManagerFactory::getInstance();$db	= new ZZp15($adb);$ZZZZZZZZZZZZZZZZZZZZB11 = $_REQUEST["_action"];$id = $_REQUEST["id"];$ZZZZZZZZZZZZZZZZZZZZC22 = $_REQUEST["parentId"];$ZZZZZZZZZZZZZZZZZZZZD33 = $_REQUEST["position"];$ZZZZZZZZZZZZZZZZZZZZE44	= $_REQUEST["oldParentId"];$ZZZZZZZZZZZZZZZZZZZZF55	= $_REQUEST["oldPosition"];if(in_array($ZZZZZZZZZZZZZZZZZZZZB11, array('add', 'edit'))) {$title = $_REQUEST["title"];$description = $_REQUEST["description"];} switch($ZZZZZZZZZZZZZZZZZZZZB11) {case "add": $ZY2424 = $db->ZZH77("SELECT MAX(`sequence`) AS `sequence` FROM `advancedreports_categories` WHERE `parent_id` = ? ", array($id));$ZZZZ2525 = $db->ZZI88($ZY2424, 'sequence');if(!$ZZZZ2525) {$ZZZZ2525 = 0;} if($ZZZZ2525 != 0) {++$ZZZZ2525;} $ZZq16 = "INSERT `advancedreports_categories` (`parent_id`, `sequence`, `title`, `description`) VALUES (?, ?, ?, ?)";$db->ZZH77($ZZq16, array($id, $ZZZZ2525, $title, $description));break;case "edit": $ZZq16 = "UPDATE `advancedreports_categories` SET `title` = ?, `description` = ? WHERE `id` = ?";$db->ZZH77($ZZq16, array($title, $description, $id));break;case "delete": $ZY2424 = $db->ZZH77("SELECT `sequence`, `parent_id` FROM `advancedreports_categories` WHERE `id` = ? LIMIT 1", array($id));$ZZZZZZZZZZZZZZZZZZZZE44 = $db->ZZI88($ZY2424, 'parent_id');$ZZZZZZZZZZZZZZZZZZZZF55 = $db->ZZI88($ZY2424, 'sequence');$db->ZZH77("DELETE FROM `advancedreports_categories` WHERE `id` = ? LIMIT 1", array($id));$db->ZZH77("UPDATE `advancedreports_categories` SET `sequence` = `sequence` - 1 WHERE `parent_id` = ? AND `sequence` > ? ", array($ZZZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZZZF55));break;case "moveCategory": $db->ZZH77("UPDATE `advancedreports_categories` SET `sequence` = `sequence` + 1 WHERE `parent_id` = ? AND `sequence` >= ? ", array($ZZZZZZZZZZZZZZZZZZZZC22, $ZZZZZZZZZZZZZZZZZZZZD33));$db->ZZH77("UPDATE `advancedreports_categories` SET `parent_id` = ?, `sequence` = ? WHERE `id` = ? ", array($ZZZZZZZZZZZZZZZZZZZZC22, $ZZZZZZZZZZZZZZZZZZZZD33, $id));$db->ZZH77("UPDATE `advancedreports_categories` SET `sequence` = `sequence` - 1 WHERE `parent_id` = ? AND `sequence` > ? ", array($ZZZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZZZF55));break;case "moveItem": $db->ZZH77("UPDATE `advancedreports` SET `sequence` = `sequence` + 1 WHERE `category_id` = ? AND `sequence` >= ? ", array($ZZZZZZZZZZZZZZZZZZZZC22, $ZZZZZZZZZZZZZZZZZZZZD33));$db->ZZH77("UPDATE `advancedreports` SET `category_id` = ?, `sequence` = ? WHERE `id` = ? ", array($ZZZZZZZZZZZZZZZZZZZZC22, $ZZZZZZZZZZZZZZZZZZZZD33, $id));$db->ZZH77("UPDATE `advancedreports` SET `sequence` = `sequence` - 1 WHERE `category_id` = ? AND `sequence` > ? ", array($ZZZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZZZF55));break;} echo json_encode(array("status" => "ok"));die;} function action_reportBuilder(){global $mod_strings, $app_strings, $current_user;$this->view = 'reportbuilder';if(!PlatformConnector::ZZZZZg6($current_user)){die();} $adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();if($_REQUEST['file'] == 'reportBuilder'){$ZZZZZZZZZZZZZZZZZZh7 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZg6($_REQUEST);if($ZZZZZZZZZZZZZZZZZZh7['statusCode']!=1){echo json_encode($ZZZZZZZZZZZZZZZZZZh7);die();} $ZZZZZZZZZZT1919 = $ZZZZZe4->ZZZZZh7($current_user);$ZZZZZZZZZZZZZZZZZZm12 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZi8($_REQUEST, $ZZZZZZZZZZT1919);$ZZZZZZZZZZZZZZZZZZh7['insertedReportId'] = $db->ZZZZU2020($ZZZZZZZZZZZZZZZZZZm12);$ZZZZZZZZZZZZZZZZZZh7['statusMessage'] = $mod_strings['label_saved'];echo json_encode($ZZZZZZZZZZZZZZZZZZh7);die();} $ZZZZZZZZZZu20 = PlatformConnector::ZZZZZZl11();asort($ZZZZZZZZZZu20);$ZZZZZZZZZZZZZZZZZZZZG66 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZn13($ZZZZZZZZZZu20);$this->view_object_map['MOD'] = $mod_strings;$this->view_object_map['APP'] = $app_strings;$this->view_object_map['modules'] = json_encode($ZZZZZZZZZZZZZZZZZZZZG66);$ZZZZZZB11 = $db->ZZZZY2424();$ZZZZZZZZZZZZZZZZZZZZH77 = PlatformConnector::ZZZZZZz25($ZZZZZZB11);$ZZZZZZZZZZZZZZZZZZZZH77 = array_merge_recursive($ZZZZZZZZZZZZZZZZZZZZH77, ZZZk10::load('reportBuilder', 'manyToMany'));$this->view_object_map['manyToManyConfig'] = json_encode($ZZZZZZZZZZZZZZZZZZZZH77);$ZZZZZZZZZZZZZZZZZZZZI88 = ZZZk10::load('common', 'common');$this->view_object_map['commonConfig'] = $ZZZZZZZZZZZZZZZZZZZZI88;if($_REQUEST['parenttab'] == "settings"){}else{$ZZZZZZZZZZZZZZZZZZs18 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZp15($ZZZZZZZZZZu20, $db);$ZZZZZZZZZZZZZZZZZZs18 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZr17($ZZZZZZZZZZZZZZZZZZs18);$ZZZZT1919 = $db->ZZZZQ1616('id, title', 'visible=1', 'title ASC');$ZZZZT1919 = ZZZZZZZZZZZZZZZZZZf5::ZZZZZZZZZZZZZZZZZZB11($ZZZZT1919);$this->view_object_map['modulesFields'] = json_encode($ZZZZZZZZZZZZZZZZZZs18);$this->view_object_map['categories'] = json_encode($ZZZZT1919);$ZZZZZZZZZZZZZZZZZZZZJ99 = ZZZk10::load('reportBuilder', 'common');$this->view_object_map['reportTypes'] = json_encode($ZZZZZZZZZZZZZZZZZZZZJ99['reportTypes']);$this->view_object_map['relationTypes'] = json_encode($ZZZZZZZZZZZZZZZZZZZZJ99['relationTypes']);$this->view_object_map['internal'] = json_encode($ZZZZZZZZZZZZZZZZZZZZJ99['internal']);}} function action_Toggle() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);if(is_admin($current_user)){if(isset($_REQUEST["record"]) && isset($_REQUEST["key"]) && isset($_REQUEST["value"])) {$ZZZZZa0 = $_REQUEST["record"];$Zu20 = $_REQUEST["key"];$value = $_REQUEST["value"];$db->ZZZZZ2525($ZZZZZa0, $Zu20, $value);}} header("Location: " . $_SERVER["HTTP_REFERER"]);exit;} function action_settings() {global $mod_strings, $app_strings;$this->view = 'settings';$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$this->view_object_map['response'] = "";if(isset($_POST["key"]) && !empty($_POST["key"])) {$ZZv21->ZZs18("key", $_POST["key"]);$this->view_object_map['response'] = "Settings saved!";} $this->view_object_map['MOD'] = $mod_strings;$this->view_object_map['APP'] = $app_strings;$this->view_object_map['DICTIONARY'] = json_encode($mod_strings);$ZZZZZZZZZZZZZZZZZZZZI88 = ZZZk10::load('common', 'common');$this->view_object_map['commonConfig'] = $ZZZZZZZZZZZZZZZZZZZZI88;} function action_Delete() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZH77($current_user,(int)$_REQUEST["record"]);if($ZZZZZZZZZZZZZZZZZZZZi8>1){$db->deleteReport((int)$_REQUEST["record"]);} header("Location:index.php?module=AnalyticReporting");exit;} function action_saveReport() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$module = "AnalyticReporting";$this->ZZZZZZZZZZZZZZZZZZZY2424();$ZZZc2 = html_entity_decode($_POST['columns']);$filters = html_entity_decode($_POST['filters']);$ZZZO1414 = html_entity_decode($_POST['grouping']);$ZZZP1515 = html_entity_decode($_POST['aggregates']);$ZZZQ1616 = html_entity_decode($_POST['totalAggregates']);$ZZZg6 = html_entity_decode($_POST['options']);$ZZZR1717 = html_entity_decode($_POST['labels']);$ZZZS1818 = html_entity_decode($_POST['chartSettings']);$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db, $ZZZZZe4);$ZZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZH77($current_user,(int)$_REQUEST["record"]);if($ZZZZZZZZZZZZZZZZZZZZi8<2){$ZZZZZe4->ZZZZZs18();die;} function ZZZZZZZZZZZZZZZZZZZZw22($ZZZZZZZZZZZZZZZZZZH77,$id,$ZZZN1313){global $_POST;$ZZZZZZZZZZZZZZZZZZZZx23 = $_POST["isScheduled"];if($ZZZZZZZZZZZZZZZZZZZZx23 == "1"){$ZZZZZZZZZZZZZZZZZZZZy24 = (isset($_POST["scheduledRecipients"]))?($_POST["scheduledRecipients"]):(array());$ZZZZZZZZZZZZZZZZZZb1 = (isset($_POST["intervalOptions"]))?($_POST["intervalOptions"]):(array());$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZY2424($id,$_POST["interval"],$_POST["intervalH"],$_POST["intervalM"],$ZZZZZZZZZZZZZZZZZZb1,$ZZZN1313,$_POST["scheduledFormats"]);$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZK1010($id,$ZZZZZZZZZZZZZZZZZZZZy24);}else{$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZL1111($id);}} if(isset($_REQUEST["saveAs"])&&$_REQUEST["saveAs"]==1){$title = $_POST['title'];$description = $_POST['description'];$ZZZL1111 = $_POST['globalSharing'];$ZZZM1212 = $_POST['globalSharingRights'];$ZZZZZZZZZZZZZZZZZZZZv21 = json_decode($_POST['userSharing'],true);$ZZZN1313 = $_POST['owner'];$ZZZZZZZZZZZZZZZZZZZZK1010 = $db->loadReport((int)$_REQUEST["record"]);$ZZZT1919 = (isset($_POST['calcFields']))?$_POST['calcFields']:"[]";$ZZZY2424 = null;$isCombined = 0;if(isset($_REQUEST["combined"])&&$_REQUEST["combined"]==1){$ZZZY2424 = $_POST["combinedSelectedFields"];$isCombined = 1;} $id = $db->ZZZV2121($ZZZZZZZZZZZZZZZZZZZZK1010["module"], $_POST["reportFolder"], json_encode($ZZZZZZZZZZZZZZZZZZZZK1010["related_data"]),$ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $ZZZg6, $ZZZR1717, $title, $description, $ZZZS1818,$ZZZL1111,$ZZZM1212,$ZZZN1313,$ZZZT1919,$isCombined,$ZZZY2424);$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZI88($id,$ZZZZZZZZZZZZZZZZZZZZv21);ZZZZZZZZZZZZZZZZZZZZw22($ZZZZZZZZZZZZZZZZZZH77,$id,$ZZZN1313);echo json_encode(array("id" => $id, "msg" => "".$ZZZZZe4->ZZZZZw22('label_new_report_saved', $module)));exit;}elseif(isset($_REQUEST["changeTitle"])&&$_REQUEST["changeTitle"]==1){$id = $_REQUEST["record"];$db->ZZZZk10($id,$_REQUEST["title"],$_REQUEST["description"]);}else{$ZZZL1111 = $_POST['globalSharing'];$ZZZM1212 = $_POST['globalSharingRights'];$ZZZZZZZZZZZZZZZZZZZZv21 = json_decode($_POST['userSharing'],true);$ZZZN1313 = $_POST['owner'];$id = (int) $_REQUEST["record"];$ZZZY2424 = null;$ZZZT1919 = (isset($_POST['calcFields']))?$_POST['calcFields']:"[]";if(isset($_REQUEST["combined"])&&$_REQUEST["combined"]==1){$ZZZY2424 = $_POST["combinedSelectedFields"];} $db->saveReport($id, $ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $ZZZg6, $ZZZR1717, $ZZZS1818,$ZZZL1111,$ZZZM1212,$ZZZN1313,$ZZZT1919,$ZZZY2424);$ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZI88($id,$ZZZZZZZZZZZZZZZZZZZZv21);ZZZZZZZZZZZZZZZZZZZZw22($ZZZZZZZZZZZZZZZZZZH77,$id,$ZZZN1313);echo $ZZZZZe4->ZZZZZw22('label_saved', $module);} exit;} function action_makePDF() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$this->ZZZZZZZZZZZZZZZZZZZY2424();$_REQUEST['file'] = 'makePDF';$r17 = retrieveData($adb);$ZZZZZZZZZZZZZZZZZZD33 = false;$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZZ2525 = $ZZZZZe4->ZZZZZj9($current_user);$ZZZZZZZZZZZZZZZZZZZa0 = $ZZZZZZZZZZZZZZZZZZZ2525['decimal'];$ZZZZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZZZZZZZ2525['seperator'];$ZZZg6 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]):json_decode($_POST["options"]);if(empty($ZZZZZZZZZZZZZZZZZZE44["labels"])) {$ZZZZZZZZZZZZZZZZZZE44["labels"] = "[]";} $ZZZR1717 = ($ZZZZZZZZZZZZZZZZZZD33)? json_decode($ZZZZZZZZZZZZZZZZZZE44["labels"], true):json_decode($_POST["labels"], true);$ZZZQ1616 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["totalAggregates"]):json_decode($_POST["totalAggregates"]);$ZZZZZZZZZZZZZZZZZZZZL1111 = array();foreach ($ZZZQ1616 as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZM1212 => $ZZZZZZZZZZZZZZZZZZZZN1313) {if($ZZZZZZZZZZZZZZZZZZZZN1313) $ZZZZZZZZZZZZZZZZZZZZL1111[] = $Zu20.($ZZZZZZZZZZZZZZZZZZZZM1212=='count'?'_cnt':'_sum');}} $ZZZZZZZZZZZZZZZZZZZZO1414 = "Grand Total";if(isset($ZZZR1717["grandTotal"])) {$ZZZZZZZZZZZZZZZZZZZZO1414 = $ZZZR1717["grandTotal"];} $ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();if(count($ZZZZZZZZZZZZZZZZZZZZL1111) > 0 && !$ZZZg6->aggregateColumn){$ZZZZZZZZZZZZZZZZZZZZP1515 = array();foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZZZR1717) {if(!isset($ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616]) && (in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616), $ZZZZZZZZZZZZZZZZZZZZL1111) || in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616)."_sum", $ZZZZZZZZZZZZZZZZZZZZL1111) || in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616)."_cnt", $ZZZZZZZZZZZZZZZZZZZZL1111))){$ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616] = 0;} if(substr($ZZZZZZZZZZZZZZZZZZZZR1717, 0, 10) != "<SubTotal>" && (preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZR1717) || is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717)) && substr($ZZZZZZZZZZZZZZZZZZZZQ1616, -4) != "_avg" && (in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616), $ZZZZZZZZZZZZZZZZZZZZL1111) || in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616)."_sum", $ZZZZZZZZZZZZZZZZZZZZL1111))){$ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616] = number_format($ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616]+$ZZZZZZZZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZF55,".","");}elseif(substr($ZZZZZZZZZZZZZZZZZZZZR1717, 0, 10) != "<SubTotal>" && in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616)."_cnt", $ZZZZZZZZZZZZZZZZZZZZL1111) && !preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZR1717) && !is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717)) {$ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616]++;}}} $ZZZZZZZZZZZZZZZZZZZZP1515[key($r17["cols"])] = $ZZZZZZZZZZZZZZZZZZZZO1414;$r17['data'][] = $ZZZZZZZZZZZZZZZZZZZZP1515;}elseif($ZZZg6->aggregateColumn) {$ZZZZZZZZZZZZZZZZZZZZP1515 = array();foreach ($r17['data'] as $Zu20 => $value) {$r17['data'][$Zu20]["grand_total"] = 0;foreach ($value as $ZZZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZZZR1717) {if(preg_match('/[v]\d+[_]/', $ZZZZZZZZZZZZZZZZZZZZQ1616)) $r17['data'][$Zu20]["grand_total"] += $ZZZZZZZZZZZZZZZZZZZZR1717;}} $r17["cols"]["grand_total"] = $ZZZZZZZZZZZZZZZZZZZZO1414;} foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZZZR1717) {if($r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZQ1616]=='txt'){continue;} if(is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717) && substr($ZZZZZZZZZZZZZZZZZZZZQ1616, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZZZQ1616."_cnt", $ZZZZZZZZZZZZZZZZZZZZL1111) && (!array_key_exists($ZZZZZZZZZZZZZZZZZZZZQ1616, $r17['pdffields']) || $r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZQ1616]!='integer') && (!array_key_exists('aggregates', $value) || !array_key_exists($value['aggregates'], $r17['pdffields']) || $r17['pdffields'][$value['aggregates']]!='integer')){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZQ1616] = number_format($ZZZZZZZZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZF55,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);}elseif(is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717)){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZQ1616] = number_format($ZZZZZZZZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZF55,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);}}} $ZZZZZZZZZZZn13 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZZk10 = count($ZZZZZZZZZZZn13);$ZZZZZZZZZZZZZZZZZZZl11 = ZZZZZZZZZZZZZZZZZZZj9($r17);$ZZZZZZZZZZZZZZZZZZZn13 = $ZZZZZZZZZZZZZZZZZZZk10 * 70;list($ZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZZZp15) = ZZZZZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZZZZZn13);ini_set("memory_limit","256M");require_once('modules/AnalyticReporting/lib/tcpdf/tcpdf.php');$pdf = new TCPDF($ZZZZZZZZZZZZZZZZZZZo14, "mm", $ZZZZZZZZZZZZZZZZZZZp15, true, 'UTF-8', false);$pdf->SetCreator("IT Sapiens");$pdf->SetAuthor('IT Sapiens');$pdf->SetTitle($r17["title"]);$pdf->SetSubject($r17["title"]);$pdf->SetKeywords('Report');$pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);$pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);$pdf->SetAutoPageBreak(true, PDF_MARGIN_BOTTOM);$pdf->setFontSubsetting(true);$ZZZZZZZZZZZZZZZZZZZZS1818 = $ZZv21->getValue('pdfFontFamily');if(!$ZZZZZZZZZZZZZZZZZZZZS1818) {die("No PDF font files found, please download.");} $pdf->SetFont($ZZZZZZZZZZZZZZZZZZZZS1818, '', 9, '', true);unset($r17);$pdf->AddPage();$pdf->writeHTMLCell(0, 0, '', '', $ZZZZZZZZZZZZZZZZZZZl11, 0, 1, 0, true, '', true);$pdf->Output('Report.pdf', 'D');exit;} function action_makeXLS() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$this->ZZZZZZZZZZZZZZZZZZZY2424();$r17 = retrieveData($adb);$ZZZZZZZZZZZZZZZZZZZh7 = ZZZZZZZZZZZZZZZZZZZg6($r17);header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');header('Content-Disposition: attachment;filename="Report.xlsx"');header('Cache-Control: max-age=1');header ('Expires: Mon, 26 Jul 1997 05:00:00 GMT');header ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT');header ('Cache-Control: cache, must-revalidate');header ('Pragma: public');$ZZZZZZZZZZZZZZZZZZZZT1919 = PHPExcel_IOFactory::createWriter($ZZZZZZZZZZZZZZZZZZZh7, 'Excel2007');$ZZZZZZZZZZZZZZZZZZZZT1919->save('php://output');exit;} function action_widget() {$ZZZZZZZZZZZZZZZZZZZZU2020 = new Sugar_Smarty();global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$ZZZZZZZZZZZZZQ1616 = PlatformConnector::ZZZZZZq16();$ZZZZZZZZZZZZZZZZZZZZU2020->assign('MOD', $mod_strings);$ZZZZZZZZZZZZZZZZZZZZU2020->assign('APP', $app_strings);$ZZZZZZZZZZZZZZZZZZZZV2121 = 'false';if(isset($_REQUEST["fullScreen"]) && !empty($_REQUEST["fullScreen"])) {$ZZZZZZZZZZZZZZZZZZZZV2121 = 'true';} $ZZZZZZZZZZZZZZZZZZZZU2020->assign('fullScreen', $ZZZZZZZZZZZZZZZZZZZZV2121);$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZZZW2222 = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZH77($current_user, $ZZZZZZZZZZZZZZZZZZZZW2222);if(!$ZZZZZZZZZZZZZZZZZZZZi8){$ZZZZZe4->ZZZZZs18();die;} $ZZZZZZZZZZZZZZZZZZE44 = $db->loadReport($ZZZZZZZZZZZZZZZZZZZZW2222);$ZZZe4 = ZZZf5::getInstance();$ZZZe4->ZZZZZZZZZZZZZZZZZZZX2323(json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]));$module = new ZZZZZZZZZZH77($ZZZZZZZZZZZZZZZZZZE44["module"],$db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZG66 = array();$isCombined = false;if(isset($ZZZZZZZZZZZZZZZZZZE44["iscombined"])&&$ZZZZZZZZZZZZZZZZZZE44["iscombined"] == 1){$isCombined = true;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZZZE44["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZG66[] = new ZZZZZZZZZZE44($ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][11]);} $ZZZZZZZZZZZZZZZZZZZZk10 = new ZZZZZZZZZZF55($ZZZZZZZZZZZZZZZZZZE44["module"], $ZZZZZZZZZZZZZZZZZZG66, $db, $ZZZZZe4, $isCombined);$ZZZZZZZZZZZZZZZZZZZU2020 = json_decode($ZZZZZZZZZZZZZZZZZZE44["options"],true);$ZZZZZZZZZZZZZZZZZZZU2020['isCombined'] = $isCombined;$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTFIELDS", json_encode($ZZZZZZZZZZZZZZZZZZZZk10->ZZZZZZZZZZM1212()));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTCOLUMNS",$ZZZZZZZZZZZZZZZZZZE44['fields']);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTFILTERS",$ZZZZZZZZZZZZZZZZZZE44['filters']);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTGROUPING",$ZZZZZZZZZZZZZZZZZZE44['grouping']);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTAGGREGATES",$ZZZZZZZZZZZZZZZZZZE44['aggregates']);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTTOTALAGGREGATES",$ZZZZZZZZZZZZZZZZZZE44['totalAggregates']);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTOPTIONS",json_encode($ZZZZZZZZZZZZZZZZZZZU2020));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTLABELS", !empty($ZZZZZZZZZZZZZZZZZZE44['labels']) ? ($ZZZZZZZZZZZZZZZZZZE44['labels']) : json_encode(false));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTID",(int)$_REQUEST["record"]);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTTITLE", $ZZZZZZZZZZZZZZZZZZE44['title']);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTDESCRIPTION", $ZZZZZZZZZZZZZZZZZZE44['description']);$ZZZZZZZZZZZZZZZZZZZZl11 = json_decode($ZZZZZZZZZZZZZZZZZZE44["chart"]);$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTTITLE", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartTitle)?($ZZZZZZZZZZZZZZZZZZZZl11->chartTitle):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTTYPE", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartType)?($ZZZZZZZZZZZZZZZZZZZZl11->chartType):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTCUMULATED", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartCumulated)?($ZZZZZZZZZZZZZZZZZZZZl11->chartCumulated):(true)));if(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues) && !empty($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues)){$ZZZZZZZZZZZZZZZZZZZZm12 = explode("_", $ZZZZZZZZZZZZZZZZZZZZl11->chartAxisX);array_shift($ZZZZZZZZZZZZZZZZZZZZm12);$moduleName = array_shift($ZZZZZZZZZZZZZZZZZZZZm12);$fieldName = implode("_", $ZZZZZZZZZZZZZZZZZZZZm12);$ZZZZZZZZZZZZZL1111 = $db->ZZN1313($fieldName, $moduleName);foreach($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues as &$ZZZZZZZZZZZZZZZZZZZZn13) {$ZZZZZZZZZZZZZZZZZZZZn13->value = $ZZZZZZZZZZZZZL1111[$ZZZZZZZZZZZZZZZZZZZZn13->key];}} $ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTSORTABLEVALUES", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues)?($ZZZZZZZZZZZZZZZZZZZZl11->chartSortableValues):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTLABELS",json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartLabels)?($ZZZZZZZZZZZZZZZZZZZZl11->chartLabels):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTAXISX", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisX)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisX):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTAXISY", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTAXISY2",json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY2)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisY2):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTYAXISTYPE", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxisType)?($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxisType):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTYAXIS2TYPE",json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxis2Type)?($ZZZZZZZZZZZZZZZZZZZZl11->chartYAxis2Type):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTLEGEND",json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartLegend)?($ZZZZZZZZZZZZZZZZZZZZl11->chartLegend):("")));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTSTACKED",json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartStacked)?($ZZZZZZZZZZZZZZZZZZZZl11->chartStacked):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTBARS1STACKED",json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartBars1Stacked)?($ZZZZZZZZZZZZZZZZZZZZl11->chartBars1Stacked):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTBARS2STACKED",json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartBars2Stacked)?($ZZZZZZZZZZZZZZZZZZZZl11->chartBars2Stacked):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTSHOWPERCENTS", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartShowPercents)?($ZZZZZZZZZZZZZZZZZZZZl11->chartShowPercents):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTSHOWLABELS", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartShowLabels)?($ZZZZZZZZZZZZZZZZZZZZl11->chartShowLabels):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTSHOWZONELABELS", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartShowZoneLabels)?($ZZZZZZZZZZZZZZZZZZZZl11->chartShowZoneLabels):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTVALUEZONES", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartValueZones)?($ZZZZZZZZZZZZZZZZZZZZl11->chartValueZones):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTAXISXSEGMENT", json_encode(isset($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisXSegment)?($ZZZZZZZZZZZZZZZZZZZZl11->chartAxisXSegment):(false)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("NUMBERSETTINGS",json_encode($ZZZZZe4->ZZZZZj9($current_user)));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("significantDigits", PlatformConnector::ZZZZZZL1111());$ZZZg6 = json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]);$ZZZg6->aggregateColumn = false;$ZZZg6->isCrosstab = false;$ZZZg6->includeDetails = false;$ZZZZZZZZZZZZZZZZZZE44['isCombined'] = $ZZZg6->isCombined;$ZZZZZZZZZZZZZZZZZZZZU2020->assign("REPORTCOMBINED", $isCombined);$ZZZZZZZZZZZZZZZZZZZZs18 = array();if($isCombined){$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZZm12($db, $ZZZZZe4);}else{$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZI88($db, $ZZZZZe4);} $ZZZZZZZZZZZZZZZZZZZZX2323 = json_encode($ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZN1313($module, json_decode($ZZZZZZZZZZZZZZZZZZE44['fields']), json_decode($ZZZZZZZZZZZZZZZZZZE44["filters"]), $ZZZZZZZZZZZZZZZZZZG66, json_decode(json_encode($ZZZZZZZZZZZZZZZZZZZZl11->chartGrouping),true), json_decode(json_encode($ZZZZZZZZZZZZZZZZZZZZl11->chartAggregates),true), !$ZZZg6->includeDetails, $ZZZg6->isCrosstab, true, $ZZZg6->aggregateColumn, $ZZZZZe4->ZZZZZq16($current_user), true, isset($ZZZZZZZZZZZZZZZZZZE44['calcFields']) ? json_decode($ZZZZZZZZZZZZZZZZZZE44['calcFields'], true) : array(), array(), $ZZZZZZZZZZZZZQ1616));$ZZZZZZZZZZZZZZZZZZZZU2020->assign("CHARTDATA", $ZZZZZZZZZZZZZZZZZZZZX2323);$ZZZZZZZZZZZZZZZZZZZZU2020->display('modules/AnalyticReporting/Dashlets/WidgetDashlet/WidgetDashlet.tpl');exit;} function action_addToDashboard() {global $sugar_flavor;if($sugar_flavor == 'CE') {$this->ZZZZZZZZZZZZZZZZZZZZY2424();} else {$this->ZZZZZZZZZZZZZZZZZZZZZ2525();}} function ZZZZZZZZZZZZZZZZZZZZZ2525() {global $current_user, $mod_strings, $sugar_config;;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$this->ZZZZZZZZZZZZZZZZZZZY2424();$title	= $_REQUEST['title'];$ZZZZZa0	= $_REQUEST['record'];$ZZZZZZZZZZZZZZZZZZZZZa0 = 'Home';$ZZZa0 = PlatformConnector::ZZZb1('Dashboards');$ZZZZZZZZZZZZZZZZZZZZf5 = "dashboards.assigned_user_id = '".$current_user->id."' AND dashboards.deleted = 0 AND dashboards.dashboard_module = 'Home' AND dashboards.dashboard_type = 'dashboard'";$ZZZZZZZZZZZZZZZZZZZZZb1 = $ZZZa0->get_list("", $ZZZZZZZZZZZZZZZZZZZZf5);if(count($ZZZZZZZZZZZZZZZZZZZZZb1['list'] > 0)) {$ZZZZZZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZZZZZZZZZZZZb1['list'][0];} else {echo "Available dashboards not found";die;} $ZU2020 = SugarConfig::getInstance();$url = $ZU2020->get('site_url') . '/';if(empty($title)) {$title = "Analytic reporting widget";} $r17 = json_decode(html_entity_decode($ZZZZZZZZZZZZZZZZZZZZZc2->metadata), true);$r17['components'][0]['rows'][] = array(array('width' => 12, 'context' => array('module' => 'Home', 'link' => null,), 'view' => array('url' => $url . 'index.php?entryPoint=analyticReportWidget&record=' . $ZZZZZa0, 'module' => "Home", 'limit' => 10, 'label' => $title, 'type' => "webpage",)));$ZZZZZZZZZZZZZZZZZZZZZc2->metadata = json_encode($r17);$ZY2424 = $ZZZZZZZZZZZZZZZZZZZZZc2->save();if($ZY2424) {echo "Chart added to dashboard with id: " . $ZY2424;} die;} function ZZZZZZZZZZZZZZZZZZZZY2424() {global $current_user, $sugar_config;$ZZZZZZZZZZZZZZZZZZZZZa0 = 'Home';$ZZZZZi8 = $current_user;if(!is_file(sugar_cached('dashlets/dashlets.php'))) {require_once('include/Dashlets/DashletCacheBuilder.php');$ZZZZZZZZZZZZZZZZZZZZZd3 = new DashletCacheBuilder();$ZZZZZZZZZZZZZZZZZZZZZd3->buildCache();} require sugar_cached('dashlets/dashlets.php');$this->ZZZZZZZZZZZZZZZZZZZY2424();$title	= empty($_REQUEST['title']) ? "Analytic reporting widget" : $_REQUEST['title'];$ZZZK1010 = $_REQUEST['record'];$ZZZZZZZZZZZZZZZZZZZZZe4 = 'iFrameDashlet';$ZZZZZZZZZZZZZZZZZZZZZf5 = 0;$ZZZZZZZZZZZZZZZZZZZZZg6 = $sugar_config['site_url']."/index.php?module=AnalyticReporting&action=widget&record=".$ZZZK1010;$ZZZZZZZZZZZZZZZZZZZZZh7 = create_guid();$ZZZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZi8->getPreference('dashlets', $ZZZZZZZZZZZZZZZZZZZZZa0);$ZZZZZZZZZZZZZu20 = $ZZZZZi8->getPreference('pages', $ZZZZZZZZZZZZZZZZZZZZZa0);$ZZZg6 = array('url' => $ZZZZZZZZZZZZZZZZZZZZZg6, 'title' => $title);$ZZZZZZZZZZZZZZZZZZZZZi8[$ZZZZZZZZZZZZZZZZZZZZZh7] = array('className' => $dashletsFiles[$ZZZZZZZZZZZZZZZZZZZZZe4]['class'], 'module' => $ZZZZZZZZZZZZZZZZZZZZZa0, 'options' => $ZZZg6, 'fileLocation' => $dashletsFiles[$ZZZZZZZZZZZZZZZZZZZZZe4]['file']);if(!isset($ZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZZZZZZZZf5]['columns'][0]['dashlets'])){return true;} array_unshift($ZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZZZZZZZZf5]['columns'][0]['dashlets'], $ZZZZZZZZZZZZZZZZZZZZZh7);$ZZZZZi8->setPreference('dashlets', $ZZZZZZZZZZZZZZZZZZZZZi8, 0, $ZZZZZZZZZZZZZZZZZZZZZa0);$ZZZZZi8->setPreference('pages', $ZZZZZZZZZZZZZu20, 0, $ZZZZZZZZZZZZZZZZZZZZZa0);$ZZZZZi8->savePreferencesToDB();die();} function action_downloadFontCheck() {$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$ZZZZZZZZZZZZZZZZZZh7 = array("messages" => array(),);$ZZZZZZZZZZZZZZZZZZZZS1818 = $ZZv21->getValue('pdfFontFamily');if($ZZZZZZZZZZZZZZZZZZZZS1818) {$ZZZZZZZZZZZZZZZZZZZZZj9 = "modules/AnalyticReporting/lib/tcpdf/fonts/";if(FunctionWrapper::_file_exists($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZS1818 . ".php")) {$ZZZZZZZZZZZZZZZZZZZZZk10 = new ZZZZZZZZZZZZZZZZZZZv21();$ZZZZZZZZZZZZZZZZZZZZZl11 = $ZZZZZZZZZZZZZZZZZZZZZk10->retrieve($ZZv21->getValue('apiEndpoint') . "fonts/list", true);$ZZZZZZZZZZZZZZZZZZZZZm12 = false;foreach($ZZZZZZZZZZZZZZZZZZZZZl11['files'] as $ZZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZZo14) {if(FunctionWrapper::_file_exists($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZZn13)) {if(md5_file($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZZn13) != $ZZZZZZZZZZZZZZZZZZZZZo14) {$ZZZZZZZZZZZZZZZZZZh7["messages"][] = "File {$ZZZZZZZZZZZZZZZZZZZZZj9}{$ZZZZZZZZZZZZZZZZZZZZZn13} have invalid checksum ({$ZZZZZZZZZZZZZZZZZZZZZo14})";$ZZZZZZZZZZZZZZZZZZZZZm12 = true;}} else {$ZZZZZZZZZZZZZZZZZZZZZm12 = true;}} if($ZZZZZZZZZZZZZZZZZZZZZm12) {$ZZZZZZZZZZZZZZZZZZh7["status"] = false;$ZZZZZZZZZZZZZZZZZZh7["error"] = "Fonts files should be downloaded, because checksum is different.";} else {$ZZZZZZZZZZZZZZZZZZh7["status"] = true;}} else {$ZZZZZZZZZZZZZZZZZZh7["status"] = false;$ZZZZZZZZZZZZZZZZZZh7["error"] = "Fonts files should be downloaded, because not found.";}} else if (isset($_SESSION["downloadFontProgress"]) && $_SESSION["downloadFontProgress"]) {$ZZZZZZZZZZZZZZZZZZh7["status"] = false;$ZZZZZZZZZZZZZZZZZZh7["error"] = "Font downloading failed. Please check module directory write permissions and try again.";unset($_SESSION["downloadFontProgress"]);} else {$ZZZZZZZZZZZZZZZZZZh7["status"] = false;$ZZZZZZZZZZZZZZZZZZh7["error"] = "Installation provided without PDF fonts, for smaller module file upload. Please download fonts, to successfully export PDF files.<br /><br /> This can take some time, depending on your internet connection.";} unset($_SESSION["downloadFontProgress"]);echo json_encode($ZZZZZZZZZZZZZZZZZZh7);die;} function action_downloadFont() {$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$ZZZZZZZZZZZZZZZZZZh7 = array();$ZZZZZZZZZZZZZZZZZZZZZp15 = array();$_SESSION["downloadFontProgress"] = true;$ZZZZZZZZZZZZZZZZZZZZZk10 = new ZZZZZZZZZZZZZZZZZZZv21();$ZZZZZZZZZZZZZZZZZZZZZl11 = $ZZZZZZZZZZZZZZZZZZZZZk10->retrieve($ZZv21->getValue('apiEndpoint') . "fonts/list", true);if(isset($ZZZZZZZZZZZZZZZZZZZZZl11['files']) && isset($ZZZZZZZZZZZZZZZZZZZZZl11['path'])) {$ZZZZZZZZZZZZZZZZZZZZZj9 = "modules/AnalyticReporting/lib/tcpdf/fonts/";@FunctionWrapper::_chmod($ZZZZZZZZZZZZZZZZZZZZZj9, 0777);$ZZZZZZZZZZZZZZZZZZZw22 = 0;foreach($ZZZZZZZZZZZZZZZZZZZZZl11['files'] as $ZZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZZo14) {if(!FunctionWrapper::_file_exists($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZZn13)) {if(md5_file($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZZn13) == $ZZZZZZZZZZZZZZZZZZZZZo14) {$ZZZZZZZZZZZZZZZZZZZZZp15[] = "File {$ZZZZZZZZZZZZZZZZZZZZZj9}{$ZZZZZZZZZZZZZZZZZZZZZn13} have valid checksum ({$ZZZZZZZZZZZZZZZZZZZZZo14})";continue;}} $ZZZZZZZZZZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZZZZZZZZZZk10->retrieve($ZZZZZZZZZZZZZZZZZZZZZl11['path'] . $ZZZZZZZZZZZZZZZZZZZZZn13, false, false);$ZY2424 = FunctionWrapper::_file_put_contents($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZZn13, $ZZZZZZZZZZZZZZZZZZZZZq16);if(md5_file($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZZn13) != $ZZZZZZZZZZZZZZZZZZZZZo14) {$ZZZZZZZZZZZZZZZZZZZZZp15[] = "File {$ZZZZZZZZZZZZZZZZZZZZZj9}{$ZZZZZZZZZZZZZZZZZZZZZn13} have invalid checksum ({$ZZZZZZZZZZZZZZZZZZZZZo14})";$ZY2424 = false;} if(!$ZY2424) {$ZZZZZZZZZZZZZZZZZZZw22++;}}} if(isset($ZZZZZZZZZZZZZZZZZZZZZl11["fontFamily"]) && empty($ZZZZZZZZZZZZZZZZZZZw22)) {if(!FunctionWrapper::_is_file($ZZZZZZZZZZZZZZZZZZZZZj9 . $ZZZZZZZZZZZZZZZZZZZZZl11["fontFamily"] . ".php")) {return false;} $ZZv21->ZZs18("pdfFontFamily", $ZZZZZZZZZZZZZZZZZZZZZl11["fontFamily"]);unset($_SESSION["downloadFontProgress"]);$ZZZZZZZZZZZZZZZZZZh7["status"] = true;} else {$ZZZZZZZZZZZZZZZZZZh7["status"] = false;} $ZZZZZZZZZZZZZZZZZZh7["messages"] = $ZZZZZZZZZZZZZZZZZZZZZp15;echo json_encode($ZZZZZZZZZZZZZZZZZZh7);die;}}