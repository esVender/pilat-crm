<?php 
 //WARNING: The contents of this file are auto-generated



/*** DOMAIN_CHECK ***/
 if(!defined('sugarEntry') || !sugarEntry) die('Not A Valid Entry Point');$job_strings = array_merge($job_strings, array('sendScheduledReports',));require_once "modules/AnalyticReporting/profiles/FunctionWrapper.php";FunctionWrapper::_ini_set('memory_limit','512M');class a0
{protected $b1 = 'YmUzYWM2sNGU24NbA363zA7IDSDFGDFGB5aVi35BDFGQ3YNO36ycDFGAATq4sYmSFVDFGDFGps7XDYEzGDDw96OnMW3kjCFJ7M+UV2kHe1WTTEcM09UMHHT';protected $c2 = '80dSbqylf4Cu5e5OYdAoAVkzpRDWAt7J1Vp27sYDU52ZBJprdRL1KE0il8KQXuKCK3sdA51P9w8U60wohX2gdmBu7uVhjxbS8g4y874Ht8L12W54Q6T4R4a';protected $d3 = 'ant9pbc3OK28Li36Mi4d3fsWJ4tQSN4a9Z2qa8W66qR7ctFbljsOc9J4wa2Bh6j8KB3vbEXB18i6gfbE0yHS0ZXQCceIlG7jwzDmN7YT06mVwcM9z0vy62T';protected $e4 = true;protected $f5 = 'blowfish';protected $g6;protected $h7 = 129600;protected $i8 = 'nSpkAHRiFfM2hE588eB';protected $j9 = 'NWCy0s0JpGubCVKlkkK';protected $k10 = 'G95ZP2uS782cFey9x5A';protected $l11 = 'BEGIN LICENSE KEY';protected $m12 = 'END LICENSE KEY';protected $n13 = 80;protected $o14 = "-";protected $p15 = '_DATA{';protected $q16 = '}DATA_';protected $r17 = array();protected $s18;protected $t19;protected $u20;protected $v21;protected $w22 = array();protected $x23 = array();protected $y24 = array();protected $z25 = 2;protected $A00 = 'M/d/Y H:i:s';protected $B11 = 0;protected $C22 = 0;function __construct($e4=true, $g6=true, $s18=true, $v21=false) {$this->D33($e4, $g6, $s18, $v21);if ($this->s18) {$this->u20 = $this->E44();}} function D33($e4=true, $g6=true, $s18=true, $v21=false) {$this->e4 = ($e4 && function_exists('mcrypt_generic'));$this->g6 = $g6;$this->v21 = $v21;$this->s18 = $s18;} function F55($G66) {$this->x23 = $G66;$this->y24 = $this->H77();$this->w22 = $this->I88();} function J99 ($K1010) {return $this->L1111($K1010);} function M1212 ($K1010, $N1313, $O1414, $P1515="80") {return $this->L1111($K1010, true, $N1313, $O1414, $P1515);} function L1111($K1010, $Q1616=false, $N1313="", $O1414="", $P1515="80") {if (strlen($K1010)>0) {$r17 = $this->R1717($K1010);if (is_array($r17)) {if ($r17['ID'] != md5($this->i8)) {$r17['RESULT'] = 'CORRUPT';} if ($this->g6) {if ($r17['DATE']['START'] > time()+$this->h7) {$r17['RESULT'] = 'TMINUS';} if ($r17['DATE']['END']-time() < 0 && $r17['DATE']['SPAN'] != 'NEVER') {$r17['RESULT'] = 'EXPIRED';} if(is_int($r17['DATE']['END'])) {$r17['DATE']['HUMAN']['START'] = date($this->A00, $r17['DATE']['START']);$r17['DATE']['HUMAN']['END'] = date($this->A00, $r17['DATE']['END']);}} if ($this->s18) {$u20 = $r17['SERVER']['MAC'] == $this->u20;$S1818 = count(array_diff($this->w22, $r17['SERVER']['PATH'])) <= $this->B11;$T1919 = $this->U2020($r17['SERVER']['DOMAIN'], $this->y24);$V2121 = count(array_diff($this->y24, $r17['SERVER']['IP'])) <= $this->C22;if (!$u20 || !$S1818 || !$T1919 || !$V2121) {$r17['RESULT'] = 'ILLEGAL';} $W2222 = $this->v21 && (in_array('127.0.0.1', $r17['SERVER']['IP']) || $r17['PATH']['SERVER_ADDR'] == '127.0.0.1' || $r17['PATH']['HTTP_HOST'] == '127.0.0.1');if (!$W2222) {$r17['RESULT'] = 'ILLEGAL_LOCAL';}} if (!isset($r17['RESULT'])) {if ($Q1616) {$X2323 = array();$X2323['LICENSE_DATA'] = $r17;$X2323['LICENSE_DATA']['KEY'] = md5($K1010);} else {$r17['RESULT'] = 'OK';}} return $r17;} else {return array('RESULT'=>'INVALID');}} return array('RESULT'=>'EMPTY');} function Y2424($dateFormat) {$this->A00 = $dateFormat;} function U2020($T1919, $y24=false) {if (!$y24) {$y24 = $this->H77();} $Z2525 = gethostbynamel($T1919);if (is_array($Z2525) && count($Z2525) > 0) {foreach ($Z2525 as $V2121) {if (in_array($V2121, $y24)) {return true;}}} return false;} function Za0($Zb1) {$Zc2 = strlen($Zb1);$Zd3 = ($this->n13-$Zc2)/2;$Ze4 = '';for ($Zf5=0;$Zf5<$Zd3;$Zf5++) {$Ze4 = $Ze4.$this->o14;} if ($Zd3/2 != round($Zd3/2)) {$Zb1 = substr($Ze4, 0, strlen($Ze4)-1).$Zb1;} else {$Zb1 = $Ze4.$Zb1;} $Zb1 = $Zb1.$Ze4;return $Zb1;} function Zg6($Zh7) {switch($Zh7) {case 'KEY' : return $this->b1;case 'REQUESTKEY' : return $this->c2;case 'HOMEKEY' : return $this->d3;default :}} function Zi8($Zh7) {switch($Zh7) {case 'KEY' : return $this->l11;case 'REQUESTKEY' : return $this->p15;case 'HOMEKEY' : return '';}} function Zj9($Zh7) {switch($Zh7) {case 'KEY' : return $this->m12;case 'REQUESTKEY' : return $this->q16;case 'HOMEKEY' : return '';}} function Zk10($Zl11=10, $Zm12='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567890123456789') {$Zb1 = '';$Zn13 = strlen($Zm12);list($Zo14, $Zp15) = explode(' ', microtime());$Zq16 = (float) $Zp15 + ((float) $Zo14 * 100000);mt_srand($Zq16);for ($Zf5 = 0;$Zl11 > $Zf5;$Zf5++) {$Zb1 .= $Zm12{mt_rand(0, $Zn13 - 1)};} return $Zb1;} function Zr17($Zs18, $Zh7='KEY') {$Zt19 = $this->Zk10(3);$Zu20 = $this->Zg6($Zh7);$Zu20 = $Zt19 . $Zu20;if ($this->e4) {$Zv21 = mcrypt_module_open($this->f5, '', 'ecb', '');$Zw22 = mcrypt_create_iv(mcrypt_enc_get_iv_size($Zv21), MCRYPT_RAND);$Zu20 = substr($Zu20, 0, mcrypt_enc_get_key_size($Zv21));mcrypt_generic_init($Zv21, $Zu20, $Zw22);$Zx23 = mcrypt_generic($Zv21, serialize($Zs18));mcrypt_generic_deinit($Zv21);mcrypt_module_close($Zv21);} else {$Zx23 = '';$Zb1 = serialize($Zs18);for ($Zf5=1;$Zf5<=strlen($Zb1);$Zf5++) {$Zy24 = substr($Zb1, $Zf5-1, 1);$Zz25 = substr($Zu20, ($Zf5 % strlen($Zu20))-1, 1);$Zy24 = chr(ord($Zy24)+ord($Zz25));$Zx23 .= $Zy24;}} return $Zt19.base64_encode(base64_encode(trim($Zx23)));} function ZA00($Zb1, $Zh7='KEY') {$Zt19 = substr($Zb1, 0, 3);$Zb1 = base64_decode(base64_decode(substr($Zb1, 3)));$Zu20 = $Zt19 . $this->Zg6($Zh7);if ($this->e4) {$Zv21 = mcrypt_module_open($this->f5, '', 'ecb', '');$Zw22 = mcrypt_create_iv(mcrypt_enc_get_iv_size($Zv21), MCRYPT_RAND);$Zu20 = substr($Zu20, 0, mcrypt_enc_get_key_size($Zv21));mcrypt_generic_init($Zv21, $Zu20, $Zw22);$ZB11 = @mdecrypt_generic($Zv21, $Zb1);mcrypt_generic_deinit($Zv21);mcrypt_module_close($Zv21);} else {$ZB11 = '';for ($Zf5=1;$Zf5<=strlen($Zb1);$Zf5++) {$Zy24 = substr($Zb1, $Zf5-1, 1);$Zz25 = substr($Zu20, ($Zf5 % strlen($Zu20))-1, 1);$Zy24 = chr(ord($Zy24)-ord($Zz25));$ZB11 .= $Zy24;}} return @unserialize($ZB11);} function ZC22($Zs18, $Zh7='KEY') {$ZD33 = $this->Za0($this->Zi8($Zh7));$ZE44 = $this->Za0($this->Zj9($Zh7));$Zb1 = $this->Zr17($Zs18, $Zh7);return $ZD33 . PHP_EOL . wordwrap($Zb1, $this->n13, PHP_EOL, 1) . PHP_EOL . $ZE44;} function R1717($ZF55, $Zh7='KEY') {$ZD33 = $this->Za0($this->Zi8($Zh7));$ZE44 = $this->Za0($this->Zj9($Zh7));$Zb1 = trim(str_replace(array($ZD33, $ZE44, "\r", "\n", "\t"), '', $ZF55));return $this->ZA00($Zb1, $Zh7);} function ZG66($ZH77, $ZI88) {$ZH77 = strtolower($ZH77);switch($ZI88) {case 'freebsd' : case 'netbsd' : case 'solaris' : case 'sunos' : case 'darwin' : switch($ZH77) {case 'conf' : $ZJ99 = '/sbin/ifconfig';break;case 'mac' : $ZJ99 = 'ether';break;case 'ip' : $ZJ99 = 'inet ';break;} break;case 'linux' : switch($ZH77) {case 'conf' : $ZJ99 = '/sbin/ifconfig';break;case 'mac' : $ZJ99 = 'HWaddr';break;case 'ip' : $ZJ99 = 'inet addr:';break;} break;} return $ZJ99;} function H77() {$y24 = array();if (isset($this->x23['SERVER_NAME'])) {$V2121 = gethostbyname($this->x23['SERVER_NAME']);if (!isset($y24[$V2121])) {$y24[$V2121] = $V2121;}} if (isset($this->x23['SERVER_ADDR'])) {$name = gethostbyaddr($this->x23['SERVER_ADDR']);$V2121 = gethostbyname($name);if (!isset($y24[$V2121])) {$y24[$V2121] = $V2121;} if (isset($ZK1010) && $ZK1010 != $this->x23['SERVER_ADDR']) {if (!isset($y24[$this->x23['SERVER_ADDR']])) {$y24[$this->x23['SERVER_ADDR']] = $this->x23['SERVER_ADDR'];}}} if (count($y24) > 0) {return $y24;} return 'IP_404';} function E44() {return 'MAC_404';} function I88() {if (empty($this->x23)) {$this->F55($ZL1111);} $ZM1212 = array();if (isset($this->x23['SERVER_ADDR']) && (!strrpos($this->x23['SERVER_ADDR'], '127.0.0.1') || $this->v21)) {$ZM1212['SERVER_ADDR'] = $this->x23['SERVER_ADDR'];} if (isset($this->x23['HTTP_HOST']) && (!strrpos($this->x23['HTTP_HOST'], '127.0.0.1') || $this->v21)) {$ZM1212['HTTP_HOST'] = $this->x23['HTTP_HOST'];} if (isset($this->x23['SERVER_NAME'])) {$ZM1212['SERVER_NAME'] = $this->x23['SERVER_NAME'];} if (isset($this->x23['PATH_TRANSLATED'])) {$ZM1212['PATH_TRANSLATED'] = substr($this->x23['PATH_TRANSLATED'], 0, strrpos($this->x23['PATH_TRANSLATED'], '/'));} else if (isset($this->x23['SCRIPT_FILENAME'])) {$ZM1212['SCRIPT_FILENAME'] = substr($this->x23['SCRIPT_FILENAME'], 0, strrpos($this->x23['SCRIPT_FILENAME'], '/'));} if (isset($ZL1111['SCRIPT_URI'])) {$ZM1212['SCRIPT_URI'] = substr($this->x23['SCRIPT_URI'], 0, strrpos($this->x23['SCRIPT_URI'], '/'));} if (count($ZM1212) < $this->z25) {return 'SERVER_FAILED';} return $ZM1212;} function ZN1313($T1919='', $ZO1414=0, $ZP1515=31449600, $ZQ1616=array()) {if ($this->w22 !== false || !$this->s18) {$r17['ID'] = md5($this->i8);if ($this->s18) {$r17['SERVER']['DOMAIN'] = $T1919;$r17['SERVER']['MAC'] = $this->u20;$r17['SERVER']['PATH'] = $this->w22;$r17['SERVER']['IP'] = $this->y24;} if ($this->g6 && !is_array($ZO1414)) {$ZR1717 = time();$ZO1414 = ($ZR1717 < $ZO1414) ? $ZO1414 : $ZR1717+$ZO1414;$r17['DATE']['START'] = $ZO1414;$r17['DATE']['SPAN'] = $ZP1515;if ($ZP1515 == 'NEVER') {$r17['DATE']['END'] = 'NEVER';} else {$r17['DATE']['END'] = $ZO1414+$ZP1515;}} if (is_array($ZO1414)) {$ZQ1616 = $ZO1414;} $ZQ1616['_PHP_OS'] = PHP_OS;$ZQ1616['_PHP_VERSION'] = PHP_VERSION;$r17['DATA'] = $ZQ1616;$Zu20 = $this->ZC22($r17);return $Zu20;} return 'SERVER_FAIL';}} ;class ZS1818 extends a0 {public $ZT1919 = '';public $ZU2020;function __construct(ZV2121 $ZU2020, $e4=true, $g6=true, $s18=true, $v21=false){$this->ZU2020 = $ZU2020;parent::__construct($e4, $g6, $s18, $v21);} function ZW2222($Zu20) {if(!$this->J99($Zu20) && (isset($_REQUEST['action']) && !in_array($_REQUEST['action'], array("settings","index")))) {echo '<div style="border:1px solid red;font:12px/20px arial,sans-serif;padding:20px;margin:20px auto;">'.$this->ZT1919.'</div>';$this->report();exit();} if (!$this->J99($Zu20)) {global $ZX2323;$ZX2323 = $this->ZT1919;}} function J99($K1010) {$r17 = parent::J99($K1010);if($r17['RESULT'] == 'OK') {$ZY2424 = $this->ZZ2525($r17['DATA']['_D']);if(!$ZY2424) {$this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyByZXBvcnRpbmcgbW9kdWxlIGNvcHkgb24gdW5saWNlbnNlZCBkb21haW4hIFBsZWFzZSBjb250YWN0IElUIFNhcGllbnMsIEx0ZC4gc3VwcG9ydCBieSBlbWFpbCBpbmZvQGl0c2FwaWVucy5ldS4=');return false;} $ZY2424 = $this->ZZa0($r17['DATA']['_V']);if(!$ZY2424) {$this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyByZXBvcnRpbmcgbW9kdWxlIGxpY2Vuc2UgZm9yIGRpZmZlcmVudCB2ZXJzaW9uIG9mIHN5c3RlbSEgUGxlYXNlIGNvbnRhY3QgSVQgU2FwaWVucywgTHRkLiBzdXBwb3J0IGJ5IGVtYWlsIGluZm9AaXRzYXBpZW5zLmV1Lg==');return false;} $ZY2424 = $this->ZZb1($r17['DATA']['_U']);if(!$ZY2424) {$this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyByZXBvcnRpbmcgbW9kdWxlIGNvcHkgaW4gc3lzdGVtIHdpdGggbW9yZSB1c2VycyB0aGFuIGxpY2Vuc2VkISBQbGVhc2UgY29udGFjdCBJVCBTYXBpZW5zLCBMdGQuIHN1cHBvcnQgYnkgZW1haWwgaW5mb0BpdHNhcGllbnMuZXUu');return false;} return true;} $this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyB1bmxpY2Vuc2VkIG9yIGV4cGlyZWQgY29weSBvZiByZXBvcnRpbmcgbW9kdWxlISBQbGVhc2UgY29udGFjdCBJVCBTYXBpZW5zLCBMdGQuIHN1cHBvcnQgYnkgZW1haWwgaW5mb0BpdHNhcGllbnMuZXUu');return false;} function ZZ2525($ZZc2, $y24=false){$ZZd3 = $this->x23[base64_decode('U0VSVkVSX05BTUU=')];$ZZd3 = preg_replace("#^www\.(.+\.)#i", "$1", $ZZd3);$ZZe4 = explode(",", $ZZc2);$ZZf5 = array($ZZd3, base64_decode('Rk9SQUxMRE9NQUlOUw=='));foreach($ZZe4 as $T1919) {if(in_array($T1919, $ZZf5)) {return true;}} return false;} function ZZa0($ZZg6) {$ZZh7 = array($this->ZU2020->getValue(base64_decode('dmVyc2lvbg==')), base64_decode('Rk9SQUxMVkVSU0lPTlM='));if(in_array($ZZg6, $ZZh7)) {return true;} return false;} function ZZb1($ZZi8) {$ZZj9 = $this->ZZk10();if($ZZj9 && ($ZZi8 >= $ZZj9)) {return true;} return false;} function ZZk10() {$ZZl11 = $this->ZZm12();if($ZZl11 == 'SUGARCRM') {global $db;$ZY2424 = $db->query("SELECT COUNT(*) AS count FROM `users` WHERE `status` = 'Active'");$ZZn13 = $db->fetchByAssoc($ZY2424);return $ZZn13['count'];} if($ZZl11 == 'VTIGER') {global $adb;$ZY2424 = $adb->query("SELECT COUNT(*) AS count FROM `vtiger_users` WHERE `status` = 'Active'");$ZZn13 = $adb->query_result($ZY2424, 0, 'count');return $ZZn13;} return false;} function ZZm12() {global $sugar_config;global $vtiger_current_version;if(!empty($sugar_config)) {return 'SUGARCRM';} if(!empty($vtiger_current_version)) {return 'VTIGER';}} function report() {$ZZo14 = curl_init(base64_decode('aHR0cDovL2xvZy5kZXYuaXRzYXBpZW5zLmV1'));curl_setopt($ZZo14, CURLOPT_CUSTOMREQUEST, "POST");curl_setopt($ZZo14, CURLOPT_POSTFIELDS, stripslashes(json_encode($this->x23)));curl_setopt($ZZo14, CURLOPT_RETURNTRANSFER, true);curl_exec($ZZo14);}}
;class ZV2121
{protected $db;function __construct(ZZp15 $db) {$this->db = $db;} function getValue($Zu20) {$Zu20 = $this->db->quote($Zu20);$ZZq16 = "SELECT `value` FROM `advancedreports_config` WHERE `key` = '{$Zu20}' LIMIT 1";$ZY2424 = $this->db->query($ZZq16);$ZZr17 = $this->db->fetchRow($ZY2424);if(isset($ZZr17['value'])) {return $ZZr17['value'];} return false;} function ZZs18($Zu20, $value) {$Zu20 = $this->db->quote($Zu20);$value = $this->db->quote($value);$ZZq16 = "INSERT INTO `advancedreports_config` (`key`, `value`) VALUES ('{$Zu20}', '{$value}') ON DUPLICATE KEY UPDATE `key` = '{$Zu20}', `value` = '{$value}' ";return $this->db->query($ZZq16);}}
;$ZZt19 = false;if(file_exists('modules/AnalyticReporting/outfitter.php') && require('modules/AnalyticReporting/outfitter.php')){$ZZt19 = true;}
if($ZZt19){require_once('modules/AnalyticReporting/license/OutfittersLicense.php');$ZZu20 = AnalyticReportingOutfittersLicense::isValid('AnalyticReporting');if($ZZu20 !== true && isset($_REQUEST['action']) && !in_array($_REQUEST['action'], array("index", "license"))) {if($_REQUEST['action']!='widget'){header("Location: index.php?module=AnalyticReporting&action=license&inactive=".urlencode($ZZu20));} else {echo '<h2><p class="error">AnalyticReporting is inactive</p></h2><p class="error">'.$ZZu20.'</p>';exit();}}}else{$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$ZZw22 = new ZS1818($ZZv21, false, true, false, true);$ZZw22->F55($_SERVER);$ZZw22->ZW2222($ZZv21->getValue('key'));} class ZZp15 {protected $db;public $dbPrefix = "";protected $ZZx23 = false;function __construct($db){$this->db = $db;} function ZZy24($ZZq16) {$ZZz25 = preg_split('/((?<!\\\)[&?!])/', $ZZq16, -1, PREG_SPLIT_DELIM_CAPTURE);$ZZn13 = 0;$ZZA00 = '';foreach ($ZZz25 as $Zu20 => $ZZB11) {switch ($ZZB11) {case '?' : case '!' : case '&' : $ZZn13++;$ZZA00 .= '?';break;default : $ZZz25[$Zu20] = preg_replace('/\\\([&?!])/', "\\1", $ZZB11);$ZZA00 .= $ZZz25[$Zu20];break;}} $this->preparedTokens[] = array('tokens' => $ZZz25, 'tokenCount' => $ZZn13, 'sqlString' => $ZZA00);end($this->preparedTokens);return key($this->preparedTokens);} function ZZC22($ZZD33, $r17 = array(), $ZZx23 = false) {if(!empty($this->preparedTokens[$ZZD33])){if(!is_array($r17)){$r17 = array($r17);} $ZZE44 = $this->preparedTokens[$ZZD33];if(count($r17) != $ZZE44['tokenCount']){return false;} $query = '';$ZZF55 = 0;$ZZz25 = $ZZE44['tokens'];foreach ($ZZz25 as $ZZB11) {switch ($ZZB11) {case '?': $query .= "'".$r17[$ZZF55++]."'";break;case '&': $ZZG66 = $r17[$ZZF55++];$query .= file_get_contents($ZZG66);break;case '!': $query .= $r17[$ZZF55++];break;default: $query .= $ZZB11;break;}} $ZY2424 = $this->db->query($query);if($this->ZZx23 || $ZZx23) {if($this->db->lastDbError()) {echo "<pre style='border:1px solid red'>";var_dump($this->db->lastDbError());var_dump(debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS));echo "</pre>";}} return $ZY2424;}else{return false;}} function ZZH77($ZZq16, $r17 = array(), $ZZx23 = false) {$ZZD33 = $this->ZZy24($ZZq16);return $this->ZZC22($ZZD33, $r17, $ZZx23);} function ZZI88($ZY2424, $Zu20) {$ZZr17 = $this->fetchRow($ZY2424);if(isset($ZZr17[$Zu20])) {return $ZZr17[$Zu20];} return false;} function setDieOnError($value) {$this->db->setDieOnError($value);} function quote($ZZJ99) {return $this->db->quote($ZZJ99);} function query($ZZq16) {return $this->db->query($ZZq16);} function fetchRow($ZY2424) {if(method_exists($this->db, 'fetchRow')) {return $this->db->fetchRow($ZY2424);} else {return $this->db->fetchByAssoc($ZY2424, -1, false);}} function ZZK1010($ZZL1111, $type = 'single') {$ZZM1212 = array();$quote = '"';if($type == 'single') {$quote = "'";} foreach($ZZL1111 as $value) {$ZZM1212[] = $quote . $value . $quote;} return $ZZM1212;} function run_query_allrecords($query) {$ZY2424 = $this->db->query($query);return $this->GetAll($ZY2424);} function GetAll($ZY2424) {$r17 = array();while($ZZr17 = $this->fetchRow($ZY2424)) {$r17[] = $ZZr17;} return $r17;} function ZZN1313($fieldName, $module){$ZZO1414 = array();$field = $this->ZZP1515($fieldName, $module);if(isset($field["options"])) {if(isset($GLOBALS['app_list_strings'][$field["options"]])) {$ZZO1414 = $GLOBALS['app_list_strings'][$field["options"]];}} return $ZZO1414;} function ZZQ1616($ZZR1717){$ZZS1818 = null;$ZZq16 = 'SELECT currency_code FROM vtiger_currency_info WHERE id=?';$ZY2424 = $this->ZZH77($ZZq16,array($ZZR1717));$ZZT1919 = $this->db->num_rows($ZY2424);if($ZZT1919 == 1){$ZZS1818 = $this->db->query_result($ZY2424, 0, 'currency_code');} return $ZZS1818;} function ZZU2020($module,$name){$ZZS1818 = $name;$ZZV2121 = $this->ZZW2222($module);foreach($ZZV2121 as $field) {if($field['fieldname'] == $name) {return $field;}} return $ZZS1818;} function ZZP1515($fieldName, $module) {$ZZV2121 = $this->ZZW2222($module);foreach($ZZV2121 as $field) {if($field["fieldname"] == $fieldName) {return $field;}} return false;} function ZZX2323($ZZY2424, $field) {$ZZZ2525 = array('tablename' => $ZZY2424, 'columnname' => $field['name'], 'fieldname' => $field['name'], 'fieldlabel' => $field['vname'], 'uitype' => $field['type'], 'typeofdata' => 'V~O', 'block' => '1',);if(isset($field['dbType'])) {$ZZZ2525['dbType'] = $field['dbType'];} if(isset($field['options'])) {$ZZZ2525['options'] = $field['options'];} if($field['type'] == 'link') {return false;} if(isset($field['source'])) {if(in_array($field['source'], array('non-db'))) {return false;} if($field['source'] == 'custom_fields') {$ZZZ2525['tablename'] = $ZZZ2525['tablename'] . '_cstm';}} if($field['vname'] == '' && $field['type'] != 'id') {return false;}elseif($field['vname'] == '' && $field['type'] == 'id'){$ZZZ2525['fieldlabel'] = $field['name'];} if($field['type'] == 'relate') {if(!isset($field['module'])) {return false;} $ZZZ2525['related_module'] = $field['module'];$ZZZ2525['id_name'] = $field['id_name'];if(isset($field['table'])) {$ZZZ2525['table'] = $field['table'];} if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} if($field['type'] == 'assigned_user_name') {$ZZZ2525['related_module'] = 'Users';$ZZZ2525['table'] = 'users';$ZZZ2525['id_name'] = 'id';if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} return $ZZZ2525;} function ZZW2222($module) {$ZZZ2525 = array();if($module == 'InventoryToService') {} else {$ZZZa0 = PlatformConnector::ZZZb1($module);if(!$ZZZa0) {return false;} $ZZY2424 = $ZZZa0->getTableName();$ZZZc2 = $ZZZa0->getFieldDefinitions();foreach($ZZZc2 as $field) {if(!isset($field['vname'])) {continue;} $ZZZd3 = $this->ZZX2323($ZZY2424, $field);if($ZZZd3) {$ZZZ2525[] = $ZZZd3;}}} $ZZZe4 = ZZZf5::getInstance();$ZZZg6 = $ZZZe4->ZZZh7();if(isset($ZZZg6->enableCustomTables) && $ZZZg6->enableCustomTables) {ZZZi8::ZZZj9(ZZZk10::load('hooks', 'addCustomTable'));$ZZZ2525 = ZZZi8::ZZZl11($module, $ZZZ2525);} if($module == 'oqc_Service') {$ZZZ2525[] = array('tablename' => "oqc_service", 'columnname' => "quantity`*`#alias#`.`price", 'fieldname' => "netprice", 'fieldlabel' => "LBL_NET_PRICE", 'uitype' => 'float', 'typeofdata' => 'N~M',);} return $ZZZ2525;} function ZZZm12($ZZJ99) {global $moduleList;$moduleName = false;$ZZZn13 = false;list($ZZZo14, $ZZZp15) = explode("_", $ZZJ99, 2);foreach($moduleList as $ZZZq16) {$ZZZr17 = strlen($ZZZq16);$ZZZs18 = substr($ZZZp15, 0, $ZZZr17);if ($ZZZs18 == $ZZZq16) {$moduleName = $ZZZq16;$ZZZn13 = substr($ZZZp15, $ZZZr17 + 1);break;}} $r17 = array(0 => $ZZZo14, 1 => $moduleName, 2 => $ZZZn13,);return $r17;} function ZZZt19($field) {if(isset($field['id_name'])) {$field['columnname'] = $field['id_name'];} $ZZZu20 = false;if(isset($field['table'])) {$ZZZu20 = $field['table'];} $ZZZv21 = array('relation' => array('tablename' => $ZZZu20, 'entityidfield' => 'id',), 'field' => array($field), 'names' => array($field['columnname']),);return $ZZZv21;} function ZZZw22($module, $field = null){static $ZZZx23 = array();if($field && is_array($field)) {if(isset($field['rname']) || $field['uitype'] == 'name') {return $this->ZZZt19($field);}} if(!isset($ZZZx23[$module])){$ZZZy24 = $this->ZZW2222($module);foreach($ZZZy24 as $field) {if(isset($field['rname']) || $field['uitype'] == 'name') {$ZZS1818 = $this->ZZZt19($field);}} $ZZZx23[$module] = $ZZS1818;} return $ZZZx23[$module];} function ZZZz25($module){$ZZZA00 = array();$ZZZB11 = array('id' => '1', 'label' => '---', 'fields' => $this->ZZW2222($module),);$ZZZA00[] = $ZZZB11;return $ZZZA00;} function ZZZC22($query){$ZZS1818 = $this->run_query_allrecords($query);return $ZZS1818;} function ZZZD33($query){$ZZS1818 = $this->db->query($query);return $ZZS1818;} function ZZZE44($query,$ZZZF55,$ZZZG66 = null, $ZZx23 = false){$ZZZH77 = $this->ZZH77($query, $ZZZF55, $ZZx23);$ZZS1818 = $this->GetAll($ZZZH77);return $ZZS1818;} function ZZZI88($query,$ZZZF55, $ZZx23 = false){$ZZZH77 = $this->ZZH77($query,$ZZZF55, $ZZx23);return ($ZZZH77 !== false);} function ZZZJ99($ZZZK1010, $ZZZL1111, $ZZZM1212, $ZZZN1313) {if($ZZZL1111 == "PUB"){$ZZZL1111 = 1;if($ZZZM1212=="EDIT"){$ZZZM1212 = 1;}elseif($ZZZM1212=="DELETE"){$ZZZM1212 = 2;}else{$ZZZM1212 = 0;}}else{$ZZZL1111 = 0;$ZZZM1212 = 0;} $ZZq16 = "UPDATE `advancedreports` SET shared=?, sharedlevel=?, owner=? WHERE id = ?";$ZZZF55 = array($ZZZL1111, $ZZZM1212, $ZZZN1313, $ZZZK1010);$ZY2424 = $this->ZZH77($ZZq16,$ZZZF55);return $ZY2424;} function saveReport($id, $ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $ZZZg6, $ZZZR1717, $ZZZS1818,$ZZZL1111,$ZZZM1212,$ZZZN1313,$ZZZT1919,$ZZZU2020 = null){if($ZZZL1111 == "PUB"){$ZZZL1111 = 1;if($ZZZM1212=="EDIT"){$ZZZM1212 = 1;}elseif($ZZZM1212=="DELETE"){$ZZZM1212 = 2;}else{$ZZZM1212 = 0;}}else{$ZZZL1111 = 0;$ZZZM1212 = 0;} $ZZq16 = "UPDATE `advancedreports` SET fields=?, filters = ?, grouping = ?, aggregates = ?, totalAggregates = ?, options = ?, labels = ?, chart = ?, shared=?, sharedlevel=?, owner=?, calcFields=?";$ZZZF55 = array($ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $ZZZg6, $ZZZR1717, $ZZZS1818, $ZZZL1111, $ZZZM1212,$ZZZN1313,$ZZZT1919);if($ZZZU2020!=null){$ZZq16.= ", combinedfields=?";$ZZZF55[] = $ZZZU2020;} $ZZq16.= " WHERE id = ?";$ZZZF55[] = $id;$ZY2424 = $this->ZZH77($ZZq16,$ZZZF55,true);} function ZZZV2121($module, $ZZZW2222, $ZZZX2323, $ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $ZZZg6, $ZZZR1717, $title,$description,$ZZZS1818,$ZZZL1111,$ZZZM1212,$ZZZN1313,$ZZZT1919,$isCombined = 0, $ZZZY2424 = null){if($ZZZL1111 == "PUB"){$ZZZL1111 = 1;if($ZZZM1212=="EDIT"){$ZZZM1212 = 1;}elseif($ZZZM1212=="DELETE"){$ZZZM1212 = 2;}else{$ZZZM1212 = 0;}}else{$ZZZL1111 = 0;$ZZZM1212 = 0;} $ZZS1818 = $this->ZZH77("SELECT IFNULL(MAX(`sequence`) + 1, 0) AS `sequence` FROM `advancedreports` WHERE `category_id` = ? ", array($ZZZW2222));$ZZZZ2525 = $this->ZZI88($ZZS1818, 'sequence');$this->setDieOnError(true);$this->ZZH77("INSERT INTO `advancedreports`(`module`, `category_id`, `sequence`, `related_data`, `fields`, `filters`, `grouping`, `aggregates`, `totalAggregates`, `title`, `description`, `options`, `labels`, `chart`,`shared`,`sharedlevel`,`owner`,`iscombined`,`combinedfields`,`calcFields`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)", array($module, $ZZZW2222, $ZZZZ2525, $ZZZX2323,$ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $title, $description, $ZZZg6, $ZZZR1717, $ZZZS1818,$ZZZL1111,$ZZZM1212,$ZZZN1313,$isCombined,$ZZZY2424,$ZZZT1919));$ZZS1818 = $this->run_query_allrecords("SELECT last_insert_id() AS `id`");return $ZZS1818[0]['id'];} function loadReport($id){$ZZS1818 = null;$ZZS1818 = $this->run_query_allrecords("SELECT * FROM advancedreports WHERE id = ". (int)$id);if($ZZS1818){$ZZS1818 = $ZZS1818[0];$ZZS1818["related_data"] = json_decode($ZZS1818["related_data"],true);for($Zf5 = 0;$Zf5<count($ZZS1818['related_data']);$Zf5++){for($ZZZZa0 = 0;$ZZZZa0 <= 11;$ZZZZa0++) {if(!isset($ZZS1818["related_data"][$Zf5][$ZZZZa0])) {$ZZS1818["related_data"][$Zf5][$ZZZZa0] = false;}}}} return $ZZS1818;} function ZZZZb1($ZZZZc2="*", $ZZZZd3="", $limit=1){$query = "SELECT $ZZZZc2 FROM advancedreports";if(!empty($ZZZZd3)){$query .= " WHERE $ZZZZd3";} if((int)$limit>0){$query.= " LIMIT $limit";} $query.=";";$report = $this->run_query_allrecords($query);return $report;} function listReports($ZZZZe4,$ZZZZf5,$ZZZZg6,$ZZZW2222=null,$ZZZZh7=false){$ZZS1818 = null;$ZZZZi8 = " AND ";$ZZZZj9 = " `r`.`visible` = 1 ";if($ZZZZh7) {$ZZZZi8 = "";$ZZZZj9 = "";} $ZZZW2222 = (int) $ZZZW2222;if($ZZZZe4){$query = "SELECT r.*, 2 as `can_edit`, 1 as `can_delete` FROM advancedreports r WHERE `r`.`category_id` = ".$ZZZW2222." ".$ZZZZi8.$ZZZZj9." ORDER BY r.`sequence` ASC";}else{if(empty($ZZZZg6) || (count($ZZZZg6) == 1 && $ZZZZg6[0]=="")){$ZZZZg6 = array(-1);} $query = "SELECT r.* , `a`.`can_edit` as `can_edit`, `a`.`can_delete` as `can_delete` FROM advancedreports r LEFT JOIN (SELECT r2.`id` as id, COUNT(*) as 'cnt', IFNULL(IFNULL(SUM(`g`.`level`),0) +IFNULL(SUM(`u`.`level`),0) +IF(`r2`.`owner`='$ZZZZf5' OR `r2`.`sharedlevel`=1 ,1,0), 0) as `can_edit`, sum(IF(`u`.`level`=2,1,0)+ IF(`g`.`level`=2,1,0)+ IF(`r2`.`owner`='$ZZZZf5' OR `r2`.`sharedlevel`=2,1,0)) as `can_delete` FROM `advancedreports` `r2` LEFT JOIN `advancedreports_sharedusers` `u` on u.report_id = r2.id LEFT JOIN `advancedreports_sharedgroups` `g` on g.report_id = r2.id WHERE (r2.owner = '$ZZZZf5' OR u.user_id = '$ZZZZf5' OR g.group_id IN (". implode(",",$this->ZZK1010($ZZZZg6)).")) OR r2.shared = 1 GROUP BY r2.id) `a` ON `a`.`id` = `r`.`id` WHERE `a`.`cnt`>0 AND `r`.`category_id` = ".$ZZZW2222." ".$ZZZZi8.$ZZZZj9." ORDER BY r.`sequence` ASC";} $ZZS1818 = $this->run_query_allrecords($query);return $ZZS1818;} function ZZZZk10($id,$title,$description){$this->ZZH77("UPDATE `advancedreports` SET `title`=?, `description`=? WHERE `id` = ?", array($title, $description, $id));} function deleteReport($id){$this->ZZH77("DELETE FROM `advancedreports` WHERE `id` = ?", array($id));} function ZZZZl11($ZZq16){$ZZS1818 = $this->run_query_allrecords($ZZq16);return $ZZS1818;} function ZZZZm12($ZZZZn13, $ZZZZo14, $ZZZZp15){$ZZZZn13 = "CREATE OR REPLACE VIEW {$ZZZZp15} AS {$ZZZZn13}";$ZY2424 = $this->ZZH77($ZZZZn13, $ZZZZo14);return $ZY2424;} function ZZZZq16(){return $this->ZZZZl11("SELECT `id`, TRIM(CONCAT(IFNULL(`first_name`, ''), ' ', IFNULL(`last_name`, ''))) as `name` FROM `users` WHERE `status`='Active'");} function ZZZZr17($ZZZK1010){return $this->ZZZZl11("SELECT `user_id` as `id`, `level` FROM `advancedreports_sharedusers` WHERE `report_id`=$ZZZK1010");} function ZZZZs18($ZZZK1010){return $this->ZZZZl11("SELECT `user` as `user` FROM `advancedreports_schedule_u` WHERE `id`=$ZZZK1010");} function ZZZZt19($ZZZK1010){return $this->ZZZZl11("SELECT `group` as `group` FROM `advancedreports_schedule_g` WHERE `id`=$ZZZK1010");} function ZZZZu20($ZZZK1010){return $this->ZZZZl11("SELECT `role` as `role` FROM `advancedreports_schedule_r` WHERE `id`=$ZZZK1010");} function ZZZZv21($ZZZK1010){$ZY2424 = $this->ZZZZl11("SELECT `emails` FROM `advancedreports_schedule` WHERE `id`=$ZZZK1010");$ZZS1818 = "{}";if(isset($ZY2424[0]['emails'])){$ZZS1818 = $ZY2424[0]['emails'];} return json_decode($ZZS1818,true);} function ZZZZw22($ZZZZx23,$ZZZZy24,$ZZZZz25){$ZZS1818 = null;$ZZS1818 = $this->run_query_allrecords("SELECT r.relmodule AS `module` FROM vtiger_field f LEFT JOIN vtiger_fieldmodulerel r on r.fieldid=f.fieldid WHERE block = ". (int)$ZZZZz25." AND tablename = '$ZZZZx23' AND columnname = '$ZZZZy24'");return $ZZS1818;} function ZZZZA00($ZZZK1010){return $this->ZZZZl11("SELECT `group_id` as `id`, `level` FROM `advancedreports_sharedgroups` WHERE `report_id`=$ZZZK1010");} function ZZZZB11(){return $this->ZZZZl11("SELECT `groupid` as `id`, `groupname` as `name` FROM `vtiger_groups`");} function ZZZZC22(){return $this->ZZZZl11("SELECT `id`, `name` FROM `acl_roles`");} function ZZZZD33($ZZZZE44){$ZZZZF55 = array();$ZZZZG66 = $this->ZZZZl11("SELECT `user_id` FROM `acl_roles_users` WHERE `role_id` = '$ZZZZE44' AND `deleted` = 0 ");foreach($ZZZZG66 as $ZZZZf5){$ZZZZF55[] = $ZZZZf5['user_id'];} return $ZZZZF55;} function ZZZZH77($ZZZZf5,$ZZZZg6,$ZZZK1010){if(empty($ZZZZg6) || (count($ZZZZg6) == 1 && $ZZZZg6[0] == "")){$ZZZZg6 = array(-1);} $ZZq16 = "SELECT MAX(`level`) AS `level` FROM (SELECT `level` FROM `advancedreports_sharedgroups` WHERE `report_id` = $ZZZK1010 AND `group_id` IN (". implode(",",$this->ZZK1010($ZZZZg6)).") UNION ALL SELECT `level` FROM `advancedreports_sharedusers` WHERE `report_id` = $ZZZK1010 AND `user_id` = '$ZZZZf5' UNION ALL SELECT `sharedlevel` AS `level` FROM `advancedreports` WHERE `id` = $ZZZK1010 AND `shared` = 1) AS `lvl_tbl`";$ZZS1818 = $this->ZZZZl11($ZZq16);return $ZZS1818;} function ZZZZI88($report,$ZZZZJ99){$this->db->query("DELETE FROM advancedreports_sharedgroups WHERE report_id=$report");$ZZT1919 = count($ZZZZJ99);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_sharedgroups(`report_id`, `group_id`, `level`) VALUES(?,?,?)",$ZZZZJ99[$Zf5]);}} function ZZZZK1010($report,$ZZZZL1111){$this->db->query("DELETE FROM advancedreports_sharedusers WHERE report_id=$report");$ZZT1919 = count($ZZZZL1111);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_sharedusers(`report_id`, `user_id`, `level`) VALUES(?,?,?)",$ZZZZL1111[$Zf5]);}} function ZZZZM1212($report,$ZZZZJ99){$this->db->query("DELETE FROM advancedreports_schedule_g WHERE id=$report");$ZZT1919 = count($ZZZZJ99);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_schedule_g(`id`, `group`) VALUES(?,?)",array($report,$ZZZZJ99[$Zf5]));}} function ZZZZN1313($report,$ZZZZL1111){$this->db->query("DELETE FROM advancedreports_schedule_u WHERE id=$report");$ZZT1919 = count($ZZZZL1111);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_schedule_u(`id`, `user`) VALUES(?,?)",array($report,$ZZZZL1111[$Zf5]));}} function ZZZZO1414($report,$ZZZZP1515){$this->db->query("DELETE FROM advancedreports_schedule_r WHERE id=$report");$ZZT1919 = count($ZZZZP1515);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_schedule_r(`id`, `role`) VALUES(?,?)",array($report,$ZZZZP1515[$Zf5]));}} function ZZZZQ1616($ZZZZR1717="*", $ZZZZd3="", $ZZZZS1818="", $limit=""){$ZZq16 = "SELECT $ZZZZR1717 FROM `{$this->dbPrefix}advancedreports_categories`";if(!empty($ZZZZd3)){$ZZq16.=" WHERE {$ZZZZd3}";} if(!empty($ZZZZS1818)){$ZZq16.=" ORDER BY {$ZZZZS1818}";} if(!empty($limit)){$ZZq16.=" LIMIT {$limit}";} $ZZq16.=";";$ZZZZT1919 = $this->ZZZC22($ZZq16);return $ZZZZT1919;} function ZZZZU2020($ZZZZV2121){$ZZq16 = "SELECT MAX(`sequence`) FROM advancedreports WHERE category_id = {$ZZZZV2121['selectedCategory']}";$ZZZZ2525 = $this->ZZZC22($ZZq16);$ZZZZ2525 = $ZZZZ2525[0][0];if(empty($ZZZZ2525)){$ZZZZ2525 = 1;}else{$ZZZZ2525++;} $ZZZN1313 = $ZZZZV2121['owner'];$ZZZZW2222 = "";if($ZZZZV2121['customOptions']['enableCustomTables'] == 'true')$ZZZZW2222.=',"enableCustomTables":true';$ZZZg6 = "{\"includeDetails\":true,\"isCrosstab\":false,\"aggregateColumn\":false{$ZZZZW2222}}";$ZZq16 = "INSERT INTO `advancedreports`(`category_id`, `sequence`, `module`, `related_data`, `fields`, `filters`, `grouping`, `aggregates`, `totalAggregates`, `title`, `description`, `options`, `labels`, `chart`, `owner`, `shared`, `sharedlevel`, `iscombined`, `combinedfields`) VALUES ({$ZZZZV2121['selectedCategory']},{$ZZZZ2525},'{$ZZZZV2121['mainModuleName']}',{$ZZZZV2121['selectedModules']},'[]','[]','[]','[]','{}','{$ZZZZV2121['reportTitle']}','{$ZZZZV2121['reportDescription']}','{$ZZZg6}','{}','{\"chartTitle\":\"\",\"chartType\":\"pie\",\"chartLabels\":\"\",\"chartAxisX\":\"\",\"chartAxisY\":\"\",\"chartAxisY2\":\"\",\"chartYAxisType\":\"\",\"chartYAxis2Type\":\"\",\"chartLegend\":\"\",\"chartStacked\":false}','{$ZZZN1313}',0,0,{$ZZZZV2121['selectedReportType']},'{}');";$this->ZZZD33($ZZq16);$ZY2424 = $this->ZZZD33('SELECT last_insert_id()');list($ZZZZX2323) = $ZY2424->fetch_row();return $ZZZZX2323;} function ZZZZY2424(){return $this->ZZZZl11(" SELECT `lhs_module`, `join_table`, `rhs_module`, `join_key_lhs`, `join_key_rhs` FROM `relationships` WHERE `relationships`.`join_table` IS NOT NULL AND `relationships`.`deleted` = 0");} function ZZZZZ2525($ZZZZZa0, $Zu20, $value){$ZZZZZa0 = (int)$ZZZZZa0;if($ZZZZZa0 <= 0) return;if($Zu20 == "report") {$ZZq16 = "UPDATE `{$this->dbPrefix}advancedreports` SET `visible` = ? WHERE `id` = ? ";} else {$ZZq16 = "UPDATE `{$this->dbPrefix}advancedreports_categories` SET `visible` = ? WHERE `id` = ? ";$ZZZZZb1 = array();if($value == 1){$ZZZZZb1 = $this->ZZZZQ1616($ZZZZR1717="parent_id AS folder_id", $ZZZZd3="id={$ZZZZZa0}");}elseif($value == 0){$ZZZZZb1 = $this->ZZZZQ1616($ZZZZR1717="id AS folder_id", $ZZZZd3="parent_id={$ZZZZZa0}");} foreach($ZZZZZb1 as $ZZZZZc2){if($ZZZZZc2['folder_id'] ==0)continue;$this->ZZZZZ2525($ZZZZZc2['folder_id'], $Zu20, $value);}} $this->ZZH77($ZZq16, array($value, $ZZZZZa0));} function ZZZZZd3(){global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZe4 = $ZZZZZe4->ZZZZZg6($current_user);$ZZZZf5 = $ZZZZZe4->ZZZZZh7($current_user);$ZZZZg6 = $ZZZZZe4->getUserGroups($ZZZZf5);$ZZS1818 = null;$ZZZZi8 = " AND ";$ZZZZj9 = " `r`.`visible` = 1 ";if($ZZZZe4){$query = "SELECT r.*, 2 as `can_edit`, 1 as `can_delete` FROM advancedreports r WHERE ".$ZZZZj9." ORDER BY r.`sequence` ASC";}else{if(empty($ZZZZg6) || (count($ZZZZg6) == 1 && $ZZZZg6[0]=="")){$ZZZZg6 = array(-1);} $query = "SELECT r.* , `a`.`can_edit` as `can_edit`, `a`.`can_delete` as `can_delete` FROM advancedreports r LEFT JOIN (SELECT r2.`id` as id, COUNT(*) as 'cnt', IFNULL(IFNULL(SUM(`g`.`level`),0) +IFNULL(SUM(`u`.`level`),0) +IF(`r2`.`owner`='$ZZZZf5' OR `r2`.`sharedlevel`=1 ,1,0), 0) as `can_edit`, sum(IF(`u`.`level`=2,1,0)+ IF(`g`.`level`=2,1,0)+ IF(`r2`.`owner`='$ZZZZf5' OR `r2`.`sharedlevel`=2,1,0)) as `can_delete` FROM `advancedreports` `r2` LEFT JOIN `advancedreports_sharedusers` `u` on u.report_id = r2.id LEFT JOIN `advancedreports_sharedgroups` `g` on g.report_id = r2.id WHERE (r2.owner = '$ZZZZf5' OR u.user_id = '$ZZZZf5' OR g.group_id IN (". implode(",",$this->ZZK1010($ZZZZg6)).")) OR r2.shared = 1 GROUP BY r2.id) `a` ON `a`.`id` = `r`.`id` WHERE `a`.`cnt`>0 ".$ZZZZi8.$ZZZZj9." ORDER BY r.`sequence` ASC";} $ZZS1818 = $this->run_query_allrecords($query);return $ZZS1818;}} ;class ZZZZZf5{function ZZZZZh7($ZZZZZi8){return $ZZZZZi8->id;} function ZZZZZj9($ZZZZZi8){global $sugar_config;$ZZZZZk10 = '.';$ZZZZZl11 = ',';$ZZZZZm12 = $ZZZZZi8->getPreference('num_grp_sep');$ZZZZZn13 = $ZZZZZi8->getPreference('dec_sep');$ZZZZZo14 = $sugar_config['default_number_grouping_seperator'];$ZZZZZp15 = $sugar_config['default_decimal_seperator'];$ZZZZZm12 = isset($ZZZZZm12)? $ZZZZZm12:$ZZZZZo14;$ZZZZZn13 = isset($ZZZZZn13)? $ZZZZZn13:$ZZZZZp15;$ZZZZZm12 = isset($ZZZZZm12)? $ZZZZZm12:$ZZZZZk10;$ZZZZZn13 = isset($ZZZZZn13)? $ZZZZZn13:$ZZZZZl11;$ZZS1818 = array('format' => "123,456,789" , 'seperator' => $ZZZZZm12, 'decimal' => $ZZZZZn13);return $ZZS1818;} function ZZZZZq16($ZZZZZi8){$ZZZZZr17 = $ZZZZZi8->getUserDateTimePreferences();$ZZZZZr17['date'];$ZZZZZr17['time'];$ZZZZZr17['userGmt'];$ZZZZZr17['userGmtOffset'];return 'mm-dd-yyyy';} function ZZZZZs18(){echo "RECORD is not ACCESSIBLE";} function ZZZZZg6($ZZZZZi8){return is_admin($ZZZZZi8);} function getUserGroups($ZZZZf5){include_once "modules/ACLRoles/ACLRole.php";$ZZZZP1515 = ACLRole::getUserRoles($ZZZZf5, false);$ZZS1818 = array();foreach ($ZZZZP1515 as $Zu20 => $value) {$ZZS1818[] = $value->id;} return $ZZS1818;} function ZZZZZt19($ZZZZZu20){return array();return $ZZS1818;} function getRoleUsers($ZZZZE44, ZZp15 $db){$ZZZZZv21 = $db->ZZZZD33($ZZZZE44);return $ZZZZZv21;} function ZZZZZw22($ZZZZZx23,$module = ""){if(in_array($module,array("Inventory","Inventory2"))){$module = "SalesOrder";}elseif($module == "Events"){$module = "Calendar";if(in_array($ZZZZZx23,array("LBL_DURATION_H" ,"LBL_DURATION_DAY"))){$module = "AnalyticReporting";}}elseif(in_array($module,array("CampaignAcc","CampaignCont","CampaignLead"))){$module = "Campaigns";}elseif($module == "Leads" && $ZZZZZx23 == "LBL_LEAD_CONVERTED"){$module = "AnalyticReporting";} $ZZS1818 = translate($ZZZZZx23, $module);return $ZZS1818;} function ZZZZZy24($name,$module,ZZp15 $db){$ZZZZZz25 = $db->ZZN1313($name, $module);return $ZZZZZz25;} function ZZZZZA00($name,$module,ZZp15 $db){$ZZS1818 = array(1 =>	$this->ZZZZZw22("--None--",$module), 2 =>	$this->ZZZZZw22("Contacted - Successful",$module), 3 =>	$this->ZZZZZw22("Contacted - Unsuccessful",$module), 4 =>	$this->ZZZZZw22("Contacted - Never Contact Again",$module),);return $ZZS1818;} function ZZZZZB11($module){$ZZZZZC22 = $this->ZZZb1($module);return array('name'=>$ZZZZZC22->table_name,'idCol'=> 'id');} function ZZZZZD33($module){$ZZS1818 = null;if($module ==="Calendar" || $module ==="Activity" || $module ==="Events"){include_once "modules/Calendar/Activity.php";$ZZS1818 = new Activity();}elseif($module ==="Inventory"){$ZZS1818 = array('tab_name_index' => array('vtiger_inventoryproductrel'=>'lineitem_id'), 'table_name' => 'vtiger_inventoryproductrel', 'table_index' => 'lineitem_id');}elseif($module ==="Inventory2"){$ZZS1818 = array('tab_name_index' => array('vtiger_inventoryproductrel'=>'lineitem_id'), 'table_name' => 'vtiger_inventoryproductrel', 'table_index' => 'lineitem_id');}elseif($module == "CampaignAcc"){$ZZS1818 = array('tab_name_index' => array('vtiger_campaignaccountrel'=>'accountid'), 'table_name' => 'vtiger_campaignaccountrel', 'table_index' => 'accountid');}elseif($module == "CampaignCont"){$ZZS1818 = array('tab_name_index' => array('vtiger_campaigncontrel'=>'contactid'), 'table_name' => 'vtiger_campaigncontrel', 'table_index' => 'contactid');}elseif($module == "CampaignLead"){$ZZS1818 = array('tab_name_index' => array('vtiger_campaignleadrel'=>'leadid'), 'table_name' => 'vtiger_campaignleadrel', 'table_index' => 'leadid');} return ($ZZS1818)? ((object) $ZZS1818): ($ZZS1818);} function ZZZb1($module){$ZZZZZC22 = $this->ZZZZZD33($module);if(!$ZZZZZC22){$ZZZZZC22 = PlatformConnector::ZZZb1($module);} return $ZZZZZC22;} function ZZZZZE44($module){$ZZZZZC22 = $this->ZZZb1($module);$ZZS1818 = array();$ZZZZZF55 = 'id';$ZZS1818[] = array('name' => $ZZZZZC22->table_name, 'idCol' => $ZZZZZF55);$ZZS1818[] = array('name' => $ZZZZZC22->table_name."_cstm", 'idCol' => $ZZZZZF55."_c");return $ZZS1818;} function ZZZZZG66($field,$db){$ZZS1818 = array();$ZZZH77 = $db->ZZZZw22($field['tablename'],$field['columnname'],$field['block']);foreach($ZZZH77 as $ZZZZZH77){$ZZS1818[] = $ZZZZZH77["module"];} return $ZZS1818;} function ZZZZZI88($field,$db,$ZZZZZJ99,$module = false){$ZZS1818 = false;if($field['fieldname']=="00_ALL_assigned_user_id"){return false;} if($this->ZZZZZK1010($field)){$ZZS1818 = true;}else{$module = ($module)?($module):($ZZZZZJ99[$field['module']]->name);if($module == 'oqc_Service') {return false;} $ZZZZZL1111 = $db->ZZZw22($module,$field);if(!empty($ZZZZZL1111["field"])){$ZZZZZM1212 = array_search($field['fieldname'],$ZZZZZL1111["names"]);$ZZZZZN1313 = array_search($field['fieldname_org'],$ZZZZZL1111["names"]);if($ZZZZZM1212!==false || $ZZZZZN1313!==false){$ZZS1818 = true;}}} return $ZZS1818;} function ZZZZZO1414($field){$ZZS1818 = false;if(in_array($field["uitype"], array('int', 'currency', 'number', 'float'))){$ZZS1818 = true;} return $ZZS1818;} function ZZZZZP1515($field){$ZZS1818 = false;if(in_array($field["uitype"],array('datetime', 'datetimecombo'))){$ZZS1818 = true;} return $ZZS1818;} function ZZZZZK1010($field){if(isset($field['uitype']) && in_array($field['uitype'], array('relate', 'assigned_user_name'))) {return true;} return false;} function ZZZZZQ1616($ZZZZZR1717){$ZZZZZS1818 = array(1 => "Jan", 2 => "Feb", 3 => "Mar", 4 => "Apr", 5 => "May", 6 => "Jun", 7 => "Jul", 8 => "Aug", 9 => "Sep", 10=> "Oct", 11=> "Nov", 12=> "Dec",);return $ZZZZZS1818[$ZZZZZR1717];} function ZZZZZT1919($ZZZc2, $ZZZO1414 = false){$ZZS1818 = array();$ZZT1919 = count($ZZZc2);if($ZZZc2[$ZZT1919-1] == "-"){array_pop($ZZZc2);$ZZT1919--;} for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZc2[$Zf5]["fieldname"]] = $ZZZc2[$Zf5];} $ZZZZZU2020 = count($ZZZO1414);$ZZZZZV2121 = array();for($ZZZZZW2222 = 0;$ZZZZZW2222 < $ZZZZZU2020;$ZZZZZW2222++) {if(isset($ZZZO1414[$ZZZZZW2222]["dateGrouping"]) && !empty($ZZZO1414[$ZZZZZW2222]["dateGrouping"])) {$ZZZZZX2323 = $ZZZO1414[$ZZZZZW2222]["name"] . '_' . $ZZZO1414[$ZZZZZW2222]["dateGrouping"];$ZZZZZV2121[$ZZZZZX2323] = $ZZZO1414[$ZZZZZW2222]["dateGrouping"];}} if(isset($ZZZZZV2121)) {for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(isset($ZZZc2[$Zf5]["dateGrouping"]) && !empty($ZZZc2[$Zf5]["dateGrouping"])) {if($ZZZZZV2121[$ZZZc2[$Zf5]["fieldname"]]) {foreach($ZZZZZV2121 as $ZZZZZY2424 => $ZZZZZZ2525) {$ZZZZZZa0 = $ZZZc2[$Zf5];$ZZZZZZa0["fieldname"] = $ZZZZZY2424;$ZZZZZZa0["dateGrouping"] = $ZZZZZZ2525;$ZZS1818[$ZZZZZY2424] = $ZZZZZZa0;}}}}} return $ZZS1818;} function ZZZZZZb1($ZZZZZZc2, $ZZZZZZd3){$ZZZZZZe4 = array();foreach ($ZZZZZZc2 as $report) {$ZZZZZZf5 = array('name' => $report['id'], 'title' => $report['title'],);if($ZZZZZZd3 == $report['id']){$ZZZZZZf5['title'] = "Current";array_unshift($ZZZZZZe4, $ZZZZZZf5);continue;} $ZZZZZZe4[] = $ZZZZZZf5;} return $ZZZZZZe4;} function ZZZZZZg6($G66=array(), $ZZZZZZh7=""){foreach ($G66 as $ZZZZZZi8 => $value) {$G66[$ZZZZZZi8] = "{$ZZZZZZh7}".$value."{$ZZZZZZh7}";} return $G66;}}
;class PlatformConnector {static private $ZZZZZZj9 = null;public static function ZZZZZZk10($moduleName){$ZZZa0 = self::ZZZb1($moduleName);$ZZY2424 = $ZZZa0->table_name;return $ZZY2424;} public static function ZZZZZZl11() {$ZZZZZZm12 = array('AnalyticReporting');$ZZZZZZn13 = array('AOS_Products_Quotes', 'EmailAddresses', 'ProjectTask', 'Users', 'CampaignLog', 'EmailMarketing', 'CampaignTrackers');$moduleList = array_intersect($GLOBALS['moduleList'],array_keys($GLOBALS['beanList']));foreach($ZZZZZZm12 as $module){if($Zu20=array_search($module, $moduleList)) unset($moduleList[$Zu20]);} foreach ($ZZZZZZn13 as $ZZZZZZi8 => $ZZZZZZo14) {if(isset($GLOBALS['beanList'][$ZZZZZZo14]) && !in_array($ZZZZZZo14, $moduleList)){$moduleList[] = $ZZZZZZo14;}} return $moduleList;} public static function ZZZb1($moduleName) {return FunctionWrapper::_getBean($moduleName);} public static function ZZZZZg6($ZZZZZi8) {if(is_admin($ZZZZZi8))return true;return false;} public static function getSystemUser($ZZZZf5 = null) {global $current_user;$ZZZZZZp15 = $current_user;if($current_user->id != $ZZZZf5) {$ZZZZZZp15 = new User();$ZZZZZZp15 = $ZZZZZZp15->retrieve($ZZZZf5);} return $ZZZZZZp15;} public static function ZZZZZZq16($ZZZZf5 = null) {global $current_user;if(!$ZZZZf5) {global $current_user;$ZZZZZi8 = $current_user;} else {$ZZZZZi8 = new User();$ZZZZZi8 = $ZZZZZi8->retrieve($ZZZZf5);} return self::ZZZZZZr17($ZZZZZi8);} public static function getAdminUser() {include_once "modules/Users/User.php";$ZZZZZi8 = new User();return self::ZZZZZZr17($ZZZZZi8->getSystemUser());} public static function ZZZZZZr17(User $ZZZZZi8) {$ZZZZZZs18 = 24;if (strpos($ZZZZZi8->getPreference('timef'), 'H') === false) {$ZZZZZZs18 = 12;} global $sugar_config;$ZZZZZZt19 = '.';$ZZZZZl11 = ',';$ZZZZZZu20 = 2;$ZZZZZZv21 = $ZZZZZi8->getPreference('num_grp_sep');$ZZZZZn13 = $ZZZZZi8->getPreference('dec_sep');$ZZZZZZw22 = $ZZZZZi8->getPreference('default_currency_significant_digits');$ZZZZZZx23 = $sugar_config['default_number_grouping_seperator'];$ZZZZZp15 = $sugar_config['default_decimal_seperator'];$ZZZZZZy24 = $sugar_config['default_currency_significant_digits'];$ZZZZZZv21 = isset($ZZZZZZv21)? $ZZZZZZv21:$ZZZZZZx23;$ZZZZZn13 = isset($ZZZZZn13)? $ZZZZZn13:$ZZZZZp15;$ZZZZZZw22 = isset($ZZZZZZw22)? $ZZZZZZw22:$ZZZZZZy24;$ZZZZZZv21 = isset($ZZZZZZv21)? $ZZZZZZv21:$ZZZZZZt19;$ZZZZZn13 = isset($ZZZZZn13)? $ZZZZZn13:$ZZZZZl11;$ZZZZZZw22 = isset($ZZZZZZw22)? $ZZZZZZw22:$ZZZZZZu20;$numberPreferences = array('format' => "123,456,789" , 'separator' => $ZZZZZZv21, 'decimal' => $ZZZZZn13, 'currencySignificantDigits' => $ZZZZZZw22);$ZZZF55 = array('id' => $ZZZZZi8->id, 'numberPreferences' => array('format' => $numberPreferences['format'], 'seperator' => $numberPreferences['separator'], 'decimal' => $numberPreferences['decimal'], 'currencySignificantDigits' => $numberPreferences['currencySignificantDigits'],), 'hourFormat' => $ZZZZZZs18, 'dateFormat' => "yyyy-mm-dd", 'timeZone' => TimeDate::userTimezone($ZZZZZi8), 'isAdmin' => is_admin($ZZZZZi8), 'email' => $ZZZZZi8->emailAddress->getPrimaryAddress($ZZZZZi8), 'name' => $ZZZZZi8->full_name, 'roleIds' => array(),);return new ARUser($ZZZF55);} public static function ZZZZZZz25($ZZZZZZA00){$ZZZZZZB11 = array();foreach ($ZZZZZZA00 as $ZZZZZZC22) {$ZZZZZZB11[$ZZZZZZC22['lhs_module']][] = array('tableName' => $ZZZZZZC22['join_table'], 'applicableModules' => array(0 => $ZZZZZZC22['rhs_module']), 'relModule' => false, 'columns' => array(0 => array('name' => $ZZZZZZC22['join_key_lhs'], 'title' => $ZZZZZZC22['join_key_lhs']), 1 => array('name' => $ZZZZZZC22['join_key_rhs'], 'title' => $ZZZZZZC22['join_key_rhs'])));} return $ZZZZZZB11;} public static function ZZZZZZD33(){if(!isset(self::$ZZZZZZj9)){self::$ZZZZZZj9 = new ZZp15(DBManagerFactory::getInstance());} return self::$ZZZZZZj9;} public static function ZZZZZZE44($ZZZZZZF55) {foreach($ZZZZZZF55 as &$ZZZZZZG66) {if(is_string($ZZZZZZG66)) {$ZZZZZZG66 = str_replace('"00_', '"m00_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"0_', '"m0_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"1_', '"m1_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"2_', '"m2_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"3_', '"m3_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"4_', '"m4_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"5_', '"m5_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"6_', '"m6_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"7_', '"m7_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"8_', '"m8_', $ZZZZZZG66);$ZZZZZZG66 = str_replace('"9_', '"m9_', $ZZZZZZG66);}} return $ZZZZZZF55;} public static function ZZZZZZH77() {$adb = DBManagerFactory::getInstance();return new ZZp15($adb);} public static function ZZZZZZI88() {if(DBManagerFactory::getInstance()->dbType == "mysql") {return "mysql";} else {return "mssql";}} public static function getUrl($S1818 = "") {$ZU2020 = SugarConfig::getInstance();$ZZZZZZJ99 = $ZU2020->get('site_url');$ZZZZZZi8 = "/index.php";if (PlatformConnector::ZZZZZZK1010()) {$ZZZZZZi8 = "/#bwc/index.php";} $ZZZZZZJ99 .= $ZZZZZZi8;if(!empty($S1818)){$ZZZZZZJ99 .= $S1818;} return $ZZZZZZJ99;} public static function ZZZZZZK1010(){global $sugar_version;if (version_compare($sugar_version, '7.0.0') >= 0) {return true;} return false;} public static function ZZZZZZL1111(){global $current_user;$ZZZZZi8 = $current_user;global $sugar_config;$ZZZZZZu20 = 2;$ZZZZZZw22 = $ZZZZZi8->getPreference('default_currency_significant_digits');$ZZZZZZy24 = $sugar_config['default_currency_significant_digits'];$ZZZZZZw22 = isset($ZZZZZZw22)? $ZZZZZZw22:$ZZZZZZy24;$ZZZZZZw22 = isset($ZZZZZZw22)? $ZZZZZZw22:$ZZZZZZu20;return $ZZZZZZw22;} public static function ZZZZZZM1212(ARUser $ZZZZZi8, $value){global $timedate;if(empty($value)){return $value;} $value = self::ZZZZZZN1313($ZZZZZi8, $value);return $timedate->getDatePart($value);} public static function ZZZZZZN1313(ARUser $ZZZZZi8, $value){global $timedate;$ZZZZZZp15 = PlatformConnector::getSystemUser($ZZZZZi8->ZZZZZZO1414());$ZZZZZZP1515 = $timedate->fromDb($value, true);if(empty($ZZZZZZP1515)){return $value;} $ZZZZZZQ1616 = $timedate->tzUser($ZZZZZZP1515, $ZZZZZZp15);return $ZZZZZZQ1616->asDb(false);} public static function getDate($ZZZZZi8, $value){global $timedate;$value = self::ZZZZZZR1717($ZZZZZi8, $value);return $timedate->getDatePart($value);} public static function ZZZZZZR1717($ZZZZZi8, $value){global $timedate;$ZZZZZZQ1616 = $timedate->fromDb($value, true);return $ZZZZZZQ1616->asDb(true);} public static function ZZZZZZS1818(ARUser $ZZZZZi8, $value) {global $timedate;if(empty($value)){return $value;} $ZZZZZZp15 = PlatformConnector::getSystemUser($ZZZZZi8->ZZZZZZO1414());$ZZZZZZT1919 = $timedate->fromString($value);$ZZZZZZQ1616 = $timedate->tzUser($ZZZZZZT1919, $ZZZZZZp15);return $ZZZZZZQ1616->asDb(true);} public static function ZZZZZZU2020(ARUser $ZZZZZi8) {global $timedate;$ZZZZZZp15 = PlatformConnector::getSystemUser($ZZZZZi8->ZZZZZZO1414());$ZZZZZZV2121 = $timedate->getNow();$ZZZZZZQ1616 = $timedate->tzUser($ZZZZZZV2121, $ZZZZZZp15);return $ZZZZZZQ1616->get_day_begin()->asDb(true);} public static function ZZZZZZW2222(ARUser $ZZZZZi8) {global $timedate;$ZZZZZZp15 = PlatformConnector::getSystemUser($ZZZZZi8->ZZZZZZO1414());$ZZZZZZV2121 = $timedate->getNow();$ZZZZZZQ1616 = $timedate->tzUser($ZZZZZZV2121, $ZZZZZZp15);return $ZZZZZZQ1616->get_day_end()->asDb(true);} public static function ZZZZZZX2323(ARUser $ZZZZZi8, $ZZZZZZY2424 = false) {global $timedate;$ZZZZZZp15 = PlatformConnector::getSystemUser($ZZZZZi8->ZZZZZZO1414());$value = $ZZZZZZp15->getPreference('timezone', 'global');if (!$value) {$value = $timedate->guessTimezone();} if (!$value) {$value = 'UTC';} return $value;} public static function ZZZZZZZ2525($name = "UTC") {$ZZZZZZZa0 = new DateTimeZone($name);$ZZZZZZV2121 = new DateTime("now", $ZZZZZZZa0);return $ZZZZZZV2121->format("P");}}
;abstract class ZZZZZZZb1 {protected $db;function __construct() {$this->db = PlatformConnector::ZZZZZZH77();}}
;class ZZZZZZZc2 extends ZZZZZZZb1
{function ZZZZZZZd3($ZZZW2222, $ZZZZh7) {$ZZZZZZZe4 = " AND visible = 1 ";if($ZZZZh7) {$ZZZZZZZe4 = "";} $ZZn13 = $this->db->ZZZC22("SELECT COUNT(*) AS count FROM {$this->db->dbPrefix}advancedreports WHERE category_id = ". (int)$ZZZW2222 . " " . $ZZZZZZZe4);return $ZZn13[0]['count'];} function ZZZZZZZf5($limit) {$ZZZH77 = $this->db->run_query_allrecords("SELECT id, options FROM {$this->db->dbPrefix}advancedreports WHERE options LIKE '%limit%'");$ZZZZZZZg6 = count($ZZZH77);for($Zf5=0;$Zf5 < $ZZZZZZZg6;$Zf5++){$ZZZg6 = json_decode($ZZZH77[$Zf5]['options'], true);$ZZZg6['limit'] = $limit;$ZZZg6 = json_encode($ZZZg6);$this->db->ZZH77("UPDATE {$this->db->dbPrefix}advancedreports SET options = ? WHERE id = ? ", array($ZZZg6, $ZZZH77[$Zf5]['id']));}} function ZZZZZZZh7(array $ZZZZZZZi8) {$ZZZZZZc2 = $this->db->run_query_allrecords("SELECT id, columnstate FROM {$this->db->dbPrefix}advancedreports");$ZZZZZZZj9 = count($ZZZZZZc2);for($Zf5=0;$Zf5<$ZZZZZZZj9;$Zf5++){$ZZZZZZZk10 = array();if($ZZZZZZc2[$Zf5]['columnstate'] !== NULL){$ZZZZZZZk10 = json_decode($ZZZZZZc2[$Zf5]['columnstate'], true);} $ZZZZZZZk10['sectionStates'] = $ZZZZZZZi8;$ZZZZZZZk10 = json_encode($ZZZZZZZk10);$this->db->ZZH77("UPDATE {$this->db->dbPrefix}advancedreports SET columnstate = ? WHERE id = ?", array($ZZZZZZZk10,$ZZZZZZc2[$Zf5]['id']));}} function ZZZZZd3(ARUser $ZZZZZi8) {$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZl11 = $ZZZZZe4->getUserGroups($ZZZZZi8->ZZZZZZO1414());if(empty($ZZZZZZZl11)){$ZZZZZZZl11 = array(-1);} $query = "SELECT r.*, a.can_edit as can_edit, a.can_delete as can_delete". " FROM {$this->db->dbPrefix}advancedreports r LEFT JOIN (SELECT r2.id as id, COUNT(*) as 'cnt', COALESCE(COALESCE(SUM(g.level),0) +COALESCE(SUM(u.level),0) +".ZZZZZZZm12::ZZZZZZZn13("r2.owner='{$ZZZZZi8->ZZZZZZO1414()}' OR r2.sharedlevel=1", 1, 0).", 0) as can_edit, sum(". ZZZZZZZm12::ZZZZZZZn13('u.level=2', 1, 0)."+". ZZZZZZZm12::ZZZZZZZn13('g.level=2', 1, 0)."+". ZZZZZZZm12::ZZZZZZZn13("r2.owner='{$ZZZZZi8->ZZZZZZO1414()}' OR r2.sharedlevel=1", 1, 0). ") as can_delete FROM {$this->db->dbPrefix}advancedreports r2 LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedusers u on u.report_id = r2.id LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedgroups g on g.report_id = r2.id WHERE (r2.owner = '{$ZZZZZi8->ZZZZZZO1414()}}' OR u.user_id = '{$ZZZZZi8->ZZZZZZO1414()}}' OR g.group_id IN (". implode(",",$this->db->ZZK1010($ZZZZZZZl11)).")) OR r2.shared = 1 GROUP BY r2.id, r2.sharedlevel, r2.owner) a ON a.id = r.id WHERE a.cnt>0";if($ZZZZZi8->ZZZZZg6()){$query = "SELECT r.* FROM {$this->db->dbPrefix}advancedreports r";} $report = $this->db->run_query_allrecords($query);return $report;} function listReports($ZZZZe4,$ZZZZf5,$ZZZZg6,$ZZZW2222=null,$ZZZZh7=false, $ZZZZZZZo14=false, $ZZZZZZZp15=false){$ZZS1818 = null;$ZZZZi8 = " AND ";$ZZZZj9 = " r.visible = 1 ";if($ZZZZh7) {$ZZZZi8 = "";$ZZZZj9 = "";} $ZZZZZZZq16 = "";if($ZZZW2222 != "#"){$ZZZZZZZq16 = " AND r.category_id = ". (int) $ZZZW2222;} $ZZZZZZZr17 = "";$ZZZZZZZs18 = "";$ZZZZS1818 = " ORDER BY r.sequence ASC";$ZZZZZZZt19 = "";if($ZZZZZZZo14){$ZZZZZZZs18 = ", 0";if($ZZZZZZZo14){global $mod_strings;$ZZZZZZZu20 = "/(".implode("|", $ZZZZZZZo14).")/i";$ZZZZZZZv21 = preg_grep($ZZZZZZZu20, $mod_strings);foreach ($ZZZZZZZv21 as $Zu20 => $value) {if($Zu20 != $value){$ZZZZZZZs18.= " +(CASE WHEN r.title LIKE '".$Zu20."' THEN 1 ELSE 0 END)";$ZZZZZZZr17.= " OR r.title LIKE '".$Zu20."'";}}} $ZZZZZZZt19 = " AND (1=2";$ZZZZZZZw22 = " OR ";if($ZZZZZZZp15){$ZZZZZZZt19 = " AND (1=1";$ZZZZZZZw22 = " AND ";} $ZZZZS1818 = " ORDER BY relevance DESC";foreach ($ZZZZZZZo14 as $ZZZZZZZx23) {$ZZZZZZZs18.= " +(CASE WHEN r.title LIKE '%".$ZZZZZZZx23."%' THEN 1 ELSE 0 END)";$ZZZZZZZs18.= " +(CASE WHEN r.description LIKE '%".$ZZZZZZZx23."%' THEN 1 ELSE 0 END)";$ZZZZZZZt19.= $ZZZZZZZw22."((r.title LIKE '%".$ZZZZZZZx23."%') OR (r.description LIKE '%".$ZZZZZZZx23."%'))";} $ZZZZZZZs18.= " as relevance";$ZZZZZZZt19.= ")";} if($ZZZZe4){$query = "SELECT r.*, 2 as can_edit, 1 as can_delete".$ZZZZZZZs18." FROM {$this->db->dbPrefix}advancedreports r WHERE 1=1".$ZZZZZZZq16.$ZZZZZZZt19.$ZZZZZZZr17.$ZZZZi8.$ZZZZj9.$ZZZZS1818;}else{if(empty($ZZZZg6) || (count($ZZZZg6) == 1 && $ZZZZg6[0]=="")){$ZZZZg6 = array(-1);} $query = "SELECT r.* , a.can_edit as can_edit, a.can_delete as can_delete".$ZZZZZZZs18. " FROM {$this->db->dbPrefix}advancedreports r LEFT JOIN (SELECT r2.id as id, COUNT(*) as 'cnt', COALESCE(COALESCE(SUM(g.level),0) +COALESCE(SUM(u.level),0) +".ZZZZZZZm12::ZZZZZZZn13("r2.owner='{$ZZZZf5}' OR r2.sharedlevel=1", 1, 0).", 0) as can_edit, sum(". ZZZZZZZm12::ZZZZZZZn13('u.level=2', 1, 0)."+". ZZZZZZZm12::ZZZZZZZn13('g.level=2', 1, 0)."+". ZZZZZZZm12::ZZZZZZZn13("r2.owner='{$ZZZZf5}' OR r2.sharedlevel=1", 1, 0). ") as can_delete FROM {$this->db->dbPrefix}advancedreports r2 LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedusers u on u.report_id = r2.id LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedgroups g on g.report_id = r2.id WHERE (r2.owner = '$ZZZZf5' OR u.user_id = '$ZZZZf5' OR g.group_id IN (". implode(",",$this->db->ZZK1010($ZZZZg6)).")) OR r2.shared = 1 GROUP BY r2.id, r2.sharedlevel, r2.owner) a ON a.id = r.id WHERE a.cnt>0". $ZZZZZZZq16. $ZZZZZZZt19. $ZZZZZZZr17. $ZZZZi8.$ZZZZj9. $ZZZZS1818;} $ZZS1818 = $this->db->run_query_allrecords($query);return $ZZS1818;} function ZZZJ99($ZZZK1010, $ZZZL1111, $ZZZM1212, $ZZZN1313) {if($ZZZL1111 == "PUB"){$ZZZL1111 = 1;if($ZZZM1212=="EDIT"){$ZZZM1212 = 1;}elseif($ZZZM1212=="DELETE"){$ZZZM1212 = 2;}else{$ZZZM1212 = 0;}}else{$ZZZL1111 = 0;$ZZZM1212 = 0;} $ZZq16 = "UPDATE {$this->db->dbPrefix}advancedreports SET shared=?, sharedlevel=?, owner=? WHERE id = ?";$ZZZF55 = array($ZZZL1111, $ZZZM1212, $ZZZN1313, $ZZZK1010);$ZY2424 = $this->db->ZZH77($ZZq16,$ZZZF55);return $ZY2424;} function saveReport($id, $ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $ZZZg6, $ZZZR1717, $ZZZS1818,$ZZZL1111,$ZZZM1212,$ZZZN1313,$ZZZT1919,$ZZZU2020 = null, $ZZZZZZZk10){if($ZZZL1111 == "PUB"){$ZZZL1111 = 1;if($ZZZM1212=="EDIT"){$ZZZM1212 = 1;}elseif($ZZZM1212=="DELETE"){$ZZZM1212 = 2;}else{$ZZZM1212 = 0;}}else{$ZZZL1111 = 0;$ZZZM1212 = 0;} $ZZq16 = "UPDATE {$this->db->dbPrefix}advancedreports SET fields=".ZZZZZZZm12::ZZZZZZZy24($ZZZc2).", filters = ".ZZZZZZZm12::ZZZZZZZy24($filters).", grouping = ".ZZZZZZZm12::ZZZZZZZy24($ZZZO1414).", aggregates = ".ZZZZZZZm12::ZZZZZZZy24($ZZZP1515).", totalAggregates = ".ZZZZZZZm12::ZZZZZZZy24($ZZZQ1616).", options = ".ZZZZZZZm12::ZZZZZZZy24($ZZZg6).", labels = ".ZZZZZZZm12::ZZZZZZZy24($ZZZR1717).", chart = ".ZZZZZZZm12::ZZZZZZZy24($ZZZS1818).", shared=?, sharedlevel=?, owner=?, calcFields= ".ZZZZZZZm12::ZZZZZZZy24($ZZZT1919).", columnstate = ".ZZZZZZZm12::ZZZZZZZy24($ZZZZZZZk10);$ZZZF55 = array($ZZZL1111, $ZZZM1212, $ZZZN1313,);if($ZZZU2020!=null){$ZZq16.= ", combinedfields=".ZZZZZZZm12::ZZZZZZZy24($ZZZU2020);} $ZZq16.= " WHERE id = ?";$ZZZF55[] = $id;$ZY2424 = $this->db->ZZH77($ZZq16,$ZZZF55,true);} function ZZZV2121($module, $ZZZW2222, $ZZZX2323, $ZZZc2, $filters, $ZZZO1414, $ZZZP1515, $ZZZQ1616, $ZZZg6, $ZZZR1717, $title,$description,$ZZZS1818,$ZZZL1111,$ZZZM1212,$ZZZN1313,$ZZZT1919,$isCombined = 0, $ZZZY2424 = null, $ZZZZZZZk10){if($ZZZL1111 == "PUB"){$ZZZL1111 = 1;if($ZZZM1212=="EDIT"){$ZZZM1212 = 1;}elseif($ZZZM1212=="DELETE"){$ZZZM1212 = 2;}else{$ZZZM1212 = 0;}}else{$ZZZL1111 = 0;$ZZZM1212 = 0;} $ZZS1818 = $this->db->ZZH77("SELECT COALESCE(MAX(sequence) + 1, 0) AS sequence FROM {$this->db->dbPrefix}advancedreports WHERE category_id = ? ", array($ZZZW2222));$ZZZZ2525 = $this->db->ZZI88($ZZS1818, 'sequence');$ZZq16 = "INSERT INTO {$this->db->dbPrefix}advancedreports (module, category_id, sequence, related_data, fields, filters, grouping, aggregates, totalAggregates, title, description, options, labels, chart, shared, sharedlevel, owner, iscombined, combinedfields, calcFields, columnstate) VALUES (?, ?, ?, ".ZZZZZZZm12::ZZZZZZZy24($ZZZX2323).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZc2).", ".ZZZZZZZm12::ZZZZZZZy24($filters).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZO1414).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZP1515).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZQ1616).", ?, ?, ".ZZZZZZZm12::ZZZZZZZy24($ZZZg6).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZR1717).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZS1818).", ?, ?, ?, ?, ".ZZZZZZZm12::ZZZZZZZy24($ZZZY2424).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZT1919).", ".ZZZZZZZm12::ZZZZZZZy24($ZZZZZZZk10).")";$ZZZF55 = array($module, $ZZZW2222, $ZZZZ2525, $title, $description, $ZZZL1111, $ZZZM1212, $ZZZN1313, $isCombined,);$this->db->setDieOnError(true);$this->db->ZZH77($ZZq16, $ZZZF55);$ZZS1818 = $this->db->run_query_allrecords("SELECT ".ZZZZZZZm12::ZZZZZZZz25()." AS id");return $ZZS1818[0]['id'];} function ZZZZZZZA00($ZZZZZZZB11 = array(), $id = 0) {$id = (int)$id;if($id <= 0){return;} $ZZq16 = "";foreach ($ZZZZZZZB11 as $Zu20 => $value) {switch ($Zu20){case 'related_data': case 'options': $ZZq16 .= $Zu20." = ".ZZZZZZZm12::ZZZZZZZy24($value).",";break;default: $ZZq16 .= $Zu20." = '".$value."',";break;}} $ZZq16 = rtrim($ZZq16, ",");$ZZq16 = "UPDATE {$this->db->dbPrefix}advancedreports SET {$ZZq16} WHERE id = {$id}";return $this->db->ZZH77($ZZq16, array());} function ZZZZU2020($ZZZZV2121){$ZZq16 = "SELECT MAX(sequence) FROM {$this->db->dbPrefix}advancedreports WHERE category_id = {$ZZZZV2121['selectedCategory']}";$ZZZZ2525 = $this->db->ZZZC22($ZZq16);$ZZZZ2525 = $ZZZZ2525[0][0];if(empty($ZZZZ2525)){$ZZZZ2525 = 1;}else{$ZZZZ2525++;} $ZZZN1313 = $ZZZZV2121['owner'];$ZZZZW2222 = "";if($ZZZZV2121['customOptions']['enableAudit'] == 'true')$ZZZZW2222.=',"enableAudit":true';if($ZZZZV2121['customOptions']['enableCustomTables'] == 'true')$ZZZZW2222.=',"enableCustomTables":true';if($ZZZZV2121['selectedReportType'] == 1)$ZZZZW2222.=',"isCombined":true';$ZZZg6 = "{\"includeDetails\":true,\"isCrosstab\":false,\"aggregateColumn\":false{$ZZZZW2222}}";$ZZq16 = "INSERT INTO {$this->db->dbPrefix}advancedreports(category_id, sequence, module, related_data, fields, filters, grouping, aggregates, totalAggregates, title, description, options, labels, chart, owner, shared, sharedlevel, iscombined, combinedfields) VALUES ({$ZZZZV2121['selectedCategory']}, {$ZZZZ2525}, '{$ZZZZV2121['mainModuleName']}', ".ZZZZZZZm12::ZZZZZZZy24($ZZZZV2121['selectedModules']).", ".ZZZZZZZm12::ZZZZZZZy24('[]').", ".ZZZZZZZm12::ZZZZZZZy24('[]').", ".ZZZZZZZm12::ZZZZZZZy24('[]').", ".ZZZZZZZm12::ZZZZZZZy24('[]').", ".ZZZZZZZm12::ZZZZZZZy24('{}').", '{$ZZZZV2121['reportTitle']}', '{$ZZZZV2121['reportDescription']}', ".ZZZZZZZm12::ZZZZZZZy24($ZZZg6).", ".ZZZZZZZm12::ZZZZZZZy24('{}').", ".ZZZZZZZm12::ZZZZZZZy24('{"chartTitle":"","chartType":"pie","chartLabels":"","chartAxisX":"","chartAxisY":"","chartAxisY2":"","chartYAxisType":"","chartYAxis2Type":"","chartLegend":"","chartStacked":false}').", '{$ZZZN1313}', 0, 0, {$ZZZZV2121['selectedReportType']}, ".ZZZZZZZm12::ZZZZZZZy24('{"sortAction":"group","dateGrouping":"day","sortDirection":"ASC","position":"column","fields":{}}').");";$this->db->ZZZD33($ZZq16);$ZY2424 = $this->db->ZZZD33("SELECT ".ZZZZZZZm12::ZZZZZZZz25()." AS id");$ZZr17 = $this->db->fetchRow($ZY2424);return $ZZr17['id'];} function ZZZZk10($id,$title,$description){$this->db->ZZH77("UPDATE {$this->db->dbPrefix}advancedreports SET title=?, description=? WHERE id = ?", array($title, $description, $id));} function deleteReport($id){$this->db->ZZH77("DELETE FROM {$this->db->dbPrefix}advancedreports WHERE id = ?", array($id));} function ZZZZb1($ZZZZc2="*", $ZZZZd3="", $limit=1){$query = "SELECT $ZZZZc2 FROM {$this->db->dbPrefix}advancedreports";if(!empty($ZZZZd3)){$query .= " WHERE $ZZZZd3";} if((int)$limit>0){$query.= " ORDER BY id ";$query.= ZZZZZZZm12::ZZZZZZZC22(0, $limit);} $query.=";";$report = $this->db->run_query_allrecords($query);foreach($report as &$ZZZZZZZD33) {$ZZZZZZZD33 = PlatformConnector::ZZZZZZE44($ZZZZZZZD33);} return $report;} function loadReport($id){$ZZS1818 = null;$ZZS1818 = $this->db->run_query_allrecords("SELECT * FROM {$this->db->dbPrefix}advancedreports WHERE id = ". (int)$id);if($ZZS1818){$ZZS1818 = $ZZS1818[0];$ZZS1818["related_data"] = json_decode($ZZS1818["related_data"],true);for($Zf5 = 0;$Zf5<count($ZZS1818['related_data']);$Zf5++){for($ZZZZa0 = 0;$ZZZZa0 <= 11;$ZZZZa0++) {if(!isset($ZZS1818["related_data"][$Zf5][$ZZZZa0])) {$ZZS1818["related_data"][$Zf5][$ZZZZa0] = false;}}}} $ZZS1818 = PlatformConnector::ZZZZZZE44($ZZS1818);return $ZZS1818;}}
;interface ZZZZZZZE44 {function ZZZZZZZF55();}
;class ZZZZZZZG66 {static protected $ZZZZZZZH77 = array("UNSIGNED" => "INT", "BLOB" => "varbinary(max)", "VARCHAR" => "NVARCHAR",);static function getType($type) {return self::$ZZZZZZZH77[$type];}} class ZZZZZZZI88 {static function ZZZZZZZz25() {return "SCOPE_IDENTITY()";} static function quote($ZZJ99) {return "[{$ZZJ99}]";} function ZZZZZZZJ99($ZZZu20) {return "SET IDENTITY_INSERT {$ZZZu20} ON";} function ZZZZZZZK1010($ZZZu20) {return "SET IDENTITY_INSERT {$ZZZu20} OFF";}} class ZZZZZZZL1111 implements ZZZZZZZE44 {protected $r17;function __construct($value) {$this->r17 = $value;} function ZZZZZZZF55() {return $this->r17;}} class ZZZZZZZM1212 implements ZZZZZZZE44 {protected $ZZZZc2;function __construct(array $ZZZZc2) {$this->ZZZZc2 = $ZZZZc2;} function ZZZZZZZF55() {return " " . implode(" + ", $this->ZZZZc2) . " ";}} class ZZZZZZZN1313 implements ZZZZZZZE44 {protected $ZZZZZZZO1414;protected $ZZZZZZZP1515;protected $ZZZZZZZQ1616;function __construct($ZZZZZZZO1414, $ZZZZZZZP1515, $ZZZZZZZQ1616) {$this->ZZZZZZZO1414 = $ZZZZZZZO1414;$this->ZZZZZZZP1515 = $ZZZZZZZP1515;$this->ZZZZZZZQ1616 = $ZZZZZZZQ1616;} function ZZZZZZZR1717($value) {$value = str_replace("'", "", $value);$ZZZZZZZS1818 = ZZZZZZZG66::getType("VARCHAR");if(is_numeric($value)) {$ZZZZZZZS1818 = ZZZZZZZG66::getType("UNSIGNED");} return $ZZZZZZZS1818;} function ZZZZZZZF55() {$ZZZZZZZT1919 = new ZZZZZZZU2020($this->ZZZZZZZP1515, $this->ZZZZZZZR1717($this->ZZZZZZZP1515));$ZZZZZZZP1515 = $ZZZZZZZT1919->ZZZZZZZF55();$ZZZZZZZT1919 = new ZZZZZZZU2020($this->ZZZZZZZQ1616, $this->ZZZZZZZR1717($this->ZZZZZZZQ1616));$ZZZZZZZQ1616 = $ZZZZZZZT1919->ZZZZZZZF55();return "IIF({$this->ZZZZZZZO1414}, {$ZZZZZZZP1515}, {$ZZZZZZZQ1616})";}} class ZZZZZZZV2121 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $ZZZZZz25 = array();protected $ZZZZZZZX2323;function __construct($ZZZZZZZW2222, array $ZZZZZz25) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->ZZZZZz25 = $ZZZZZz25;} function ZZZZZZZF55() {$ZZZZZZZY2424 = 0;$ZZZZZZZZ2525 = array_keys($this->ZZZZZz25);$ZY2424 = "";$ZY2424 .= " CASE {$this->ZZZZZZZW2222} ";foreach ($ZZZZZZZZ2525 as $ZZZZZZZZa0) {$ZY2424 .= " WHEN '{$ZZZZZZZZa0}' THEN {$ZZZZZZZY2424} ";$ZZZZZZZY2424++;} $ZY2424 .= " ELSE {$ZZZZZZZY2424} END ";return $ZY2424;}} class ZZZZZZZZb1 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " LEN($this->ZZZZZZZW2222) ";}} class ZZZZZZZZc2 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $ZO1414;protected $Zl11;function __construct($ZZZZZZZW2222, $ZO1414, $Zl11) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->ZO1414 = $ZO1414;$this->Zl11 = $Zl11;} function ZZZZZZZF55() {return " SUBSTRING({$this->ZZZZZZZW2222}, {$this->ZO1414}, {$this->Zl11}) ";}} class ZZZZZZZZd3 implements ZZZZZZZE44 {protected $ZZZZZZZZe4;protected $ZZn13;function __construct($ZZZZZZZZe4, $ZZn13) {$this->ZZZZZZZZe4 = $ZZZZZZZZe4;$this->count = $ZZn13;} function ZZZZZZZF55() {return " OFFSET {$this->ZZZZZZZZe4} ROWS FETCH NEXT {$this->count} ROWS ONLY ";}} class ZZZZZZZZf5 {static function getInstance($ZZZZZZZZg6, $ZZZZZZZZh7) {switch($ZZZZZZZZg6) {case 'DATE': return new ZZZZZZZZi8($ZZZZZZZZh7);break;case 'WEEK': return new ZZZZZZZZj9($ZZZZZZZZh7);break;case 'YEAR': return new ZZZZZZZZk10($ZZZZZZZZh7);break;case 'MONTH': return new ZZZZZZZZl11($ZZZZZZZZh7);break;case 'QUARTER': return new ZZZZZZZZm12($ZZZZZZZZh7);break;case 'HOUR': return new ZZZZZZZZn13($ZZZZZZZZh7);break;case 'MINUTE': return new ZZZZZZZZo14($ZZZZZZZZh7);break;case 'SECOND': return new ZZZZZZZZp15($ZZZZZZZZh7);break;case 'MICROSECOND': return new ZZZZZZZZq16($ZZZZZZZZh7);break;}}} class ZZZZZZZZi8 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " FORMAT({$this->ZZZZZZZW2222}, 'yyyy-MM-dd') ";}} class ZZZZZZZZr17 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $value;protected $type;function __construct($ZZZZZZZW2222, $value, $type) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->value = $value;$this->type = $type;} function ZZZZZZZF55() {return " DATEADD({$this->type}, {$this->value}, {$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZs18 implements ZZZZZZZE44 {function ZZZZZZZF55() {return "GETDATE()";}} class ZZZZZZZZj9 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " CAST(DATEPART(wk, {$this->ZZZZZZZW2222}) AS nvarchar) ";}} class ZZZZZZZZk10 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " CAST(DATEPART(yy, {$this->ZZZZZZZW2222}) AS nvarchar) ";}} class ZZZZZZZZl11 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " CAST(DATEPART(mm, {$this->ZZZZZZZW2222}) AS nvarchar) ";}} class ZZZZZZZZm12 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " CAST(DATEPART(qq, {$this->ZZZZZZZW2222}) AS nvarchar) ";}} class ZZZZZZZZn13 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " DATEPART(hh, {$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZo14 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " DATEPART(mi, {$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZp15 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " DATEPART(ss, {$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZq16 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " DATEPART(mcs, {$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZt19 implements ZZZZZZZE44 {protected $Zu20;protected $value;function __construct($Zu20, $value = null) {$this->key = $Zu20;$this->value = $value;} function ZZZZZZZF55() {if($this->key == 'names') {return '';} if($this->key == 'default_week_format') {return '';}}} class ZZZZZZZZu20 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $ZZZZZZZZv21;protected $ZZZZZZZZw22;function __construct($ZZZZZZZW2222, $ZZZZZZZZv21, $ZZZZZZZZw22) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->ZZZZZZZZv21 = $ZZZZZZZZv21;$this->ZZZZZZZZw22 = $ZZZZZZZZw22;} function ZZZZZZZF55() {$ZZZZZZZZe4 = new ZZZZZZZU2020($this->ZZZZZZZW2222, "DATETIMEOFFSET");$ZZZZZZZW2222 = "SWITCHOFFSET({$ZZZZZZZZe4->ZZZZZZZF55()}, '{$this->ZZZZZZZZw22}')";$ZZZZZZZT1919 = new ZZZZZZZU2020($ZZZZZZZW2222, "DATETIME");return $ZZZZZZZT1919->ZZZZZZZF55();}} class ZZZZZZZU2020 implements ZZZZZZZE44 {protected $r17;protected $type;protected $ZZZZZZZZx23;function __construct($r17, $type, $ZZZZZZZZx23 = null) {$this->r17 = $r17;$this->type = $type;$this->ZZZZZZZZx23 = $ZZZZZZZZx23;} function ZZZZZZZF55() {$ZY2424 = "";$ZY2424 .= " CONVERT({$this->type}, {$this->r17}";if($this->ZZZZZZZZx23) {$ZY2424 .= ", {$this->ZZZZZZZZx23}";} $ZY2424 .= ") ";return $ZY2424;}} class ZZZZZZZZy24 implements ZZZZZZZE44 {function __construct() {} function ZZZZZZZF55() {return "CAST(GETDATE() AS DATE)";}} class ZZZZZZZZz25 implements ZZZZZZZE44 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZF55() {return "#{$this->name}";}} class ZZZZZZZZA00 implements ZZZZZZZE44 {protected $name;protected $query;function __construct($name, $query) {$this->name = $name;$this->query = $query;} function ZZZZZZZF55() {$ZZZZZZZZB11 = new ZZZZZZZZC22($this->name);$ZZZZZZZZD33 = $ZZZZZZZZB11->ZZZZZZZF55();$ZZZZZZZZE44 = " SELECT * INTO {$this->name} FROM ({$this->query}) AS combinedTemporaryTable";return implode(";\n\r ", array($ZZZZZZZZD33, $ZZZZZZZZE44));}} class ZZZZZZZZC22 implements ZZZZZZZE44 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZF55() {return "IF OBJECT_ID('tempdb..{$this->name}') IS NOT NULL DROP TABLE {$this->name}";}} class ZZZZZZZZF55 implements ZZZZZZZE44 {protected $ZZZZZZZZG66;function __construct($ZZZZZZZZG66) {$this->ZZZZZZZZG66 = $ZZZZZZZZG66;} function ZZZZZZZF55() {return "{$this->ZZZZZZZZG66}";}} class ZZZZZZZZH77 implements ZZZZZZZE44 {protected $ZZZZZZZZI88;protected $type;protected $ZZZZZZZZJ99;protected $ZZZZZZZZK1010;function __construct($ZZZZZZZZI88="+", $type="day", $ZZZZZZZZK1010, $ZZZZZZZZJ99) {$this->ZZZZZZZZI88 = $ZZZZZZZZI88;$this->type = $type;$this->ZZZZZZZZK1010 = $ZZZZZZZZK1010;$this->ZZZZZZZZJ99 = $ZZZZZZZZJ99;} function ZZZZZZZF55() {return "DATEADD({$this->type}, {$this->ZZZZZZZZI88}{$this->ZZZZZZZZK1010}, $this->ZZZZZZZZJ99)";}} class ZZZZZZZZL1111 implements ZZZZZZZE44 {protected $ZZZZZZZZM1212;function __construct($ZZZZZZZZM1212) {$this->ZZZZZZZZM1212 = $ZZZZZZZZM1212;} function ZZZZZZZF55() {return " COLLATE {$this->ZZZZZZZZM1212} ";}}
;class ZZZZZZZZN1313 {static protected $ZZZZZZZH77 = array("UNSIGNED" => "UNSIGNED", "BLOB" => "BLOB", "VARCHAR" => "VARCHAR",);static function getType($type) {return self::$ZZZZZZZH77[$type];}} class ZZZZZZZZO1414 {static function ZZZZZZZz25() {return "last_insert_id()";} static function quote($ZZJ99) {return "`{$ZZJ99}`";} function ZZZZZZZJ99($ZZZu20) {return "";} function ZZZZZZZK1010($ZZZu20) {return "";}} class ZZZZZZZZP1515 implements ZZZZZZZE44 {protected $r17;function __construct($value) {$this->r17 = $value;} function ZZZZZZZF55() {return $this->r17;}} class ZZZZZZZZQ1616 implements ZZZZZZZE44 {protected $ZZZZc2;function __construct(array $ZZZZc2) {$this->ZZZZc2 = $ZZZZc2;} function ZZZZZZZF55() {return " CONCAT(".implode(",", $this->ZZZZc2).") ";}} class ZZZZZZZZR1717 implements ZZZZZZZE44 {protected $ZZZZZZZO1414;protected $ZZZZZZZP1515;protected $ZZZZZZZQ1616;function __construct($ZZZZZZZO1414, $ZZZZZZZP1515, $ZZZZZZZQ1616) {$this->ZZZZZZZO1414 = $ZZZZZZZO1414;$this->ZZZZZZZP1515 = $ZZZZZZZP1515;$this->ZZZZZZZQ1616 = $ZZZZZZZQ1616;} function ZZZZZZZF55() {return "IF({$this->ZZZZZZZO1414}, {$this->ZZZZZZZP1515}, {$this->ZZZZZZZQ1616})";}} class ZZZZZZZZS1818 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $ZZZZZz25 = array();protected $ZZZZZZZX2323;function __construct($ZZZZZZZW2222, array $ZZZZZz25) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->ZZZZZz25 = $ZZZZZz25;} function ZZZZZZZF55() {$ZZZZZZZZ2525 = array_keys($this->ZZZZZz25);foreach ($ZZZZZZZZ2525 as &$ZZZZZZZZa0) {$ZZZZZZZZa0 = "'{$ZZZZZZZZa0}'";} $ZZZZZZZZ2525 = implode(",", $ZZZZZZZZ2525);return " FIELD({$this->ZZZZZZZW2222}, {$ZZZZZZZZ2525}) ";}} class ZZZZZZZZT1919 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " LENGTH($this->ZZZZZZZW2222) ";}} class ZZZZZZZZU2020 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $ZO1414;protected $Zl11;function __construct($ZZZZZZZW2222, $ZO1414, $Zl11) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->ZO1414 = $ZO1414;$this->Zl11 = $Zl11;} function ZZZZZZZF55() {return " MID({$this->ZZZZZZZW2222}, {$this->ZO1414}, {$this->Zl11}) ";}} class ZZZZZZZZV2121 implements ZZZZZZZE44 {protected $ZZZZZZZZe4;protected $ZZn13;function __construct($ZZZZZZZZe4, $ZZn13) {$this->ZZZZZZZZe4 = $ZZZZZZZZe4;$this->count = $ZZn13;} function ZZZZZZZF55() {return " LIMIT {$this->ZZZZZZZZe4}, {$this->count} ";}} class ZZZZZZZZW2222 {static function getInstance($ZZZZZZZZg6, $ZZZZZZZZh7) {switch($ZZZZZZZZg6) {case 'DATE': return new ZZZZZZZZX2323($ZZZZZZZZh7);break;case 'WEEK': return new ZZZZZZZZY2424($ZZZZZZZZh7);break;case 'YEAR': return new ZZZZZZZZZ2525($ZZZZZZZZh7);break;case 'MONTH': return new ZZZZZZZZZa0($ZZZZZZZZh7);break;case 'QUARTER': return new ZZZZZZZZZb1($ZZZZZZZZh7);break;case 'HOUR': return new ZZZZZZZZZc2($ZZZZZZZZh7);break;case 'MINUTE': return new ZZZZZZZZZd3($ZZZZZZZZh7);break;case 'SECOND': return new ZZZZZZZZZe4($ZZZZZZZZh7);break;case 'MICROSECOND': return new ZZZZZZZZZf5($ZZZZZZZZh7);break;}}} class ZZZZZZZZX2323 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " DATE({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZg6 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $value;protected $type;function __construct($ZZZZZZZW2222, $value, $type) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->value = $value;$this->type = $type;} function ZZZZZZZF55() {if($this->value < 0) {$this->value = abs($this->value);return " DATE_SUB({$this->ZZZZZZZW2222}, INTERVAL {$this->value} {$this->type}) ";} else {return " DATE_ADD({$this->ZZZZZZZW2222}, INTERVAL {$this->value} {$this->type}) ";}}} class ZZZZZZZZZh7 implements ZZZZZZZE44 {function ZZZZZZZF55() {return "NOW()";}} class ZZZZZZZZY2424 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " WEEK({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZ2525 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " YEAR({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZa0 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " MONTH({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZb1 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " QUARTER({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZc2 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " HOUR({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZd3 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " MINUTE({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZe4 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " SECOND({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZf5 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;function __construct($ZZZZZZZW2222) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;} function ZZZZZZZF55() {return " MICROSECOND({$this->ZZZZZZZW2222}) ";}} class ZZZZZZZZZi8 implements ZZZZZZZE44 {protected $Zu20;protected $value;function __construct($Zu20, $value = null) {$this->key = $Zu20;$this->value = $value;} function ZZZZZZZF55() {if($this->key == 'names') {return "SET {$this->key} {$this->value};";} else {return "SET {$this->key} = {$this->value};";}}} class ZZZZZZZZZj9 implements ZZZZZZZE44 {protected $ZZZZZZZW2222;protected $ZZZZZZZZv21;protected $ZZZZZZZZw22;function __construct($ZZZZZZZW2222, $ZZZZZZZZv21, $ZZZZZZZZw22) {$this->ZZZZZZZW2222 = $ZZZZZZZW2222;$this->ZZZZZZZZv21 = $ZZZZZZZZv21;$this->ZZZZZZZZw22 = $ZZZZZZZZw22;} function ZZZZZZZF55() {return "CONVERT_TZ({$this->ZZZZZZZW2222}, \"{$this->ZZZZZZZZv21}\", \"{$this->ZZZZZZZZw22}\")";}} class ZZZZZZZZZk10 implements ZZZZZZZE44 {protected $r17;function __construct($r17, $type = false) {$this->r17 = $r17;} function ZZZZZZZF55() {return "{$this->r17}";}} class ZZZZZZZZZl11 implements ZZZZZZZE44 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZF55() {return "{$this->name}";}} class ZZZZZZZZZm12 implements ZZZZZZZE44 {protected $name;protected $query;function __construct($name, $query) {$this->name = $name;$this->query = $query;} function ZZZZZZZF55() {return "CREATE TEMPORARY TABLE IF NOT EXISTS {$this->name} AS {$this->query}";}} class ZZZZZZZZZn13 implements ZZZZZZZE44 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZF55() {return "DROP TEMPORARY TABLE IF EXISTS {$this->name}";}} class ZZZZZZZZZo14 implements ZZZZZZZE44 {protected $ZZZZZZZZG66;function __construct($ZZZZZZZZG66) {$this->ZZZZZZZZG66 = $ZZZZZZZZG66;} function ZZZZZZZF55() {return "{$this->ZZZZZZZZG66}";}} class ZZZZZZZZZp15 implements ZZZZZZZE44 {function __construct() {} function ZZZZZZZF55() {return "CURDATE()";}} class ZZZZZZZZZq16 implements ZZZZZZZE44 {protected $ZZZZZZZZI88;protected $type;protected $ZZZZZZZZJ99;protected $ZZZZZZZZK1010;function __construct($ZZZZZZZZI88="+", $type="day", $ZZZZZZZZK1010, $ZZZZZZZZJ99) {$this->ZZZZZZZZI88 = $ZZZZZZZZI88;$this->type = $type;$this->ZZZZZZZZK1010 = $ZZZZZZZZK1010;$this->ZZZZZZZZJ99 = $ZZZZZZZZJ99;} function ZZZZZZZF55() {return "$this->ZZZZZZZZJ99 {$this->ZZZZZZZZI88} INTERVAL {$this->ZZZZZZZZK1010} {$this->type}";}} class ZZZZZZZZZr17 implements ZZZZZZZE44 {protected $ZZZZZZZZM1212;function __construct($ZZZZZZZZM1212) {$this->ZZZZZZZZM1212 = $ZZZZZZZZM1212;} function ZZZZZZZF55() {return " COLLATE {$this->ZZZZZZZZM1212} ";}}
;class ZZZZZZZm12 {static function ZZZZZZZR1717($type) {if(PlatformConnector::ZZZZZZI88() == "mysql") {return ZZZZZZZZN1313::getType($type);} else {return ZZZZZZZG66::getType($type);}} static function ZZZZZZZy24($r17) {return '0x'.strtoupper(bin2hex($r17));} static function ZZZZZZZz25() {if(PlatformConnector::ZZZZZZI88() == "mysql") {return ZZZZZZZZO1414::ZZZZZZZz25();} else {return ZZZZZZZI88::ZZZZZZZz25();}} static function quote($ZZJ99) {if(PlatformConnector::ZZZZZZI88() == "mysql") {return ZZZZZZZZO1414::quote($ZZJ99);} else {return ZZZZZZZI88::quote($ZZJ99);}} static function ZZZZZZZJ99($ZZZu20) {if(PlatformConnector::ZZZZZZI88() == "mysql") {return ZZZZZZZZO1414::ZZZZZZZJ99($ZZZu20);} else {return ZZZZZZZI88::ZZZZZZZJ99($ZZZu20);}} static function ZZZZZZZK1010($ZZZu20) {if(PlatformConnector::ZZZZZZI88() == "mysql") {return ZZZZZZZZO1414::ZZZZZZZK1010($ZZZu20);} else {return ZZZZZZZI88::ZZZZZZZK1010($ZZZu20);}} static function ZZZZZZZZZs18(array $ZZZZc2) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZQ1616($ZZZZc2);} else {$ZZZZZZF55 = new ZZZZZZZM1212($ZZZZc2);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZn13($ZZZZZZZO1414, $ZZZZZZZP1515, $ZZZZZZZQ1616) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZR1717($ZZZZZZZO1414, $ZZZZZZZP1515, $ZZZZZZZQ1616);} else {$ZZZZZZF55 = new ZZZZZZZN1313($ZZZZZZZO1414, $ZZZZZZZP1515, $ZZZZZZZQ1616);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZt19($ZZZZZZZW2222, array $ZZZZZz25) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZS1818($ZZZZZZZW2222, $ZZZZZz25);} else {$ZZZZZZF55 = new ZZZZZZZV2121($ZZZZZZZW2222, $ZZZZZz25);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZu20($ZZZZZZZW2222) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZT1919($ZZZZZZZW2222);} else {$ZZZZZZF55 = new ZZZZZZZZb1($ZZZZZZZW2222);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZv21($ZZZZZZZW2222, $ZO1414, $Zl11) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZU2020($ZZZZZZZW2222, $ZO1414, $Zl11);} else {$ZZZZZZF55 = new ZZZZZZZZc2($ZZZZZZZW2222, $ZO1414, $Zl11);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZC22($ZZZZZZZZe4, $ZZn13) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZV2121($ZZZZZZZZe4, $ZZn13);} else {$ZZZZZZF55 = new ZZZZZZZZd3($ZZZZZZZZe4, $ZZn13);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZw22($ZZZZZZZZg6, $ZZZZZZZZh7) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = ZZZZZZZZW2222::getInstance($ZZZZZZZZg6, $ZZZZZZZZh7);} else {$ZZZZZZF55 = ZZZZZZZZf5::getInstance($ZZZZZZZZg6, $ZZZZZZZZh7);} return $ZZZZZZF55->ZZZZZZZF55();} static function getDate($ZZZZZZZW2222) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZX2323($ZZZZZZZW2222);} else {$ZZZZZZF55 = new ZZZZZZZZi8($ZZZZZZZW2222);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZx23($ZZZZZZZW2222, $value, $type) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZg6($ZZZZZZZW2222, $value, $type);} else {$ZZZZZZF55 = new ZZZZZZZZr17($ZZZZZZZW2222, $value, $type);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZy24() {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZh7();} else {$ZZZZZZF55 = new ZZZZZZZZs18();} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZz25($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("WEEK", $ZZZZZZZW2222);} static function ZZZZZZZZZA00($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("YEAR", $ZZZZZZZW2222);} static function ZZZZZZZZZB11($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("MONTH", $ZZZZZZZW2222);} static function ZZZZZZZZZC22($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("QUARTER", $ZZZZZZZW2222);} static function ZZZZZZZZZD33($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("HOUR", $ZZZZZZZW2222);} static function ZZZZZZZZZE44($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("MINUTE", $ZZZZZZZW2222);} static function ZZZZZZZZZF55($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("SECOND", $ZZZZZZZW2222);} static function ZZZZZZZZZG66($ZZZZZZZW2222) {return self::ZZZZZZZZZw22("MICROSECOND", $ZZZZZZZW2222);} static function ZZZZZZZZZH77() {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZp15();} else {$ZZZZZZF55 = new ZZZZZZZZy24();} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZI88($ZZZZZZZZI88, $type, $ZZZZZZZZK1010, $ZZZZZZZZJ99) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZq16($ZZZZZZZZI88, $type, $ZZZZZZZZK1010, $ZZZZZZZZJ99);} else {$ZZZZZZF55 = new ZZZZZZZZH77($ZZZZZZZZI88, $type, $ZZZZZZZZK1010, $ZZZZZZZZJ99);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZJ99($Zu20, $value = null) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZi8($Zu20, $value);} else {$ZZZZZZF55 = new ZZZZZZZZt19($Zu20, $value);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZK1010($ZZZZZZZW2222, $ZZZZZZZZv21, $ZZZZZZZZw22) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZj9($ZZZZZZZW2222, $ZZZZZZZZv21, $ZZZZZZZZw22);} else {$ZZZZZZF55 = new ZZZZZZZZu20($ZZZZZZZW2222, $ZZZZZZZZv21, $ZZZZZZZZw22);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZL1111($r17, $type = false) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZk10($r17, $type);} else {$ZZZZZZF55 = new ZZZZZZZU2020($r17, $type);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZM1212($name) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZl11($name);} else {$ZZZZZZF55 = new ZZZZZZZZz25($name);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZN1313($name, $query) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZm12($name, $query);} else {$ZZZZZZF55 = new ZZZZZZZZA00($name, $query);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZO1414($name) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZn13($name);} else {$ZZZZZZF55 = new ZZZZZZZZC22($name);} return $ZZZZZZF55->ZZZZZZZF55();} static function ZZZZZZZZZP1515($ZZZZZZZZM1212) {if(PlatformConnector::ZZZZZZI88() == "mysql") {$ZZZZZZF55 = new ZZZZZZZZZr17($ZZZZZZZZM1212);} else {$ZZZZZZF55 = new ZZZZZZZZL1111($ZZZZZZZZM1212);} return $ZZZZZZF55->ZZZZZZZF55();}}
;class ARUser
{protected $id;protected $ZZZZe4 = false;protected $dateFormat = 'yyyy-mm-dd';protected $ZZZZZZs18 = 24;protected $ZZZZZZZa0 = 'UTC';protected $numberPreferences = array('format' => '123,456,789', 'seperator' => '', 'decimal' => '.',);protected $ZZZZZZZZZQ1616 = '';protected $name = '';protected $ZZZZZZZZZR1717 = array();function __construct(array $ZZZF55 = array()) {$this->ZZZZZZZZZS1818($ZZZF55);} function ZZZZZZZZZS1818(array $ZZZF55 = array()) {if(isset($ZZZF55['id'])) {$this->id = $ZZZF55['id'];} if(isset($ZZZF55['isAdmin'])) {$this->ZZZZe4 = $ZZZF55['isAdmin'];} if(isset($ZZZF55['numberPreferences'])) {$this->numberPreferences = $ZZZF55['numberPreferences'];} if(isset($ZZZF55['dateFormat'])) {$this->dateFormat = $ZZZF55['dateFormat'];} if(isset($ZZZF55['hourFormat'])) {$this->ZZZZZZs18 = $ZZZF55['hourFormat'];} if(isset($ZZZF55['timeZone'])) {$this->ZZZZZZZa0 = $ZZZF55['timeZone'];} if(isset($ZZZF55['email'])) {$this->ZZZZZZZZZQ1616 = $ZZZF55['email'];} if(isset($ZZZF55['name'])) {$this->name = $ZZZF55['name'];} if(isset($ZZZF55['roleIds'])) {$this->ZZZZZZZZZR1717 = $ZZZF55['roleIds'];}} function ZZZZZZO1414() {return $this->id;} function ZZZZZg6() {return $this->ZZZZe4;} function ZZZZZZZZZT1919() {return $this->dateFormat;} function ZZZZZZZZZU2020() {return $this->ZZZZZZs18;} function ZZZZZZZZZV2121() {return $this->numberPreferences;} function getTimeZone() {return $this->ZZZZZZZa0;} function ZZZZZZZZZW2222() {return $this->ZZZZZZZZZQ1616;} function ZZZZZZZZZX2323() {return $this->name;} function ZZZZZZZZZY2424() {return $this->ZZZZZZZZZR1717;} function ZZZZZZZZZZ2525(){$ZZZZZZZZZZa0 = get_object_vars($this);return $ZZZZZZZZZZa0;}}
;class ZZZZZZZZZZb1 {private $moduleName;private $ZZY2424;private $ZZZc2 = array();private $descriptor;private $ZZZZZZZZZZc2;private $ZZZo14 = -1;function __construct() {} function ZZZZZZZZZZd3() {return $this->moduleName;} function ZZZZZZZZZZe4($moduleName) {$this->moduleName = $moduleName;} function ZZZZZZZZZZf5() {return $this->ZZZc2;} function ZZZZZZZZZZg6() {$prefix = "m";$ZZZc2 = $this->ZZZZZZZZZZf5();$ZZZZZZZZZZh7 = array();$ZZT1919 = count($ZZZc2);$ZZZZZe4 = new ZZZZZf5();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = $prefix.$this->ZZZZZZZZZZi8()."_".$this->moduleName."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $ZZZZZe4->ZZZZZw22($ZZZc2[$Zf5]['fieldlabel'],$this->moduleName);$ZZZc2[$Zf5]['module'] = $this->ZZZZZZZZZZi8();$ZZZZZZZZZZh7[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZZZZZZZZZh7;} function ZZZZZZZZZZj9($ZZZc2) {$this->ZZZc2 = $ZZZc2;} function ZZZZZZZZZZk10() {return $this->ZZY2424;} function ZZZZZZZZZZl11($ZZY2424) {$this->ZZY2424 = $ZZY2424;} function ZZZZZZZZZZm12() {return $this->descriptor;} function ZZZZZZZZZZn13($descriptor) {$this->descriptor = $descriptor;} function ZZZZZZZZZZo14() {return $this->ZZZZZZZZZZc2;} function ZZZZZZZZZZp15($ZZZZZZZZZZc2) {$this->ZZZZZZZZZZc2 = $ZZZZZZZZZZc2;} function ZZZZZZZZZZi8() {if($this->ZZZo14 === -1){throw new Exception("Module number not defined!");} return $this->ZZZo14;} function ZZZZZZZZZZq16($ZZZo14) {$this->ZZZo14 = $ZZZo14;} function ZZZZZZZZZZr17($name, $value) {$ZZZc2 = array();foreach ($this->ZZZZZZZZZZf5() as $field) {if (isset($field[$name]) && $field[$name] == $value) {$ZZZc2[] = $field;}} return $ZZZc2;} function ZZZZZZZZZZs18($name, $value) {$ZZZc2 = $this->ZZZZZZZZZZr17($name, $value);if (empty($ZZZc2)) {return false;} return $ZZZc2[0];}}
;class ZZZZZZZZZZt19 {private $ZZZZZZZZZZu20;function __construct($ZZZZZZZZZZu20) {for ($Zf5 = 0, $ZZZZZZZZZZv21 = count($ZZZZZZZZZZu20);$Zf5 < $ZZZZZZZZZZv21;$Zf5++) {$ZZZZZZZZZZw22 = ZZZZZZZZZZx23::ZZZb1($ZZZZZZZZZZu20[$Zf5]);$ZZZZZZZZZZw22->ZZZZZZZZZZq16($Zf5);$this->ZZZZZZZZZZu20[] = $ZZZZZZZZZZw22;}} function ZZZZZZl11() {return $this->ZZZZZZZZZZu20;} function ZZZZZZZZZZf5(){$ZZZc2 = array();foreach ($this->ZZZZZZZZZZu20 as $module) {$ZZZc2 = array_merge($ZZZc2, $module->ZZZZZZZZZZg6());} return $ZZZc2;}}
;class ZZZZZZZZZZx23{private static $ZZZZZZZZZZy24 = false;private static $ZZZZZZZZZZu20 = array();public static function ZZZb1($moduleName, $ZZZy24=false){if(ZZZZZZZZZZx23::$ZZZZZZZZZZy24 === false){ZZZZZZZZZZx23::$ZZZZZZZZZZy24 = ZZZk10::load('definitions', 'modules');} if(isset(ZZZZZZZZZZx23::$ZZZZZZZZZZu20[$moduleName])){return ZZZZZZZZZZx23::$ZZZZZZZZZZu20[$moduleName];} $module = new ZZZZZZZZZZb1();$module->ZZZZZZZZZZe4($moduleName);$ZZZc2 = ZZZZZZZZZZx23::ZZW2222($moduleName, $ZZZy24);$module->ZZZZZZZZZZj9($ZZZc2);$ZZZZZZZZZZz25 = ZZZZZZZZZZx23::ZZZZZZZZZZA00($moduleName);$module->ZZZZZZZZZZl11($ZZZZZZZZZZz25->table_name);$module->ZZZZZZZZZZn13($ZZZZZZZZZZz25);$module->ZZZZZZZZZZp15(ZZZZZZZZZZx23::ZZZz25($moduleName, $ZZZc2));ZZZZZZZZZZx23::$ZZZZZZZZZZu20[$moduleName] = $module;return $module;} private static function ZZW2222($module, $ZZZy24 = false){$ZZZ2525 = array();if(isset(ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]) && isset(ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]['fields'])){return ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]['fields'];} $ZZZa0 = PlatformConnector::ZZZb1($module);if(!$ZZZa0) {return false;} $ZZY2424 = $ZZZa0->getTableName();$ZZZc2 = $ZZZa0->getFieldDefinitions();foreach($ZZZc2 as $field) {if(!isset($field['vname'])) {continue;} $ZZZd3 = ZZZZZZZZZZx23::ZZX2323($ZZY2424, $field, $ZZZy24);if($ZZZd3) {$ZZZ2525[] = $ZZZd3;}} if($module == 'oqc_Service') {$ZZZ2525[] = array('tablename' => "oqc_service", 'columnname' => "quantity * #alias#.price", 'fieldname' => "netprice", 'fieldlabel' => "LBL_NET_PRICE", 'uitype' => 'float', 'typeofdata' => 'N~M',);} return $ZZZ2525;} private static function ZZZZZZZZZZA00($module){$ZZS1818 = null;if(isset(ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]) && isset(ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]['tab_name_index'])){$ZZS1818 = array('tab_name_index' => ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]['tab_name_index'], 'table_name' => ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]['table_name'], 'table_index' => ZZZZZZZZZZx23::$ZZZZZZZZZZy24[$module]['table_index']);} $ZZZZZC22 = ($ZZS1818)? ((object) $ZZS1818): ($ZZS1818);if(!$ZZZZZC22){$ZZZZZC22 = PlatformConnector::ZZZb1($module);$ZZZZZF55 = 'id';$ZZS1818 = array('table_index' => $ZZZZZF55, 'table_name' => $ZZZZZC22->table_name, 'tab_name_index' => array(array('name' => $ZZZZZC22->table_name, 'idCol' => $ZZZZZF55), array('name' => $ZZZZZC22->table_name."_cstm", 'idCol' => $ZZZZZF55."_c")));} $ZZZZZC22 = ($ZZS1818)? ((object) $ZZS1818): ($ZZS1818);return $ZZZZZC22;} private static function ZZZz25($module, $ZZZc2){$ZZZA00 = array();$ZZZZZZZZZZB11 = array();foreach ($ZZZc2 as $field) {$ZZZZZZZZZZB11[$field['block']][] = $field;} foreach ($ZZZZZZZZZZB11 as $ZZZZZZZZZZC22 => $ZZZZZZZZZZD33) {$ZZZZZx23 = "---";$ZZZB11 = array('id' => $ZZZZZZZZZZC22, 'label' => $ZZZZZx23, 'fields' => $ZZZZZZZZZZD33,);$ZZZA00[] = $ZZZB11;} return $ZZZA00;} private static function ZZX2323($ZZY2424, $field, $ZZZy24=false) {$ZZZ2525 = array('tablename' => $ZZY2424, 'columnname' => $field['name'], 'fieldname' => $field['name'], 'fieldlabel' => $field['vname'], 'uitype' => $field['type'], 'typeofdata' => 'V~O', 'block' => '1',);if($field['name'] == 'id' && $ZZY2424 == 'users'){$ZZZ2525['uitype'] = 'assigned_user_name';$ZZZ2525['related_module'] = 'Users';$ZZZ2525['table'] = 'users';$ZZZ2525['id_name'] = 'id';$ZZZ2525['rname'] = 'user_name';} if(isset($field['audited'])){$ZZZ2525['audited'] = $field['audited'];} if(isset($field['function'])){$ZZZ2525['function'] = $field['function'];} if(isset($field['function_bean'])){$ZZZ2525['function_bean'] = $field['function_bean'];} if(isset($field['dbType'])) {$ZZZ2525['dbType'] = $field['dbType'];} if(isset($field['options'])) {$ZZZ2525['options'] = $field['options'];} if($field['type'] == 'link') {return false;} if(isset($field['source'])) {if(in_array($field['source'], array('non-db'))) {return false;} if($field['source'] == 'custom_fields') {$ZZZ2525['tablename'] = $ZZZ2525['tablename'] . '_cstm';}} if($ZZZy24){return $ZZZ2525;} if($field['vname'] == '') {return false;} if($field['type'] == 'relate') {if(!isset($field['module'])) {return false;} $ZZZ2525['related_module'] = $field['module'];$ZZZ2525['id_name'] = $field['id_name'];if(isset($field['table'])) {$ZZZ2525['table'] = $field['table'];} if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} if($field['type'] == 'assigned_user_name') {$ZZZ2525['related_module'] = 'Users';$ZZZ2525['table'] = 'users';$ZZZ2525['id_name'] = 'id';if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} return $ZZZ2525;}}
;;global $current_user;date_default_timezone_set(TimeDate::userTimezone($current_user));class ZZZZZZZZZZE44{public $name;public $joinType;public $joinTable1;public $joinField1;public $joinTable2;public $joinField2;public $joinModule;public $manyToManyTable;public $sourceIndex;public $targetIndex;public $roleIndex;public $roleValue;function __construct($name, $joinType, $joinField1, $joinField2, $joinTable1, $joinTable2, $joinModule, $manyToManyTable = false, $sourceIndex = false, $targetIndex = false, $roleIndex = false, $roleValue = false) {$this->joinField1 = $joinField1;$this->joinField2 = $joinField2;$this->joinTable1 = $joinTable1;$this->joinTable2 = $joinTable2;$this->joinType = $joinType;$this->name = $name;$this->joinModule = $joinModule;$this->manyToManyTable = $manyToManyTable;$this->sourceIndex = $sourceIndex;$this->targetIndex = $targetIndex;$this->roleIndex = $roleIndex;$this->roleValue = $roleValue;}}
class ZZZZZZZZZZF55{protected $db;protected $ZZZZZe4;protected $ZZZZZZZZZZG66;protected $ZZZZZJ99 = array();protected $isCombined = false;function __construct($ZZZZZZZZZZG66, $ZZZZZJ99, ZZp15 $db, ZZZZZf5 $ZZZZZe4, $isCombined = false){$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;if($ZZZZZZZZZZG66){$this->ZZZZZZZZZZG66 = new ZZZZZZZZZZH77($ZZZZZZZZZZG66,$this->db,$this->ZZZZZe4);}else{$this->ZZZZZZZZZZG66 = false;} $ZZT1919 = count($ZZZZZJ99);$this->isCombined = $isCombined;for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZJ99[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);}} function ZZZZZZZZZZJ99($module){$ZZS1818 = $this->ZZZZZe4->ZZZZZw22($module->name,$module->name);if($this->isCombined){if($module->relationDescr->joinModule >0){$ZZS1818 = $this->ZZZZZZZZZZJ99($this->ZZZZZJ99[$module->relationDescr->joinModule-1])."-".$ZZS1818;}elseif($this->ZZZZZZZZZZG66){$ZZS1818 = $this->ZZZZZe4->ZZZZZw22($this->ZZZZZZZZZZG66->name,$this->ZZZZZZZZZZG66->name)."-".$ZZS1818;}} return $ZZS1818;} function ZZZZZZZZZZK1010($module){return $ZZZZZZZZZZL1111 = "(".$this->ZZZZZZZZZZJ99($module).") ";} function ZZZZZZZZZZM1212(){$ZZS1818 = array();if($this->ZZZZZZZZZZG66){$this->ZZZZZZZZZZG66->fieldTitlePrefix = "(".$this->ZZZZZe4->ZZZZZw22($this->ZZZZZZZZZZG66->name,$this->ZZZZZZZZZZG66->name).") ";$ZZS1818 = $this->ZZZZZZZZZZG66->ZZZZZZZZZZM1212();} $ZZT1919 = count($this->ZZZZZJ99);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZJ99[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZJ99[$Zf5]->name."_";$this->ZZZZZJ99[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZK1010($this->ZZZZZJ99[$Zf5]);$ZZZZZC22 = $this->ZZZZZJ99[$Zf5]->ZZZZZZZZZZM1212();$ZZS1818 = array_merge($ZZS1818,$ZZZZZC22);} return $ZZS1818;} function ZZZZZZZZZZN1313($ZZZZZZZZZZO1414,$ZZZZZZZZZZP1515){$ZZS1818 = array();if($this->ZZZZZZZZZZG66){$ZZS1818 = $this->ZZZZZZZZZZG66->ZZZZZZZZZZM1212();} $ZZT1919 = count($this->ZZZZZJ99);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!in_array($Zf5,$ZZZZZZZZZZO1414)){$this->ZZZZZJ99[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZJ99[$Zf5]->name."_";if($this->isCombined){$this->ZZZZZJ99[$Zf5]->ZZZZZZZZZZZZZZZZZb1= $this->ZZZZZZZZZZJ99($this->ZZZZZJ99[$Zf5])." ";if(in_array($this->ZZZZZJ99[$Zf5]->name,$ZZZZZZZZZZP1515)){$this->ZZZZZJ99[$Zf5]->fieldTitlePrefix = "(".$this->ZZZZZe4->ZZZZZw22($this->ZZZZZJ99[$Zf5]->name,$this->ZZZZZJ99[$Zf5]->name).") ";}else{$this->ZZZZZJ99[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZK1010($this->ZZZZZJ99[$Zf5]);}} $ZZZZZC22 = $this->ZZZZZJ99[$Zf5]->ZZZZZZZZZZM1212(true);$ZZS1818 = array_merge($ZZS1818,$ZZZZZC22);}} $ZZS1818[] = array("title"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "fields"=>array(array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "bareTitle"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "availableValues" =>array(),)));return $ZZS1818;}} class ZZZZZZZZZZQ1616{protected $ZZZZZZZZZZR1717;protected $ZZZZZZZZZZS1818;protected $ZZZZZZZZZZT1919;protected $ZZZZZZZZZZU2020 = 0;protected $ZZZZZZZZZZV2121 = false;protected $ZZZZZZZZZZW2222 = false;protected $ZZZZZZZZZZX2323 = array(array());protected $ZZZZZZZZZZY2424;protected $ZZZZZZZZZZZ2525 = array();protected $ZZZZZZZZZZZa0 = array();protected $ZZZZZZZZZZZb1 = array();protected $ZZZZZZZZZZZc2= array();protected $ZZZZZZZZZZZd3 = array();protected $ZZZZZZZZZZZe4 = array();protected $ZZZZZZZZZZZf5 = array();protected $ZZZZZZZZZZZg6 = array("day" => array("DATE"), "week" => array("WEEK"), "weekAndYear" => array("WEEK","YEAR"), "month" => array("MONTH"), "monthAndYear" => array("MONTH","YEAR"), "quarter" => array("QUARTER"), "quarterAndYear" => array("QUARTER","YEAR"), "year" => array("YEAR"),);protected $ZZZZZJ99 = array();protected $db;protected $ZZZZZe4;function __construct(ZZp15 $db, ZZZZZf5 $ZZZZZe4, $ZZZZZZZZZZZh7 = false, ARUser $ZZZZZZZZZZT1919){$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZZZZZZZZV2121 = $ZZZZZZZZZZZh7;$this->ZZZZZZZZZZT1919 = $ZZZZZZZZZZT1919;} function ZZZZZZZZZZZi8($field){$ZZS1818 = "";if(isset($field['related_module'])) {return array($field['related_module']);} return $ZZS1818;} function ZZZZZZZZZZZj9($name,$ZZZZZZZZZZZk10){$ZZS1818 = false;$ZZT1919 = count($this->ZZZZZJ99);if($ZZT1919>1){for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($this->ZZZZZJ99[$Zf5]->name == $name && $this->ZZZZZJ99[$Zf5]->relationDescr->joinModule == $ZZZZZZZZZZZk10){$ZZS1818 = $Zf5;break;}}} return $ZZS1818;} function ZZZZZZZZZZZl11($field,$ZZZZZZZZZZZm12 = 0){$ZZZZZZZZZZZn13 = array();$moduleName = $this->ZZZZZZZZZZZi8($field);$ZZZZZZZZZZZo14 = "";$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZp15 = $this->ZZZZZZZZZZZj9($moduleName,$ZZZZZZZZZZZm12,$field);$ZZZZZZZZZZZq16 = $this->db->ZZZw22($moduleName[$Zf5],$field);if($ZZZZZZZZZZZp15 !==false && !($field["uitype"] == 66 && $moduleName[$Zf5]=="SalesOrder")) {if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']],false,$ZZZZZZZZZZZp15);} $ZZZZZZZZZZZn13[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']].".`".$ZZZZZZZZZZZq16['field'][0]['columnname']."`";}else{$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN `".$ZZZZZZZZZZZq16['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZq16['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']]."`.`".$field['columnname']."`";$ZZZZZZZZZZZs18 = array();foreach($ZZZZZZZZZZZq16['field'] as $ZZZZZZZZZZZt19){$ZZZZZZZZZZZs18[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZt19['rname']."`";} if(count($ZZZZZZZZZZZs18)>1){if($moduleName[$Zf5]=="Contacts"){global $AdvancedReporting_username_sequence;if($AdvancedReporting_username_sequence=='last-first'){$ZZZZZZZZZZZs18 = array_reverse($ZZZZZZZZZZZs18);}} $ZZZZZZZZZZZn13[] = " CONCAT(".implode(",' ',",$ZZZZZZZZZZZs18).") ";}else{$ZZZZZZZZZZZn13[] = $ZZZZZZZZZZZs18[0];}}} $ZZT1919 = count($ZZZZZZZZZZZn13);$ZZS1818 = "'-'";$ZZZZZZZZZZZo14.= " CASE ";for($Zf5 = $ZZT1919-1;$Zf5>-1;$Zf5--){$ZZS1818 = "IFNULL(".$ZZZZZZZZZZZn13[$Zf5].",".$ZZS1818.")";$ZZZZZZZZZZZo14.= "WHEN ".$ZZZZZZZZZZZn13[$Zf5]." IS NOT NULL THEN '".$moduleName[$Zf5]."' ";} $ZZS1818.=" AS `".$field['fieldname']."`";$ZZZZZZZZZZZo14.= "ELSE NULL END AS `".$field['fieldname']."_setype`";return $ZZS1818.", ".$ZZZZZZZZZZZo14;} function ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,$ZZZZZZZZZZZv21 = false){$ZZS1818 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname'].'`';if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZS1818 = $field['columnname'];if($ZZZZZZZZZZZv21){$ZZS1818 = preg_replace('/^ROUND\(/',"",$ZZS1818);$ZZS1818 = preg_replace('/\,2\)$/',"",$ZZS1818);}} $ZZS1818 = str_replace("#alias#",$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']],$ZZS1818);return $ZZS1818;} function ZZZZZZZZZZZw22($ZZZZZZZW2222) {$ZZZZZZZZe4 = PlatformConnector::ZZZZZZX2323($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZx23 = PlatformConnector::ZZZZZZZ2525("UTC");$ZZZZZZZZZZZy24 = PlatformConnector::ZZZZZZZ2525($ZZZZZZZZe4);return ZZZZZZZm12::ZZZZZZZZZK1010($ZZZZZZZW2222, $ZZZZZZZZZZZx23, $ZZZZZZZZZZZy24);} function ZZZZZZZZZZZz25($name, $ZZZZZZZZZZZA00 = true, $ZZZZZZZZZZZB11 = "", $prefix = "") {if($ZZZZZZZZZZZA00) {return " AS `{$prefix}{$name}{$ZZZZZZZZZZZB11}` ";} return "";} function ZZZZZZZZZZZC22($field,$ZZZP1515 = null,$displayOptions = null, $ZZZZZZZZZZZA00 = true, $ZZZZZZZZZZZD33 = array()){$ZZZZZZZZZZZE44 = false;if(!empty($ZZZZZZZZZZZD33) || (isset($field['tablename']) && $field['tablename'] == '__virtual__')){$ZZZZZZZZZZZE44 = true;} $ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();$ZZS1818 = array();$ZZZZZZZZZZZG66 = '';$ZZZZZZZZZZZH77 = '';$ZZZZZZZZZZZI88 = array();$ZZZZZZZZZZZJ99 = array();$ZZZZZZZZZZZm12 = $field['module'];if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']]) && !$ZZZZZZZZZZZE44){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZm12][$field['tablename']],false,$ZZZZZZZZZZZm12);} if(!$ZZZZZZZZZZZE44){$ZZZZZZZZZZZK1010 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".".$field['columnname']."";}else{$ZZZZZZZZZZZK1010 = $field['columnname'];} if(!$ZZZP1515){if($displayOptions){$ZZZH77 = "";switch($displayOptions){case "nogroup": $ZZZH77.="''";break;case "day": $ZZZH77.= ZZZZZZZm12::getDate($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_day";$ZZZZZZZZZZZH77 = " (Day)";break;case "week": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZz25($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_week";$ZZZZZZZZZZZH77 = " (Week)";break;case "weekAndYear": $ZZZZZZZZZZZL1111 = ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZM1212 = ZZZZZZZm12::ZZZZZZZZZz25($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZH77.= ZZZZZZZm12::ZZZZZZZZZs18(array($ZZZZZZZZZZZL1111, "'-'", $ZZZZZZZZZZZM1212));$ZZZZZZZZZZZG66 = "_weekAndYear";$ZZZZZZZZZZZH77 = " (Week and year)";break;case "month": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZB11($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_month";$ZZZZZZZZZZZH77 = " (Month)";break;case "monthAndYear": $ZZZZZZZZZZZL1111 = ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZN1313 = ZZZZZZZm12::ZZZZZZZZZB11($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZH77.= ZZZZZZZm12::ZZZZZZZZZs18(array($ZZZZZZZZZZZL1111, "'-'", $ZZZZZZZZZZZN1313));$ZZZZZZZZZZZG66 = "_monthAndYear";$ZZZZZZZZZZZH77 = " (Month and year)";break;case "quarter": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZC22($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_quarter";$ZZZZZZZZZZZH77 = " (Quarter)";break;case "quarterAndYear": $ZZZZZZZZZZZL1111 = ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZO1414 = ZZZZZZZm12::ZZZZZZZZZC22($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZH77.= ZZZZZZZm12::ZZZZZZZZZs18(array($ZZZZZZZZZZZL1111, "'-'", $ZZZZZZZZZZZO1414));$ZZZZZZZZZZZG66 = "_quarterAndYear";$ZZZZZZZZZZZH77 = " (Quarter and year)";break;case "year": $ZZZH77.= ZZZZZZZm12::ZZZZZZZZZA00($this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010));$ZZZZZZZZZZZG66 = "_year";$ZZZZZZZZZZZH77 = " (Year)";break;default: $ZZZH77.= $ZZZZZZZZZZZK1010;break;} $ZZZH77.= " AS `".$field['fieldname'].$ZZZZZZZZZZZG66."`";$ZZS1818[] = $ZZZH77;}else{if(($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id")){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN users ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users']." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".id = ".$ZZZZZZZZZZZK1010;global $AdvancedReporting_username_sequence;$ZZS1818[] = "case when (".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name":$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name").") end AS `".$field['fieldname']."`";$ZZS1818[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".`id` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_id");$ZZS1818[] = "'Users' ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_setype");}else{if($this->ZZZZZe4->ZZZZZK1010($field)){$ZZS1818[] = $this->ZZZZZZZZZZZl11($field,$ZZZZZZZZZZZm12);$ZZS1818[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['id_name']."` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_id");}else{if($this->ZZZZZe4->ZZZZZO1414($field)) {$ZZZH77 = "ROUND(" . $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']] . ".`" . $field['columnname'] . "`,{$ZZZZZZZZZZZF55}) " . $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);$ZZZH77 = str_replace("#alias#", $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']], $ZZZH77);$ZZS1818[] = $ZZZH77;} elseif($this->ZZZZZe4->ZZZZZP1515($field)) {$ZZZH77 = $this->ZZZZZZZZZZZw22($ZZZZZZZZZZZK1010) . $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);$ZZS1818[] = $ZZZH77;}else{if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZZH77 = str_replace('#alias#',$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']],$field['columnname']). $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);} else {$ZZZH77 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname']."` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00);} $ZZS1818[] = $ZZZH77;if($this->ZZZZZe4->ZZZZZI88($field,$this->db,$this->ZZZZZJ99)){$module = $this->ZZZZZJ99[$ZZZZZZZZZZZm12];$ZZZZx23 = $module->ZZZZZZZZZZZP1515();$ZZS1818[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']].".`".$ZZZZx23['idCol']."` ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_id");$ZZS1818[] = "'".$module->name."' ". $this->ZZZZZZZZZZZz25($field['fieldname'], $ZZZZZZZZZZZA00, "_setype");}}}}} $ZZZZZZZZZZZI88[] = $field['fieldname'].$ZZZZZZZZZZZG66;$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$field['fieldlabel'].$ZZZZZZZZZZZH77;}elseif(is_array($ZZZP1515)){$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();if(!$ZZZZZZZZZZZE44) {if(isset($ZZZP1515["sum"]) && $ZZZP1515["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,true)."),{$ZZZZZZZZZZZF55}) " . $this->ZZZZZZZZZZZz25($field['fieldname'], true, "_sum");$ZZZZZZZZZZZI88[] = $field['fieldname']."_sum";$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$this->ZZZZZe4->ZZZZZw22('label_sum',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZP1515["count"]) && $ZZZP1515["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,true).")" . $this->ZZZZZZZZZZZz25($field['fieldname'], true, "_cnt");$ZZZZZZZZZZZI88[] = $field['fieldname']."_cnt";$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$this->ZZZZZe4->ZZZZZw22('label_count',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZP1515["avg"]) && $ZZZP1515["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZu20($field,$ZZZZZZZZZZZm12,true)."),{$ZZZZZZZZZZZF55})" . $this->ZZZZZZZZZZZz25($field['fieldname'], true, "_avg");$ZZZZZZZZZZZI88[] = $field['fieldname']."_avg";$ZZZZZZZZZZZJ99[] = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZm12].$this->ZZZZZe4->ZZZZZw22('label_average',"AnalyticReporting")."(".$field['fieldlabel'].")";}} else {if(isset($ZZZP1515["sum"]) && $ZZZP1515["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"])."),{$ZZZZZZZZZZZF55})" . $this->ZZZZZZZZZZZz25($ZZZZZZZZZZZD33['name'], true, "_sum");$ZZZZZZZZZZZI88[] = $ZZZZZZZZZZZD33['name']."_sum";$ZZZZZZZZZZZJ99[] = $this->ZZZZZe4->ZZZZZw22('label_sum',"AnalyticReporting")."(".$ZZZZZZZZZZZD33['title'].")";} if(isset($ZZZP1515["count"]) && $ZZZP1515["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"]).")" . $this->ZZZZZZZZZZZz25($ZZZZZZZZZZZD33['name'], true, "_cnt");$ZZZZZZZZZZZI88[] = $ZZZZZZZZZZZD33['name']."_cnt";$ZZZZZZZZZZZJ99[] = $this->ZZZZZe4->ZZZZZw22('label_count',"AnalyticReporting")."(".$ZZZZZZZZZZZD33['title'].")";} if(isset($ZZZP1515["avg"]) && $ZZZP1515["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"])."),{$ZZZZZZZZZZZF55})".$this->ZZZZZZZZZZZz25($ZZZZZZZZZZZD33['name'], true, "_avg");$ZZZZZZZZZZZI88[] = $ZZZZZZZZZZZD33['name']."_avg";$ZZZZZZZZZZZJ99[] = $this->ZZZZZe4->ZZZZZw22('label_average',"AnalyticReporting")."(".$ZZZZZZZZZZZD33['title'].")";}}} return array("fields" =>$ZZZZZZZZZZZI88, "select"=>$ZZS1818,"titles"=>$ZZZZZZZZZZZJ99);} function ZZZZZZZZZZZR1717($field,$ZZZZZZZZZZZS1818){$ZZZZZZZZZZZm12 = $field["module"];if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZm12][$field['tablename']],false,$ZZZZZZZZZZZm12);} if($ZZZZZZZZZZZS1818["sortAction"] =="nogroup"){$ZZS1818 = null;}elseif(!empty($ZZZZZZZZZZZS1818["dateGrouping"]) && isset($this->ZZZZZZZZZZZg6[$ZZZZZZZZZZZS1818["dateGrouping"]])){$ZZZZZZZZZZZT1919 = $this->ZZZZZZZZZZZg6[$ZZZZZZZZZZZS1818["dateGrouping"]];$ZZS1818 = array();foreach($ZZZZZZZZZZZT1919 as $ZZZZZZZZg6){$ZZS1818[] = $ZZZZZZZZg6."(".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname']."`)";} $ZZS1818 = implode(", ",$ZZS1818);}else{$ZZS1818 = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".`".$field['columnname']."`";} return $ZZS1818;} function ZZZZZZZZZZZU2020($field,$ZZZZZZZZZZZS1818,$includeDetails = false){$fieldName = $field['fieldname'];if(!empty($ZZZZZZZZZZZS1818["aggregate"])){$ZZZZZC22 = explode("_",$ZZZZZZZZZZZS1818["aggregate"],2);if($ZZZZZC22[0] =="count"){$ZZZZZC22[0] = "cnt";} if(isset($this->ZZZZZZZZZZZd3[$ZZZZZC22[1]."_".$ZZZZZC22[0]])){$fieldName = $ZZZZZC22[1]."_".$ZZZZZC22[0];}}else{$ZZZZZZZZZZZS1818["aggregate"] = null;} $ZZZZZZZZZZZm12 = $field["module"];if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZm12][$field['tablename']],false,$ZZZZZZZZZZZm12);} $ZZZZZZZX2323 = "ASC";if($ZZZZZZZZZZZS1818["sortDirection"]=="DESC"){$ZZZZZZZX2323 = "DESC";} if(($field['uitype'] == 'enum') && ($ZZZZZZZZZZZS1818['name'] == $ZZZZZZZZZZZS1818['aggregate'])){$ZZZZZZZZZZZV2121 = $field['fieldname_org'];$moduleName = $this->ZZZZZJ99[$field["module"]]->name;$ZZZZZZZZ2525 = $this->db->ZZN1313($ZZZZZZZZZZZV2121, $moduleName);$ZZZZZZZZ2525 = array_keys($ZZZZZZZZ2525);foreach ($ZZZZZZZZ2525 as &$ZZZZZZZZa0) {$ZZZZZZZZa0 = "'{$ZZZZZZZZa0}'";} $ZZZZZZZZ2525 = implode(",", $ZZZZZZZZ2525);$ZZS1818 = "FIELD({$fieldName}, {$ZZZZZZZZ2525}) {$ZZZZZZZX2323}";return $ZZS1818;} if(!empty($ZZZZZZZZZZZS1818["dateGrouping"]) && ($ZZZZZZZZZZZS1818["aggregate"] == $field['fieldname'] || $includeDetails ||!$ZZZZZZZZZZZS1818["aggregate"])){if($includeDetails){switch($ZZZZZZZZZZZS1818["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZX2323";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZX2323";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZX2323";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZX2323, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZX2323 , CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;}}else{switch($ZZZZZZZZZZZS1818["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZX2323";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZX2323";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZX2323";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZX2323";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZX2323, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZX2323, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZX2323, CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZX2323";break;}}}else{$ZZS1818 = "`".$fieldName."` ".$ZZZZZZZX2323;} return $ZZS1818;} function ZZZZZZZZZZZW2222($ZZZZx23,$ZZZZZZZZZZZX2323,$ZZZZZZZZZZZm12 = 0, $ZZZZZF55=null,$type = "INNER",$ZZZZZZZZZZZY2424=null, $ZZZZZZZZZZZZ2525=0){$ZZZZZZZZZZZZa0 = $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr;if(!$ZZZZZF55){$ZZZZZF55 = $ZZZZZZZZZZZX2323['idCol'];} if(!$ZZZZZZZZZZZY2424){$ZZZZZZZZZZZY2424 = $ZZZZx23['idCol'];} $ZZZZZZZZZZZZb1 = strpos($ZZZZx23['name'], "_cstm");$ZZZZZZZZZZZZc2 = strpos($ZZZZZZZZZZZX2323['name'], "_cstm");if($ZZZZZZZZZZZZb1 !== false || $ZZZZZZZZZZZZc2 !== false){$ZZZZZZZZZZZZa0 = false;} if($ZZZZZZZZZZZZa0 && $ZZZZZZZZZZZZa0->joinType == 'many') {$ZZZZZZZZZZZZd3 = 't'.$this->ZZZZZZZZZZU2020.'_'.$ZZZZZZZZZZZZa0->manyToManyTable;$this->ZZZZZZZZZZU2020++;$ZZS1818 = $type." JOIN `".$ZZZZZZZZZZZZa0->manyToManyTable ."` AS `".$ZZZZZZZZZZZZd3 ."` ON (`".$ZZZZZZZZZZZZd3."`.`".$ZZZZZZZZZZZZa0->sourceIndex ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZ2525][$ZZZZZZZZZZZX2323['name']]."`.`".$ZZZZZF55."`";if($ZZZZZZZZZZZZa0->roleIndex) {$ZZS1818.= " AND `".$ZZZZZZZZZZZZd3."`.`".$ZZZZZZZZZZZZa0->roleIndex."` = '".$ZZZZZZZZZZZZa0->roleValue."' ";} $ZZS1818.= " AND `".$ZZZZZZZZZZZZd3."`.`deleted` = '0' ";$ZZS1818.= ") ";$ZZS1818.= $type." JOIN `".$ZZZZx23["name"] ."` AS `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] ."` ON (`".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']]."`.`".$ZZZZZZZZZZZY2424 ."` = `".$ZZZZZZZZZZZZd3."`.`".$ZZZZZZZZZZZZa0->targetIndex."`";$ZZS1818.= ") ";} else {if($ZZZZx23["name"] =="vtiger_inventoryproductrel"){$ZZS1818 = $type." JOIN `".$ZZZZx23["name"] ."` AS `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] ."` ON (`".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']]."`.`".$ZZZZZZZZZZZY2424 ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZ2525][$ZZZZZZZZZZZX2323['name']]."`.`".$ZZZZZF55."`";$ZZS1818.= ") ";}else{$ZZS1818 = $type." JOIN `".$ZZZZx23["name"] ."` AS ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] ." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']].".`".$ZZZZZZZZZZZY2424 ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZ2525][$ZZZZZZZZZZZX2323['name']]."`.`".$ZZZZZF55."`";}} return $ZZS1818;} function ZZZZZZZZZZZr17($ZZZZx23,$ZZZZZZZZZZZZe4 = false,$ZZZZZZZZZZZm12 = 0){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$ZZZZx23['name']] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;if(!$ZZZZZZZZZZZZe4){if(!in_array($ZZZZZZZZZZZm12,$this->ZZZZZZZZZZZa0)){if($ZZZZx23 == $this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12]){if(!isset($this->ZZZZZZZZZZR1717[$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule][$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinTable1])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule][$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinTable1],false,$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule);} $this->ZZZZZZZZZZS1818[] = $this->ZZZZZZZZZZZW2222($ZZZZx23, $this->ZZZZZZZZZZX2323[$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule][$this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinTable1], $ZZZZZZZZZZZm12, $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinField1, "LEFT", $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinField2, $this->ZZZZZJ99[$ZZZZZZZZZZZm12]->relationDescr->joinModule);$this->ZZZZZZZZZZZa0[] = $ZZZZZZZZZZZm12;}else{$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12],false,$ZZZZZZZZZZZm12);$this->ZZZZZZZZZZS1818[] = $this->ZZZZZZZZZZZW2222($ZZZZx23,$this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12],$ZZZZZZZZZZZm12,null,"LEFT",null,$ZZZZZZZZZZZm12);}}else{$ZZZe4 = ZZZf5::getInstance();$ZZZg6 = $ZZZe4->ZZZh7();$ZZZZZZZZZZZZf5 = null;if(isset($ZZZg6->enableCustomTables) && $ZZZg6->enableCustomTables) {$ZZZZZZZZZZZZg6 = isset($this->ZZZZZJ99[0])? $this->ZZZZZJ99[0]->name :null;ZZZi8::ZZZj9(ZZZk10::load('hooks', 'addCustomTable'));$ZZZZZZZZZZZZf5 = ZZZi8::ZZZZZZZZZZZZh7($ZZZZZZZZZZZZg6, $ZZZZx23['name']);} $this->ZZZZZZZZZZS1818[] = $this->ZZZZZZZZZZZW2222($ZZZZx23,$this->ZZZZZZZZZZY2424[$ZZZZZZZZZZZm12],$ZZZZZZZZZZZm12,$ZZZZZZZZZZZZf5,"LEFT",null,$ZZZZZZZZZZZm12);}}} function ZZZZZZZZZZZZi8($ZZZZZZZZZZZZj9,$ZZZc2){$field = $ZZZc2[$ZZZZZZZZZZZZj9->fieldName];if($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id"){$ZZZZZZZZZZZm12 = $field['module'];if(!isset($this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$field["module"]][$field["tablename"]],false,$field["module"]);} if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]["users"])){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN users ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users']." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".id = ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']].".".$field['columnname'];} global $AdvancedReporting_username_sequence;$ZZS1818 = "case when (".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name":$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".first_name,' ',".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12]['users'].".last_name").") end ";}elseif($this->ZZZZZe4->ZZZZZK1010($field)){$moduleName = $this->ZZZZZZZZZZZi8($field);$ZZZZZZZZZZZm12 = $field["module"];$ZZZH77 = array();$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZZZZZZZZZZp15 = $this->ZZZZZZZZZZZj9($moduleName,$ZZZZZZZZZZZm12,$field);$ZZZZZZZZZZZq16 = $this->db->ZZZw22($moduleName[$Zf5]);if($ZZZZZZZZZZZp15 !==false){if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']],false,$ZZZZZZZZZZZp15);} $ZZZH77[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZp15][$ZZZZZZZZZZZq16['field'][0]['tablename']].".`".$ZZZZZZZZZZZq16['field'][0]['columnname']."`";}else{if(!isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]])){$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] = "t".$this->ZZZZZZZZZZU2020;$this->ZZZZZZZZZZU2020++;$this->ZZZZZZZZZZS1818[] = "LEFT JOIN `".$ZZZZZZZZZZZq16['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZq16['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['tablename']]."`.`".$field['columnname']."`";} $ZZZH77[] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZm12][$field['fieldname'].$ZZZZZZZZZZZq16['relation']["tablename"]].".`".$ZZZZZZZZZZZq16['field'][0]['columnname']."`";}} $ZZS1818 = "(" .implode(" OR ",$ZZZH77).")";}else{if(!isset($this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$field["module"]][$field["tablename"]],false,$field["module"]);} $ZZS1818 = "`".$this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']]."`.`".$field['columnname']."`";$ZZS1818 = str_replace('#alias#',$this->ZZZZZZZZZZR1717[$field["module"]][$field['tablename']],$ZZS1818);} return $ZZS1818;} function ZZZZZZZZZZZZk10($ZZZZZZZZZZZZj9,$ZZZc2){$ZZS1818 = " AND ";if($ZZZZZZZZZZZZj9->connector =="or" || $ZZZZZZZZZZZZj9->connector =="OR"){$ZZS1818 = " OR ";} $ZZZZZZZZh7 = null;if(isset($ZZZc2[$ZZZZZZZZZZZZj9->fieldName])){$field = $ZZZc2[$ZZZZZZZZZZZZj9->fieldName];$fieldName = $this->ZZZZZZZZZZZZi8($ZZZZZZZZZZZZj9,$ZZZc2);$ZZZZZZZZZZZZl11 = array("assigned_user_id", "created_by", "modified_user_id", "team_id", "team_set_id");$ZZZZZZZZZZZZm12 = in_array($field['columnname'], $ZZZZZZZZZZZZl11);switch ($ZZZZZZZZZZZZj9->condition){case "neq": $ZZZZZZZZZZZZn13 = "";if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZZZZZZZZZZZn13.= " $fieldName NOT IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZZZZZZZZZZZn13.= implode(' , ',$ZZZZZC22);$ZZZZZZZZZZZZn13.= ") ";$ZZS1818.= " ($ZZZZZZZZZZZZn13 OR $fieldName IS NULL) ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName <> ? ";$ZZZZZZZZh7 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZh7 = implode(",", $ZZZZZZZZh7);$ZZS1818.= " OR ($fieldName IS NULL) ";}else{$ZZZZZZZZZZZZn13.= " NOT $fieldName = ? ";$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];$ZZS1818.= " ($ZZZZZZZZZZZZn13 OR $fieldName IS NULL) ";} break;case "eq": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZC22);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName = ? ";$ZZZZZZZZh7 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZh7 = implode(",", $ZZZZZZZZh7);}else{$ZZS1818.= " $fieldName = ? ";$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];} break;case "cont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZC22);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " 1=2 ";$ZZZZZZZZh7 = array();$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZo14, "%");foreach ($ZZZZZZZZZZZZo14 as $ZZZZZZZZZZZZj9) {$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9;$ZZS1818 .= " OR {$fieldName} like ?";}}else{$ZZS1818.= " $fieldName like ? ";$ZZZZZZZZh7 = "%".$ZZZZZZZZZZZZj9->value[0]."%";} break;case "ncont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName NOT IN(";$ZZZZZZZZh7 = array();$ZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZj9->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9->value[$Zf5];$ZZZZZC22[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZC22);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))) {$ZZS1818 .= " 1=1 ";$ZZZZZZZZh7 = array();$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZj9->value, "^");$ZZZZZZZZZZZZo14 = $this->ZZZZZe4->ZZZZZZg6($ZZZZZZZZZZZZo14, "%");foreach ($ZZZZZZZZZZZZo14 as $ZZZZZZZZZZZZj9) {$ZZZZZZZZh7[] = $ZZZZZZZZZZZZj9;$ZZS1818 .= " AND {$fieldName} NOT like ?";}} else {$ZZS1818.= " $fieldName NOT like ? ";$ZZZZZZZZh7 = "%".$ZZZZZZZZZZZZj9->value[0]."%";} break;case "start": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0]."%";break;case "end": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZZh7 = "%".$ZZZZZZZZZZZZj9->value[0];break;case "empty": $ZZS1818.= " ($fieldName IS NULL OR $fieldName ='')";$ZZZZZZZZh7 = null;break;case "filled": $ZZS1818.= " ($fieldName IS NOT NULL AND $fieldName <>'')";$ZZZZZZZZh7 = null;break;case "before": $ZZS1818.= " $fieldName < ?";if($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZH77 = new DateTime();$ZZZH77->setTimestamp($ZZZZZZZZZZZZp15);$ZZZZZZT1919 = $ZZZH77->format("Y-m-d H:i:s");$ZZZZZZT1919 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZT1919);$ZZZZZZZZh7 = $ZZZZZZT1919;}else{$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];} break;case "after": $ZZS1818.= " $fieldName > ?";if($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZH77 = new DateTime();$ZZZH77->setTimestamp($ZZZZZZZZZZZZp15);$ZZZZZZT1919 = $ZZZH77->format("Y-m-d H:i:s");$ZZZZZZT1919 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZT1919);$ZZZZZZZZh7 = $ZZZZZZT1919;}else{$ZZZZZZZZh7 = $ZZZZZZZZZZZZj9->value[0];} break;case "today": $ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";$ZZZZZZZZh7 = array();break;case "tomorrow": $ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZs18 = new DateTime($ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZt19 = new DateTime($ZZZZZZZZZZZZr17);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZs18->modify("+1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZt19->modify("+1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";break;case "yesterday": $ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZs18 = new DateTime($ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZt19 = new DateTime($ZZZZZZZZZZZZr17);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZs18->modify("-1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZt19->modify("-1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";break;case "aftert": $ZZS1818.= " " . ZZZZZZZm12::getDate($fieldName) . " > ?";$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZW2222($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZt19 = new DateTime($ZZZZZZZZZZZZr17);$ZZZZZZZZh7 = $ZZZZZZZZZZZZt19->modify("+1 day")->format("Y-m-d H:i:s");break;case "tilly": $ZZS1818.= " " . ZZZZZZZm12::getDate($fieldName) . " < ?";$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZU2020($this->ZZZZZZZZZZT1919);$ZZZZZZZZZZZZs18 = new DateTime($ZZZZZZZZZZZZq16);$ZZZZZZZZh7 = $ZZZZZZZZZZZZs18->modify("-1 day")->format("Y-m-d H:i:s");break;case "between": $ZZS1818.= " $fieldName >= ? AND $fieldName <= ?";if($this->ZZZZZe4->ZZZZZO1414($field)){$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);}elseif($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZu20 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZZZZZZZZZZv21 = strtotime($ZZZZZZZZZZZZj9->value[4]." ".$ZZZZZZZZZZZZj9->value[5].":".$ZZZZZZZZZZZZj9->value[6].":00 ".$ZZZZZZZZZZZZj9->value[7]);$ZZZZZZZZZZZZw22 = new DateTime();$ZZZZZZZZZZZZx23 = new DateTime();$ZZZZZZZZZZZZw22->setTimestamp($ZZZZZZZZZZZZu20);$ZZZZZZZZZZZZx23->setTimestamp($ZZZZZZZZZZZZv21);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZw22->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZx23->format("Y-m-d H:i:s");$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZr17);$ZZZZZZZZh7 = array($ZZZZZZZZZZZZq16,$ZZZZZZZZZZZZr17);}else{$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);} break;case "nbetween": $ZZS1818.= " ($fieldName < ? OR $fieldName > ?)";if($this->ZZZZZe4->ZZZZZO1414($field)){$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);}elseif($this->ZZZZZe4->ZZZZZP1515($field)){$ZZZZZZZZZZZZu20 = strtotime($ZZZZZZZZZZZZj9->value[0]." ".$ZZZZZZZZZZZZj9->value[1].":".$ZZZZZZZZZZZZj9->value[2].":00 ".$ZZZZZZZZZZZZj9->value[3]);$ZZZZZZZZZZZZv21 = strtotime($ZZZZZZZZZZZZj9->value[4]." ".$ZZZZZZZZZZZZj9->value[5].":".$ZZZZZZZZZZZZj9->value[6].":00 ".$ZZZZZZZZZZZZj9->value[7]);$ZZZZZZZZZZZZw22 = new DateTime();$ZZZZZZZZZZZZx23 = new DateTime();$ZZZZZZZZZZZZw22->setTimestamp($ZZZZZZZZZZZZu20);$ZZZZZZZZZZZZx23->setTimestamp($ZZZZZZZZZZZZv21);$ZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZw22->format("Y-m-d H:i:s");$ZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZx23->format("Y-m-d H:i:s");$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZq16);$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZr17);$ZZZZZZZZh7 = array($ZZZZZZZZZZZZq16,$ZZZZZZZZZZZZr17);}else{$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0],$ZZZZZZZZZZZZj9->value[1]);} break;case "ndays": $ZZS1818.= " $fieldName > ".ZZZZZZZm12::ZZZZZZZZZH77()." AND $fieldName < ".ZZZZZZZm12::ZZZZZZZZZI88("+", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "pdays": $ZZS1818.= " $fieldName < ".ZZZZZZZm12::ZZZZZZZZZH77()." AND $fieldName > ".ZZZZZZZm12::ZZZZZZZZZI88("-", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "gtdays": $ZZS1818.= " $fieldName > ".ZZZZZZZm12::ZZZZZZZZZI88("+", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "ltdays": $ZZS1818.= " $fieldName < ".ZZZZZZZm12::ZZZZZZZZZI88("-", "day", "!", ZZZZZZZm12::ZZZZZZZZZH77());$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "tweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week'))."' AND '".date("Y-m-d",strtotime('this week +6 days'))."'";$ZZZZZZZZh7 = array();break;case "lweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week -7 days'))."' AND '".date("Y-m-d",strtotime('this week -1 days'))."'";$ZZZZZZZZh7 = array();break;case "nweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week +7 days'))."' AND '".date("Y-m-d",strtotime('this week +13 days'))."'";$ZZZZZZZZh7 = array();break;case "tmonth": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-01")."' AND '".date("Y-m-t")."'";$ZZZZZZZZh7 = array();break;case "lmonth": $ZZZZZZZZZZZZy24 = date("Y-m-01 H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZz25 = date("Y-m-t H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZy24 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24, $field['uitype']);$ZZZZZZZZZZZZz25 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25, $field['uitype']);$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24 . " 00:00:00");$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZS1818($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";$ZZZZZZZZh7 = array();break;case "tyear": $ZZS1818.= " $fieldName BETWEEN '".date("Y-01-01")."' AND '".date("Y-12-t")."'";$ZZZZZZZZh7 = array();break;case "lyear": $ZZZZZZZZZZZZy24 = date("Y-01-01 H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZz25 = date("Y-12-t H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZy24 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24);$ZZZZZZZZZZZZz25 = PlatformConnector::ZZZZZZM1212($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25);$ZZZZZZZZZZZZq16 = PlatformConnector::ZZZZZZZZZZZZA00($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZy24 . " 00:00:00");$ZZZZZZZZZZZZr17 = PlatformConnector::ZZZZZZZZZZZZA00($this->ZZZZZZZZZZT1919, $ZZZZZZZZZZZZz25 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZq16}' AND '{$ZZZZZZZZZZZZr17}' ";$ZZZZZZZZh7 = array();break;case "nquarter": $ZZZZZZZZZZZZB11 = "'".date("Y-m-d",strtotime('+3 months'))."'";$ZZZZZZZZZZZZC22 = ZZZZZZZm12::ZZZZZZZZZC22($fieldName);$ZZZZZZZZZZZZD33 = ZZZZZZZm12::ZZZZZZZZZC22($ZZZZZZZZZZZZB11);$ZZZZZZZZZZZZE44 = ZZZZZZZm12::ZZZZZZZZZA00($fieldName);$ZZZZZZZZZZZZF55 = ZZZZZZZm12::ZZZZZZZZZA00($ZZZZZZZZZZZZB11);$ZZS1818.= " {$ZZZZZZZZZZZZC22} = {$ZZZZZZZZZZZZD33} AND {$ZZZZZZZZZZZZE44} = {$ZZZZZZZZZZZZF55} ";$ZZZZZZZZh7 = array();break;case "lquarter": $ZZZZZZZZZZZZG66 = "'".date("Y-m-d",strtotime('-3 months'))."'";$ZZZZZZZZZZZZC22 = ZZZZZZZm12::ZZZZZZZZZC22($fieldName);$ZZZZZZZZZZZZH77 = ZZZZZZZm12::ZZZZZZZZZC22($ZZZZZZZZZZZZG66);$ZZZZZZZZZZZZE44 = ZZZZZZZm12::ZZZZZZZZZA00($fieldName);$ZZZZZZZZZZZZI88 = ZZZZZZZm12::ZZZZZZZZZA00($ZZZZZZZZZZZZG66);$ZZS1818.= " {$ZZZZZZZZZZZZC22} = {$ZZZZZZZZZZZZH77} AND {$ZZZZZZZZZZZZE44} = {$ZZZZZZZZZZZZI88} ";$ZZZZZZZZh7 = array();break;case "gt": $ZZS1818.= " $fieldName > ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "lt": $ZZS1818.= " $fieldName < ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "egt": $ZZS1818.= " $fieldName >= ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "elt": $ZZS1818.= " $fieldName <= ?";$ZZZZZZZZh7 = array($ZZZZZZZZZZZZj9->value[0]);break;case "unchecked": $ZZS1818.= " $fieldName = 0";$ZZZZZZZZh7 = array();break;case "checked": $ZZS1818.= " $fieldName = 1";$ZZZZZZZZh7 = array();break;case "assignedto": global $current_user;$ZZS1818.= " $fieldName LIKE ?";$ZZZZZZZZZZZZJ99 = $current_user->first_name;$ZZZZZZZZZZZZK1010 = $current_user->last_name;if($ZZZZZZZZZZZZJ99 == ""){$ZZZZZZZZZZZZL1111 = $ZZZZZZZZZZZZK1010;}else{$ZZZZZZZZZZZZL1111 = $ZZZZZZZZZZZZJ99." ".$ZZZZZZZZZZZZK1010;} $ZZZZZZZZh7 = array("%".$ZZZZZZZZZZZZL1111."%");break;}}else{$ZZS1818 = " ";} return array("sql"=>$ZZS1818,"param"=>$ZZZZZZZZh7);} function ZZZZZZZZZZZZM1212($ZZZZZZZZZZZZN1313,$ZZZc2){$ZZS1818 = "AND ";if($ZZZZZZZZZZZZN1313->connector =="OR"){$ZZS1818 = "OR ";} $ZZS1818.="(1=1 ";$ZZT1919 = count($ZZZZZZZZZZZZN1313->filters);$ZZZF55 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = $this->ZZZZZZZZZZZZk10($ZZZZZZZZZZZZN1313->filters[$Zf5],$ZZZc2);$ZZS1818.= $ZZZZZC22["sql"] . " ";if($ZZZZZC22["param"]!==null){if(is_array($ZZZZZC22["param"])){$ZZZF55 = array_merge($ZZZF55,$ZZZZZC22["param"]);}else{$ZZZF55[] = $ZZZZZC22["param"];}}} $ZZS1818.= ") ";return array("sql"=>$ZZS1818,"params"=>$ZZZF55);} function ZZZZZZZZZZZZO1414($ZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZQ1616,$ZZZT1919){$ZZT1919 = count($ZZZZZZZZZZZZQ1616);$ZZZZc2 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZQ1616[$Zf5]])){$ZZZZc2[] = $ZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZQ1616[$Zf5]];}} if(count($ZZZT1919) > 0){foreach($ZZZT1919 as $ZZZZZZZZZZZD33) {$ZZZZc2[] = array('tablename' => $ZZZZZZZZZZZD33['table'], 'columnname' => $ZZZZZZZZZZZD33['column'], 'fieldname' => $ZZZZZZZZZZZD33['name'], 'fieldlabel' => $ZZZZZZZZZZZD33['bareTitle'], 'uitype' => $ZZZZZZZZZZZD33['uitype'], 'typeofdata' => 'V~O', 'module' => 'X',);}} return $ZZZZc2;} function ZZZZZZZZZZZZR1717($ZZZZZZZZZZu20){$ZZZc2 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2 = array_merge($ZZZc2,$ZZZZZZZZZZu20[$Zf5]->ZZZZZZZZZZg6($Zf5));} return $ZZZc2;} function ZZZZZZZZZZZZS1818($ZZZZZZZZZZu20){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array();} return $ZZS1818;} function ZZZZZZZZZZZZT1919($ZZZZZZZZZZu20){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZu20[$Zf5]->ZZZZZZZZZZZP1515();} return $ZZS1818;} function ZZZZZZZZZZZZU2020($ZZZZZZZZZZu20){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZu20);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZu20[$Zf5]->ZZZZZZZZZZZZV2121();} return $ZZS1818;} function ZZZZZZZZZZZZW2222(){$ZZq16 = " AND (1=1 ";$ZZT1919 = count($this->ZZZZZZZZZZZa0);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZX2323[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"])){if(!isset($this->ZZZZZZZZZZR1717[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"])){$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZX2323[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"],false,$this->ZZZZZZZZZZZa0[$Zf5]);} $ZZq16.= "AND (`".$this->ZZZZZZZZZZR1717[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"]."`.`deleted` = 0 ";$ZZq16.= "OR `".$this->ZZZZZZZZZZR1717[$this->ZZZZZZZZZZZa0[$Zf5]]["vtiger_crmentity"]."`.`deleted` IS NULL) ";}} $ZZq16.=")";return $ZZq16;} function ZZZZZZZZZZZZX2323($ZZZZZZZZZZZZY2424,$includeDetails = false){$ZZS1818 = "";$ZZZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZY2424);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]]) && isset($ZZZZZZZZZZZZY2424[$Zf5]["sortDirection"]) && isset($ZZZZZZZZZZZZY2424[$Zf5]["sortAction"]) && in_array($ZZZZZZZZZZZZY2424[$Zf5]["sortAction"],array("sort","groupsort"))){$ZZZZS1818[] = $this->ZZZZZZZZZZZU2020($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]],$ZZZZZZZZZZZZY2424[$Zf5],$includeDetails);}} if(!empty($ZZZZS1818)){$ZZS1818= " ORDER BY ".implode(" , ",$ZZZZS1818);} return $ZZS1818;} function ZZZZZZZZZZZZZ2525($module){$ZZS1818 = $this->ZZZZZe4->ZZZZZw22($module->name,$module->name);if($module->relationDescr!==null){$ZZS1818 = $this->ZZZZZZZZZZZZZ2525($this->ZZZZZJ99[$module->relationDescr->joinModule])."-".$ZZS1818;} return $ZZS1818;} function ZZZZZZZZZZZZZa0($module,$ZZZZZJ99,$ZZZZZZZZZZZZQ1616,$ZZZT1919){$this->ZZZZZJ99 = array_merge(array($module),$ZZZZZJ99);$this->ZZZZZZZZZZR1717 = $this->ZZZZZZZZZZZZS1818($this->ZZZZZJ99);$this->ZZZZZZZZZZS1818 = array();$this->ZZZZZZZZZZZd3 = array();$this->ZZZZZZZZZZZf5 = array();$this->ZZZZZZZZZZU2020 = 0;$this->ZZZZZZZZZZX2323 = $this->ZZZZZZZZZZZZU2020($this->ZZZZZJ99);$this->ZZZZZZZZZZY2424 = $this->ZZZZZZZZZZZZT1919($this->ZZZZZJ99);$this->ZZZZZZZZZZZa0 = array(0);$this->ZZZZZZZZZZZe4 = array();$this->ZZZZZZZZZZZb1 = $this->ZZZZZZZZZZZZR1717($this->ZZZZZJ99);$this->ZZZZZZZZZZZc2 = $this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZZb1,$ZZZZZZZZZZZZQ1616,$ZZZT1919);$this->ZZZZZZZZZZZr17($this->ZZZZZZZZZZY2424[0],true);$ZZT1919 = count($this->ZZZZZJ99);if($this->ZZZZZZZZZZV2121 == true){for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZW2222[$Zf5] = $this->ZZZZZZZZZZZZZ2525($this->ZZZZZJ99[$Zf5])." ";}}else{for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZW2222[$Zf5] = "";}}} function ZZZZZZZZZZZZZb1($field,$ZZZZZZZZZZZZZc2,$ZZZZZZZZZZZZZd3, $ZZZZZZZZZZZA00 = true, $ZZZZZZZZZZZD33 = array()){$ZZZH77 = $this->ZZZZZZZZZZZC22($field,$ZZZZZZZZZZZZZc2,$ZZZZZZZZZZZZZd3, $ZZZZZZZZZZZA00, $ZZZZZZZZZZZD33);if(!$ZZZH77) {return false;} foreach($ZZZH77["fields"] as $Zu20=>$fieldName){$this->ZZZZZZZZZZZd3[$fieldName] = $ZZZH77["titles"][$Zu20];} $this->ZZZZZZZZZZZe4 = array_merge($this->ZZZZZZZZZZZe4,$ZZZH77["select"]);} function ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33){$ZZZZZZZZZZZZZe4 = array("avg" => array("args" => 1, "isExpr" => false, "fn" => "AVG",), "cnt" => array("args" => 1, "isExpr" => false, "fn" => "COUNT",), "min" => array("args" => 1, "isExpr" => false, "fn" => "MIN",), "max" => array("args" => 1, "isExpr" => false, "fn" => "MAX",), "sum" => array("args" => 1, "isExpr" =>false, "fn" => "SUM",), "plus" => array("args" => 2, "isExpr" =>true, "fn" => "+",), "minus" => array("args" => 2, "isExpr" =>true, "fn" => "-",), "mult" => array("args" => 2, "isExpr" =>true, "fn" => "*",), "div" => array("args" => 2, "isExpr" =>true, "fn" => "/",),);$ZZS1818 = "NULL";if(isset($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]) && count($ZZZZZZZZZZZD33["val"]) == $ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["args"] && count($ZZZZZZZZZZZD33["valType"]) == $ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["args"]){$ZZZH77 = array();for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["args"];$Zf5++){$ZZZZZZZZZZZZZf5 = "NULL";if(isset($ZZZZZZZZZZZD33["valType"][$Zf5]) && isset($ZZZZZZZZZZZD33["val"][$Zf5])){if($ZZZZZZZZZZZD33["valType"][$Zf5] == "c"){$ZZZZZC22 = str_replace(",",".",$ZZZZZZZZZZZD33["val"][$Zf5]);if(preg_match("/^([0-9]+)(\\.|,)?[0-9]{0,}$/",$ZZZZZC22)){$ZZZZZZZZZZZZZf5 = $ZZZZZC22;}}elseif($ZZZZZZZZZZZD33["valType"][$Zf5] == "f"){if(isset($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZD33["val"][$Zf5]])){$ZZZZZC22 = $this->ZZZZZZZZZZZC22($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZD33["val"][$Zf5]],null,null,false,false);$ZZZZZZZZZZZZZf5 = $ZZZZZC22["select"][0];}}elseif($ZZZZZZZZZZZD33["valType"][$Zf5] == "op"){$ZZZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZQ1616($ZZZZZZZZZZZD33["val"][$Zf5]);}} $ZZZH77[] = $ZZZZZZZZZZZZZf5;} if($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["isExpr"]){$ZZS1818 = "(". implode($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["fn"],$ZZZH77) .")";}else{$ZZS1818 = $ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["fn"]."(".implode($ZZZZZZZZZZZZZe4[$ZZZZZZZZZZZD33["op"]]["fn"],$ZZZH77) .")";}} return $ZZS1818;} function ZZZZZZZZZZZZZg6($ZZZc2){$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZH77 = "ROUND(".$this->ZZZZZZZZZZZQ1616($ZZZc2[$Zf5]["val"]).", {$ZZZZZZZZZZZF55}) AS `".$ZZZc2[$Zf5]['name']."`";$this->ZZZZZZZZZZZe4[] = $ZZZH77;$this->ZZZZZZZZZZZd3[$ZZZc2[$Zf5]['name']] = $ZZZc2[$Zf5]["title"];}} function ZZZZZZZZZZZZZh7($filters){$ZZT1919 = count($filters);$ZZZF55 = array();$ZZZZd3 = " WHERE (1=1 ";for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = $this->ZZZZZZZZZZZZM1212($filters[$Zf5],$this->ZZZZZZZZZZZb1);$ZZZZd3.= $ZZZZZC22["sql"];if(!empty($ZZZZZC22["params"])){$ZZZF55 = array_merge($ZZZF55,$ZZZZZC22["params"]);}} $this->ZZZZZZZZZZZf5 = $ZZZF55;$ZZZZd3.= ") ".$this->ZZZZZZZZZZZZW2222();return $ZZZZd3;} function ZZZZZZZZZZZZZi8(ZZZZZZZZZZH77 $module,$ZZZZZZZZZZZZQ1616,$filters,$ZZZZZJ99 = array(),$ZZZZZZZZZZZZY2424 = array(),$ZZZP1515 = array(),$ZZZZZZZZZZZZZj9 = false, $ZZZT1919 = array(), $ZZZZZZZZZZZZZk10 = array()){$ZZZZZZZZZZZZZl11 = array();$this->ZZZZZZZZZZZZZa0($module,$ZZZZZJ99,$ZZZZZZZZZZZZQ1616,$ZZZT1919);$ZZZO1414 = array();if($ZZZZZZZZZZZZZj9 == false){$ZZT1919 = count($this->ZZZZZZZZZZZc2);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){foreach($ZZZZZZZZZZZZY2424 as $ZZZZZZZZZZZZZm12) {if($this->ZZZZZZZZZZZc2[$Zf5]['fieldname'] == $ZZZZZZZZZZZZZm12['name']) {if(!empty($ZZZZZZZZZZZZZm12['dateGrouping'])) {array_push($ZZZZZZZZZZZZZl11, $this->ZZZZZZZZZZZc2[$Zf5]['fieldname']);$this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZc2[$Zf5], null, $ZZZZZZZZZZZZZm12['dateGrouping']);}}} if(!in_array($this->ZZZZZZZZZZZc2[$Zf5]['fieldname'], $ZZZZZZZZZZZZZl11)) {if($this->ZZZZZZZZZZZc2[$Zf5]['tablename'] !== '__virtual__') {$this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZc2[$Zf5],null,null);}}} $this->ZZZZZZZZZZZZZg6($ZZZT1919);} else{$ZZT1919 = count($ZZZZZZZZZZZZY2424);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]])){$ZZZZZZZZZZZZZd3 = null;if(isset($ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"]) && isset($this->ZZZZZZZZZZZg6[$ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"]])){$ZZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"];} if(isset($ZZZZZZZZZZZZY2424[$Zf5]["sortAction"]) && $ZZZZZZZZZZZZY2424[$Zf5]["sortAction"] =="nogroup"){$ZZZZZZZZZZZZZd3 = "nogroup";} $this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]],null,$ZZZZZZZZZZZZZd3);$ZZZH77 = $this->ZZZZZZZZZZZR1717($this->ZZZZZZZZZZZb1[$ZZZZZZZZZZZZY2424[$Zf5]["name"]],$ZZZZZZZZZZZZY2424[$Zf5]);if(!empty($ZZZH77)){$ZZZO1414[] = $ZZZH77;}}} $ZZT1919 = count($ZZZP1515);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZZb1[$ZZZP1515[$Zf5]["selectedField"]])){$this->ZZZZZZZZZZZZZb1($this->ZZZZZZZZZZZb1[$ZZZP1515[$Zf5]["selectedField"]],$ZZZP1515[$Zf5]["value"],null);} foreach($ZZZT1919 as $ZZZZZZZZZZZD33) {if($ZZZZZZZZZZZD33["name"] == $ZZZP1515[$Zf5]["selectedField"]) {$this->ZZZZZZZZZZZZZb1(null, $ZZZP1515[$Zf5]["value"], null, true, $ZZZZZZZZZZZD33);}}} $ZZT1919 = count($ZZZZZZZZZZZZY2424);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"]) && !empty($ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"])){foreach($this->ZZZZZZZZZZZc2 as &$ZZZZZZZZZZZZZn13) {if($ZZZZZZZZZZZZZn13['fieldname'] == $ZZZZZZZZZZZZY2424[$Zf5]["name"]) {$ZZZZZZZZZZZZZn13['fieldname'] = $ZZZZZZZZZZZZZn13['fieldname'] . "_" . $ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"];$ZZZZZZZZZZZZZn13['dateGrouping'] = $ZZZZZZZZZZZZY2424[$Zf5]["dateGrouping"];}}}}} $ZZZZd3 = $this->ZZZZZZZZZZZZZh7($filters);$ZZZZS1818 = $this->ZZZZZZZZZZZZX2323($ZZZZZZZZZZZZY2424,!$ZZZZZZZZZZZZZj9);$ZZZZJ99 = "";if(!empty($ZZZO1414)){$ZZZZJ99= " GROUP BY ".implode(" , ",$ZZZO1414);} if(in_array($this->ZZZZZZZZZZY2424[0]['name'], array('oqc_offering'))) {$ZZZZZZZZZZZZZo14 = $this->ZZZZZZZZZZR1717[0][$this->ZZZZZZZZZZY2424[0]['name']];$ZZZZd3 .= " AND `$ZZZZZZZZZZZZZo14`.`is_latest` = 1 ";} $ZZZZZZZZZZX2323 = $this->ZZZZZZZZZZZZZp15($ZZZZZZZZZZZZY2424, $filters, $this->ZZZZZZZZZZY2424[0]['name'], $this->ZZZZZZZZZZS1818);$ZZZZZZZZZZZZZq16 = array();foreach($ZZZZZZZZZZZZY2424 as $ZZZZZZZZZZZZZr17) {if(in_array($ZZZZZZZZZZZZZr17['name'], $ZZZZZZZZZZZZZq16)) {continue;} if(isset($ZZZZZZZZZZZZZr17['showTop']) && $ZZZZZZZZZZZZZr17['showTop'] > 0) {$ZZZZZZZZZZZZZq16[] = $ZZZZZZZZZZZZZr17['name'];$this->ZZZZZZZZZZZf5 = array_merge($this->ZZZZZZZZZZZf5, $this->ZZZZZZZZZZZf5);}} $ZZq16 ="SELECT ".implode(" , ",$this->ZZZZZZZZZZZe4);$ZZq16.= " FROM ".$ZZZZZZZZZZX2323['mainTable']. " AS ".$this->ZZZZZZZZZZR1717[0][$this->ZZZZZZZZZZY2424[0]['name']];$ZZq16.= " ".implode(" ", $ZZZZZZZZZZX2323['joinTables']);$ZZq16.= $ZZZZd3;$ZZq16.= $ZZZZJ99;$ZZq16.= $ZZZZS1818;$ZZZZZZZZZZZZZs18 = $this->ZZZZZZZZZZZZZt19($ZZq16, $this->ZZZZZZZZZZZf5, $ZZZZZZZZZZZZZk10);$ZZq16.= $ZZZZZZZZZZZZZs18["sql"];return array("sql" => $ZZq16, "params" => $this->ZZZZZZZZZZZf5, "cols" => $this->ZZZZZZZZZZZd3, "fields" => $this->ZZZZZZZZZZZc2, "meta" => $ZZZZZZZZZZZZZs18["meta"],);} function ZZZZZZZZZZZZZt19($ZZq16, $ZZZF55, $ZZZZZZZZZZZZZk10){$ZZZZZZZZZZZZZs18 = array("meta" => array(), "sql" => '');if(!isset($ZZZZZZZZZZZZZk10["pagination"])) {$ZZZZZZZZZZZZZk10["pagination"] = false;} if(!isset($ZZZZZZZZZZZZZk10['records']) && $ZZZZZZZZZZZZZk10["pagination"]) {$query = 'SELECT COUNT(*) AS `COUNT` FROM ('.$ZZq16.') AS `counterTable`';$ZZn13 = $this->db->ZZZE44($query, $ZZZF55);$ZZZZZZZZZZZZZk10['records'] = (int) $ZZn13[0]['COUNT'];} if(isset($ZZZZZZZZZZZZZk10['records']) && isset($ZZZZZZZZZZZZZk10['limit']) && $ZZZZZZZZZZZZZk10["pagination"]) {$limit = (int) $ZZZZZZZZZZZZZk10['limit'];$ZZZZZZZZZZZZZu20 = 0;if($ZZZZZZZZZZZZZk10['records'] > 0 && $limit > 0) {$ZZZZZZZZZZZZZu20 = (int) ceil($ZZZZZZZZZZZZZk10['records'] / $limit);} $ZZZZZZZZZZZZZk10['pages'] = $ZZZZZZZZZZZZZu20;if(isset($ZZZZZZZZZZZZZk10['currentPage'])) {if($ZZZZZZZZZZZZZk10['currentPage'] > $ZZZZZZZZZZZZZk10['pages']) {$ZZZZZZZZZZZZZk10['currentPage'] = 1;} $ZZZZZZZZe4 = ($ZZZZZZZZZZZZZk10['currentPage'] - 1) * $limit;} else {$ZZZZZZZZe4 = 0;$ZZZZZZZZZZZZZk10['currentPage'] = 1;} $ZZZZZZZZZZZZZs18["sql"] = " LIMIT $ZZZZZZZZe4, $limit";} $ZZZZZZZZZZZZZs18["meta"] = $ZZZZZZZZZZZZZk10;return $ZZZZZZZZZZZZZs18;} function ZZZZZZZZZZZZZv21($ZZZZZZZZZZZZY2424, $filters) {$ZZZZZZZZZZZZZw22 = array('limit' => 0, 'column' => false, 'sortDirection' => 'DESC', 'table' => false, 'tableAlias' => false, 'sql' => '',);if(empty($ZZZZZZZZZZZZY2424)) {return false;} $ZZZZZZi8 = 0;foreach($ZZZZZZZZZZZZY2424 as $ZZZZZZZZZZZZZx23 => $ZZZZZZZZZZZZZy24){if(isset($ZZZZZZZZZZZZZy24['showAggregates'])) {$ZZZZZZi8 = $ZZZZZZZZZZZZZx23;break;}} if(!isset($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop']) || empty($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop'])) {return false;} if($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop'] > 0) {$ZZZZZZZZZZZZZw22['limit'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['showTop'];$ZZZZZZZZZZZZZw22['field'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['name'];$ZZZZZZZZZZZZZw22['aggregate'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['aggregate'];$ZZZZZZZZZZZZZw22['aggregateSortDirection'] = $ZZZZZZZZZZZZY2424[$ZZZZZZi8]['sortDirection'];$ZZZ2525 = $this->ZZZZZZZZZZZZZz25($ZZZZZZZZZZZZY2424[$ZZZZZZi8]['name']);$ZZZZZZZZZZZZZw22 = array_merge($ZZZZZZZZZZZZZw22, $ZZZ2525);if($ZZZZZZZZZZZZZw22['aggregate']) {$ZZZZZZZZZZZZZA00 = false;$ZZZZZZZZZZZZZw22['aggregateTable'] = false;$ZZZZZZZZZZZZZw22['aggregateTableAlias'] = false;$ZZZZZC22 = explode("_", $ZZZZZZZZZZZZZw22['aggregate'], 2);if(in_array($ZZZZZC22[0], array("sum", "avg", "count"))) {$ZZZZZZZZZZZZZA00 = $ZZZZZC22[0];array_shift($ZZZZZC22);$ZZZZZZZZZZZZZB11 = $ZZZZZC22[0];} else {$ZZZZZZZZZZZZZB11 = $ZZZZZZZZZZZZZw22['aggregate'];} $ZZZ2525 = $this->ZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZw22['aggregateType'] = $ZZZZZZZZZZZZZA00;$ZZZZZZZZZZZZZw22['aggregateColumn'] = $ZZZ2525['column'];$ZZZZZZZZZZZZZw22['aggregateTable'] = $ZZZ2525['table'];$ZZZZZZZZZZZZZw22['aggregateTableAlias'] = $ZZZ2525['tableAlias'];$ZZZZZZZZZZZZZw22['aggregateColumn'] = str_replace("#alias#", $ZZZ2525['tableAlias'], $ZZZZZZZZZZZZZw22['aggregateColumn']);} $ZZZZx23 = $ZZZZZZZZZZZZZw22['table'];$ZZZZZZZZZZZZZo14 = $ZZZZZZZZZZZZZw22['tableAlias'];$ZZZZZZZW2222 = $ZZZZZZZZZZZZZw22['column'];$limit = $ZZZZZZZZZZZZZw22['limit'];$aggregateColumn= $ZZZZZZZZZZZZZw22['aggregateColumn'];$ZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZw22['aggregateTableAlias'];$ZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZZw22['aggregateSortDirection'];$ZZZZZZZZZZZZZA00 = $ZZZZZZZZZZZZZw22['aggregateType'];$ZZZZZZZZZZZZZE44 = " `$ZZZZZZZZZZZZZC22`.`$aggregateColumn` ";if($ZZZZZZZZZZZZZA00 && in_array(strtoupper($ZZZZZZZZZZZZZA00), array('SUM', 'COUNT', 'AVG'))) {$ZZZZZZZZZZZZZE44 = " $ZZZZZZZZZZZZZA00($ZZZZZZZZZZZZZE44) ";} $ZZZZd3 = $this->ZZZZZZZZZZZZZh7($filters);$ZZq16 = "SELECT * FROM `".$ZZZZx23."` WHERE `".$ZZZZx23."`.`".$ZZZZZZZW2222."` IN (SELECT * FROM (SELECT `".$ZZZZZZZZZZZZZo14."`.`".$ZZZZZZZW2222."` FROM `".$this->ZZZZZZZZZZY2424[0]['name']."` AS ".$this->ZZZZZZZZZZR1717[0][$this->ZZZZZZZZZZY2424[0]['name']]." ".implode("\n", $this->ZZZZZZZZZZS1818)." $ZZZZd3 GROUP BY `".$ZZZZZZZZZZZZZo14."`.`".$ZZZZZZZW2222."` ORDER BY $ZZZZZZZZZZZZZE44 ".$ZZZZZZZZZZZZZD33." LIMIT $limit) AS tmp_limit_table) ";$ZZZZZZZZZZZZZw22['sql'] = "($ZZq16)";} return $ZZZZZZZZZZZZZw22;} function ZZZZZZZZZZZZZz25($field) {$r17 = array();foreach($this->ZZZZZZZZZZZb1 as $ZZZZZZZZZZZZZF55) {if ($ZZZZZZZZZZZZZF55['fieldname'] == $field) {$r17['column'] = $ZZZZZZZZZZZZZF55['columnname'];$r17['table'] = $ZZZZZZZZZZZZZF55['tablename'];$r17['tableAlias'] = $this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZZF55['module']][$ZZZZZZZZZZZZZF55['tablename']];break;}} return $r17;} function ZZZZZZZZZZZZZp15($ZZZZZZZZZZZZY2424, $filters, $ZZZZZZZZZZY2424, $ZZZZZZZZZZZZZG66) {$ZZZZZZZZZZZZZw22 = $this->ZZZZZZZZZZZZZv21($ZZZZZZZZZZZZY2424, $filters);if($ZZZZZZZZZZZZZw22) {if($ZZZZZZZZZZY2424 == $ZZZZZZZZZZZZZw22['table']) {$ZZZZZZZZZZY2424 = $ZZZZZZZZZZZZZw22['sql'];} foreach($ZZZZZZZZZZZZZG66 as &$ZZZZZZZZZZZX2323) {$ZZZZZZZZZZZZZH77 = strpos($ZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZw22['table']);if($ZZZZZZZZZZZZZH77) {$ZZZZZZZZZZZX2323 = str_replace("`".$ZZZZZZZZZZZZZw22['table']."`", $ZZZZZZZZZZZZZw22['sql'], $ZZZZZZZZZZZX2323);break;}}} $r17 = array('mainTable' => $ZZZZZZZZZZY2424, 'joinTables' => $ZZZZZZZZZZZZZG66,);return $r17;}} class ZZZZZZZZZZZZZI88{protected $db;protected $ZZZZZe4;protected $ZZZR1717 = array();function __construct(ZZp15 $db, ZZZZZf5 $ZZZZZe4, $ZZZR1717 = array()){$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZR1717 = $ZZZR1717;} function translate($Zu20,$ZZZZZZZZZZZZZJ99 = false) {if(isset($this->ZZZR1717[$Zu20])) {return $this->ZZZR1717[$Zu20];} return $ZZZZZZZZZZZZZJ99;} function ZZZZZZZZZZZZZK1010($G66) {$ZZZZZZZZZZZZZL1111 = array();foreach($G66 as $Zu20 => $value) {$ZZZZZZZZZZZZZM1212 = $this->translate($Zu20);if($ZZZZZZZZZZZZZM1212) {$value = $ZZZZZZZZZZZZZM1212;} $ZZZZZZZZZZZZZL1111[$Zu20] = $value;} return $ZZZZZZZZZZZZZL1111;} function ZZZZZZZZZZZZZN1313($module,$ZZZZc2,$filters,$ZZZZZJ99 = array(),$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9 = false,$isCrosstab = true,$ZZZZZZZZZZZZZO1414 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd",$ZZZZZZZZZZZZZP1515 = false, $ZZZT1919 = array(), $ZZZZZZZZZZZZZk10 = array(), ARUser $ZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZZZZR1717 = new ZZZZZZZZZZQ1616($this->db,$this->ZZZZZe4, false, $ZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZS1818 = array();$ZZT1919 = count($ZZZZZJ99);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZS1818[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);} $ZZq16 = $ZZZZZZZZZZZZZR1717->ZZZZZZZZZZZZZi8($module,$ZZZZc2,$filters,$ZZZZZZZZZZZZZS1818,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9,$ZZZT1919,$ZZZZZZZZZZZZZk10);$this->db->ZZZI88("SET NAMES utf8", array());$ZZS1818 = $this->db->ZZZE44($ZZq16["sql"],$ZZq16["params"]);array_unshift($ZZZZZZZZZZZZZS1818,$module);$ZZZZZZZZZZZZZT1919 = new ZZZZZZZZZZZZZU2020($ZZZO1414,$ZZq16["fields"],$ZZZZZZZZZZZZZj9);$ZZZZZZZZZZZZZT1919->ZZZZZZZZZZZZZV2121($ZZS1818);$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZX2323($this->ZZZZZe4,$this->db,$ZZq16["fields"],$ZZZO1414,$ZZZZZZZZZZZZZS1818,$dateFormat,$ZZZZZZZZZZZZZP1515);$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818);$ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZK1010($ZZq16["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){if($aggregateColumn){$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZ2525($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);}else{$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZa0($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);} $ZZS1818 = $ZZZZZZZZZZZZZY2424->ZZZZZZZZZZZZZZb1($ZZS1818,$ZZZO1414,$ZZZP1515,$ZZq16["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZK1010($ZZS1818["cols"]);if($ZZZZZZZZZZZZZO1414){$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZZc2();$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818["data"]);} $ZZS1818["meta"] = $ZZq16["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZZd3($ZZZZZZZZZZZZZS1818, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);return $ZZS1818;} function ZZZZZZZZZZZZZZd3($ZZZZZZZZZZu20, $ZZZZZZZZZZZn13, $r17, $isCrosstab = false, $aggregateColumn = false) {$ZZZZZZZZZZZZZZe4 = array();if(!$aggregateColumn) {$ZZZZZZZZZZZZZZf5 = array();foreach ($ZZZZZZZZZZZn13 as $ZZZZy24 => $title) {$ZZZZZZZZZZZZZZg6 = strstr($ZZZZy24,'_');if(in_array(substr($ZZZZZZZZZZZZZZg6, -4), array('_sum','_min','_max','_cnt'))){if($isCrosstab){$ZZZZZZZZZZZZZZg6 = strstr(ltrim(substr($ZZZZZZZZZZZZZZg6,0,-4),'_'),'_');} else {$ZZZZZZZZZZZZZZg6 = substr($ZZZZZZZZZZZZZZg6,0,-4);}} $ZZZZZZZZZZZZZZf5[$ZZZZy24] = $ZZZZZZZZZZZZZZg6;} foreach ($ZZZZZZZZZZu20 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZZh7();foreach ($ZZZc2 as $field) {if(in_array(strstr($field['name'],'_'), $ZZZZZZZZZZZZZZf5)){$ZZZZZZZZZZZZZZi8 = array_keys($ZZZZZZZZZZZZZZf5, strstr($field['name'],'_'));foreach ($ZZZZZZZZZZZZZZi8 as $ZZZZZZZZZZZZZZj9) {$ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZj9] = $field['type'];}}}}} else {$ZZZZZZZZZZZZZZk10 = array();foreach ($ZZZZZZZZZZu20 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZZh7();foreach ($ZZZc2 as $field) {if($field['type'] == 'integer'){$ZZZZZZZZZZZZZZk10[] = $field['name'];}}} $ZZZZZZZZZZZZZZl11 = array();foreach ($this->ZZZR1717 as $Zu20 => $ZZZZZx23) {$ZZZZZZZZZZZB11 = substr($Zu20, -4);if($ZZZZZZZZZZZB11 == '_cnt' || in_array($Zu20, $ZZZZZZZZZZZZZZk10)) {$ZZZZZZZZZZZZZZe4[$ZZZZZx23] = 'integer';} elseif (in_array($ZZZZZZZZZZZB11, array('_sum','_min','_max'))) {foreach ($ZZZZZZZZZZZZZZk10 as $field) {if(strpos($Zu20, $field) !== false){$ZZZZZZZZZZZZZZe4[$ZZZZZx23] = 'integer';}}}}} return $ZZZZZZZZZZZZZZe4;}}
class ZZZZZZZZZZZZZZm12 extends ZZZZZZZZZZZZZI88{protected $ZZZZZZZZZZZZZZn13 = array();protected $ZZZZZZZZZZZZZZo14 = array();protected $ZZZZZZZZZZZZZZp15 = array();protected $ZZZZZZZZZZZZZZq16 = array();protected $ZZZZZZZZZZZZZZr17 = array();protected $ZZZZZZZZZZZZZZs18 = "";protected $ZZZZZZZZZZZZZZt19 = array();protected $ZZZZZZZZZZZZZZu20 = array();protected $ZZZY2424 = array();function ZZZZZZZZZZZZZZv21($ZZZZZZZZZZu20){$ZZT1919 = count($ZZZZZZZZZZu20);$ZZS1818 = 0;$ZZZZZZZZZZZZZZw22 = array();$ZZZZZZZZZZZZZZx23 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZu20[$Zf5]->joinModule == 0){$ZZZZZZZZZZu20[$Zf5]->joinModule = -1;$this->ZZZZZZZZZZZZZZn13[] = $Zf5;$ZZZZZZZZZZZZZZw22[$Zf5+1] = array();$ZZS1818++;} if($ZZZZZZZZZZu20[$Zf5]->joinModule>-1 && $ZZZZZZZZZZZZZZx23[$ZZZZZZZZZZu20[$Zf5]->joinModule]){$ZZZZZZZZZZZZZZw22[$ZZZZZZZZZZZZZZx23[$ZZZZZZZZZZu20[$Zf5]->joinModule]][$Zf5] = $ZZZZZZZZZZu20[$Zf5]->name;$ZZZZZZZZZZZZZZx23[$Zf5+1] = $ZZZZZZZZZZZZZZx23[$ZZZZZZZZZZu20[$Zf5]->joinModule];}else{$ZZZZZZZZZZZZZZx23[$Zf5+1] = $Zf5+1;}} if(!empty($ZZZZZZZZZZZZZZw22)){$this->ZZZZZZZZZZZZZZq16 = array_values(call_user_func_array("array_intersect",$ZZZZZZZZZZZZZZw22));} $this->ZZZZZZZZZZZZZZr17 = array();foreach($ZZZZZZZZZZZZZZw22 as $ZZZZZZZZZZZZZZy24 => $ZZZZZZZZZZZZZZz25){foreach($ZZZZZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZA00 => $ZZZZZZZZZZZZZZB11){if(in_array($ZZZZZZZZZZZZZZB11,$this->ZZZZZZZZZZZZZZq16)){if(!isset($this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZB11])){$this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZB11] = array();} $this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZy24] = $ZZZZZZZZZZZZZZA00+1;}}} return $ZZS1818;} function ZZZZZZZZZZZZZZC22($module,$ZZZZZJ99){$ZZS1818 = unserialize(serialize($ZZZZZJ99));$ZZS1818[$module]->joinModule = -1;$ZZT1919 = count($ZZS1818);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZS1818[$Zf5]->joinModule == $module+1){$ZZS1818[$Zf5]->joinModule=0;}} $this->ZZZZZZZZZZZZZZo14 = array($module+1);$this->ZZZZZZZZZZZZZZp15 = array($module+1 => 0);do{$ZZZH77 = count($this->ZZZZZZZZZZZZZZo14);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if((in_array($ZZS1818[$Zf5]->joinModule,$this->ZZZZZZZZZZZZZZo14)||$ZZS1818[$Zf5]->joinModule==0) && !in_array($Zf5+1,$this->ZZZZZZZZZZZZZZo14)){$this->ZZZZZZZZZZZZZZo14[] = $Zf5+1;$this->ZZZZZZZZZZZZZZp15[$Zf5+1] = count($this->ZZZZZZZZZZZZZZp15);if(!$ZZS1818[$Zf5]->joinModule==0){$ZZS1818[$Zf5]->joinModule = $this->ZZZZZZZZZZZZZZp15[$ZZS1818[$Zf5]->joinModule];}}}}while($ZZZH77 < count($this->ZZZZZZZZZZZZZZo14));$ZZZZZZZZZZZZZZD33 = array();$ZZT1919 = count($this->ZZZZZZZZZZZZZZo14);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZD33[] = $ZZS1818[$this->ZZZZZZZZZZZZZZo14[$Zf5]-1];} return $ZZZZZZZZZZZZZZD33;} function ZZZZZZZZZZZZZZE44($filters){$ZZZH77 = unserialize(serialize($filters));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZH77[$Zf5];$ZZZZZZZZZZZZZZF55 = count($ZZZH77[$Zf5]->filters);$ZZZZZZZZZZZZZZG66 = array();for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5]->filters[$ZZZZZW2222]->fieldName,2);if(!in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZZZZZZZZZZZZZG66[] = $ZZZZZW2222;}else{$ZZZZZC22[0] = $this->ZZZZZZZZZZZZZZp15[$ZZZZZC22[0]];$ZZZH77[$Zf5]->filters[$ZZZZZW2222]->fieldName = $ZZZZZC22[0]."_".$ZZZZZC22[1];}} $ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZG66)-1;for($ZZZZZW2222 = $ZZZZZZZZZZZZZZF55;$ZZZZZW2222>-1;$ZZZZZW2222--){array_splice($ZZS1818[$Zf5]->filters,$ZZZZZZZZZZZZZZG66[$ZZZZZW2222],1);}} return $ZZS1818;} function ZZZZZZZZZZZZZZH77($ZZZc2,$module){$ZZZH77 = unserialize(serialize($ZZZc2));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5],2);if(in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZS1818[] = array_search($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)."_".$ZZZZZC22[1];}elseif($ZZZZZC22[0]=="00"){$ZZZZZZZZZZZZZZI88 = explode("_",$ZZZZZC22[1],2);$ZZS1818[] = "0_".$module."_".$ZZZZZZZZZZZZZZI88[1];}} return $ZZS1818;} function ZZZZZZZZZZZZZZJ99($ZZZZJ99,$module){$ZZZH77 = unserialize(serialize($ZZZZJ99));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5]["name"],2);$ZZZZZZZZZZZZZZI88 = explode("_",$ZZZZZC22[1],2);$ZZZZZZZZZZZZZZK1010 = $ZZZH77[$Zf5]["name"];if(in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZZH77[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZp15[$ZZZZZC22[0]]."_".$ZZZZZC22[1];}elseif(isset($this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZI88[0]])){$ZZZH77[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZp15[$this->ZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZI88[0]][$this->ZZZZZZZZZZZZZZo14[0]]]."_".$ZZZZZC22[1];if(!in_array($ZZZH77[$Zf5]["name"],$this->ZZZZZZZZZZZZZZt19)){$this->ZZZZZZZZZZZZZZt19[] = $ZZZH77[$Zf5]["name"];$this->ZZZZZZZZZZZZZZu20[$ZZZH77[$Zf5]["name"]] = $ZZZZZZZZZZZZZZK1010;}}elseif($ZZZH77[$Zf5]["name"] =="00_ALL_assigned_user_id"){$ZZZH77[$Zf5]["name"] = "0_".$module."_assigned_user_id";$this->ZZZZZZZZZZZZZZt19[] = $ZZZH77[$Zf5]["name"];$this->ZZZZZZZZZZZZZZu20[$ZZZH77[$Zf5]["name"]] = $ZZZZZZZZZZZZZZK1010;} if(isset($ZZZH77[$Zf5]["aggregate"]) && $ZZZH77[$Zf5]["aggregate"] == $ZZZZZZZZZZZZZZK1010){$ZZZH77[$Zf5]["aggregate"] = $ZZZH77[$Zf5]["name"];} $ZZS1818[] = $ZZZH77[$Zf5];} $this->commonFieldsCount = count($this->ZZZZZZZZZZZZZZt19);return $ZZS1818;} function ZZZZZZZZZZZZZZL1111($ZZZP1515){$ZZZH77 = unserialize(serialize($ZZZP1515));$ZZS1818 = array();$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZH77[$Zf5]["selectedField"],2);if(in_array($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZo14)){$ZZZH77[$Zf5]["selectedField"] = $this->ZZZZZZZZZZZZZZp15[$ZZZZZC22[0]]."_".$ZZZZZC22[1];$ZZS1818[] = $ZZZH77[$Zf5];}} return $ZZS1818;} function ZZZZZZZZZZZZZZM1212($ZZq16,$prefix){$ZZZZZZZZZZZZZZN1313 = "SELECT DISTINCT `date_field` ";$ZZZZZZZZZZZZZZt19 = "";if(!empty($this->commonFieldsCount)){$ZZZZZZZZZZZZZZt19 = array();$ZZT1919 = $this->commonFieldsCount;for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZt19[] = "c_".$Zf5;if($this->ZZZZZZZZZZZZZZu20[$this->ZZZZZZZZZZZZZZt19[$Zf5]]!=="00_ALL_assigned_user_id"){$ZZZZZC22 = explode("_",$this->ZZZZZZZZZZZZZZt19[$Zf5]);$field = $this->db->ZZU2020($ZZZZZC22[1],$ZZZZZC22[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZZe4->ZZZZZI88($field,$this->db,false,$ZZZZZC22[1])){$ZZZZZZZZZZZZZZt19[] = "c_".$Zf5."_setype";$ZZZZZZZZZZZZZZt19[] = "c_".$Zf5."_id";}}} $ZZZZZZZZZZZZZZt19 = ", ".implode(", ",$ZZZZZZZZZZZZZZt19);} $ZZZZZZZZZZZZZZN1313.= $ZZZZZZZZZZZZZZt19." FROM (";$ZZZZZZZZZZZZZZO1414 = array();$ZZT1919 = count($ZZq16);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZZZZZZZZZZZZO1414[] = "SELECT `date_field` $ZZZZZZZZZZZZZZt19 FROM ".$ZZq16[$Zf5]["table"];}} $ZZZZZZZZZZZZZZN1313.= implode(" UNION ",$ZZZZZZZZZZZZZZO1414);$ZZZZZZZZZZZZZZN1313.= ")`date_fields`";$ZZZZZZZZZZZZZZP1515 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_{$prefix}_union AS ($ZZZZZZZZZZZZZZN1313)";$this->ZZZZZZZZZZZZZZs18 = "ar_temp_".$prefix."_union";return $ZZZZZZZZZZZZZZP1515;} function ZZZZZZZZZZZZZZQ1616(&$ZZq16,$ZZZZZR1717){$ZZZZZZZZZZZZZZR1717 = array_keys($ZZq16["cols"]);$ZZZZZZZZZZZZZZN1313 = "SELECT ";$ZZZZZZZZZZZZZZN1313.= "`combined`.`{$ZZZZZZZZZZZZZZR1717[0]}` AS `date_field` ";array_shift($ZZZZZZZZZZZZZZR1717);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZN1313.= ", `combined`.`{$ZZZZZZZZZZZZZZR1717[$Zf5]}` AS `c_$Zf5` ";if($ZZZZZZZZZZZZZZR1717[$Zf5]!=="00_ALL_assigned_user_id"){$ZZZZZC22 = $this->db->ZZZm12($ZZZZZZZZZZZZZZR1717[$Zf5]);$field = $this->db->ZZU2020($ZZZZZC22[1],$ZZZZZC22[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZZe4->ZZZZZI88($field,$this->db,false,$ZZZZZC22[1])){$ZZZZZZZZZZZZZZN1313.=", `combined`.`{$ZZZZZZZZZZZZZZR1717[$Zf5]}_setype` AS `c_{$Zf5}_setype` ";$ZZZZZZZZZZZZZZN1313.=", `combined`.`{$ZZZZZZZZZZZZZZR1717[$Zf5]}_id` AS `c_{$Zf5}_id` ";}}} $ZZZZZZZZZZZZZZN1313.= " FROM ({$ZZq16["sql"]}) `combined`";$ZZZZZZZZZZZZZZP1515 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_$ZZZZZR1717 AS ($ZZZZZZZZZZZZZZN1313)";$ZZq16["table"] = "ar_temp_$ZZZZZR1717";$ZZq16["createTmpTable"] = $ZZZZZZZZZZZZZZP1515;$ZZq16["fixTable"] = "UPDATE ".$ZZq16["table"]." SET `date_field` ='-' WHERE `date_field` IS NULL";$ZZq16["removeTable"] = "DROP TEMPORARY TABLE IF EXISTS ".$ZZq16["table"];} function ZZZZZZZZZZZZZZS1818(&$ZZq16){$ZZZZZZZZZZZZZZR1717 = array_keys($ZZq16["cols"]);$ZZZH77 = array_shift($ZZZZZZZZZZZZZZR1717);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZZZZT1919 = array($ZZZH77=> $ZZq16["cols"][$ZZZH77]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZZZZZZZZZZZZZR1717[$Zf5],2);$ZZZZZZZZZZZm12 = array_search($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZp15);$ZZZZZZZZZZZZZZT1919[$ZZZZZZZZZZZm12."_".$ZZZZZC22[1]] = $ZZq16["cols"][$ZZZZZZZZZZZZZZR1717[$Zf5]];$ZZq16["sql"] = str_replace($ZZZZZZZZZZZZZZR1717[$Zf5],$ZZZZZZZZZZZm12."_".$ZZZZZC22[1],$ZZq16["sql"]);} $ZZT1919 = count($ZZq16["fields"]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZC22 = explode("_",$ZZq16["fields"][$Zf5]["fieldname"],2);$ZZZZZZZZZZZm12 = array_search($ZZZZZC22[0],$this->ZZZZZZZZZZZZZZp15);$ZZq16["fields"][$Zf5]["fieldname"] = $ZZZZZZZZZZZm12."_".$ZZZZZC22[1];$ZZq16["fields"][$Zf5]["module"] = $ZZZZZZZZZZZm12;} $ZZq16["cols"] = $ZZZZZZZZZZZZZZT1919;} function ZZZZZZZZZZZZZZU2020($ZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZZZZV2121,$ZZZZc2,$filters,$ZZZZZJ99 = array(),$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9 = false){$this->ZZZZZZZZZZZZZZt19 = array();$ZZZZZZZZZZZZZS1818 = array();$ZZZZZJ99 = $this->ZZZZZZZZZZZZZZC22($ZZZZZZZZZZZZZZV2121,$ZZZZZJ99);$ZZZZZZZZZZG66 = array_shift($ZZZZZJ99);$ZZT1919 = count($ZZZZZJ99);$filters = $this->ZZZZZZZZZZZZZZE44($filters);$ZZZZc2 = $this->ZZZZZZZZZZZZZZH77($ZZZZc2,$ZZZZZZZZZZG66->name);$ZZZO1414 = $this->ZZZZZZZZZZZZZZJ99($ZZZO1414,$ZZZZZZZZZZG66->name);$ZZZP1515 = $this->ZZZZZZZZZZZZZZL1111($ZZZP1515);if(count($ZZZZc2)== 0 || count($ZZZP1515)== 0 ||count($ZZZO1414)== 0){return null;} for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZS1818[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);} $module = new ZZZZZZZZZZH77($ZZZZZZZZZZG66->name,$this->db,$this->ZZZZZe4);$ZZq16 = $ZZZZZZZZZZZZZR1717->ZZZZZZZZZZZZZi8($module,$ZZZZc2,$filters,$ZZZZZZZZZZZZZS1818,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9);$this->ZZZZZZZZZZZZZZS1818($ZZq16);$ZZq16["commonFields"] = $this->ZZZZZZZZZZZZZZt19;return $ZZq16;} function ZZZZZZZZZZZZZZW2222($ZZZZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZR1717, $ZZZZZZZZZZZZZZY2424,$ZZZZZZZZZZZZZZs18,$ZZZO1414, $ZZZZZZZZZZZZZk10 = array()){$ZZZZZZZZZZS1818 = array();$ZZZZR1717 = array();$ZZZZZZZZZZZn13 = array("date_field"=>"Date");$ZZZc2 = array();$ZZT1919 = $this->commonFieldsCount;$ZZZZZZZZZZZZZZt19 = "";$ZZZZZZZZZZZZZZZ2525 = $ZZT1919;$field = array();$field["fieldname_org"] = "date_field";$field["fieldname"] = "date_field";$field["module"] = 0;$field["uitype"] = 'date';$ZZZc2[] = $field;if(!empty($ZZZZZZZZZZZZZZY2424[1]["commonFields"])){$ZZZZZZZZZZZZZZt19 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZt19[] = "`t{{i}}`.`c_".$Zf5."` = `u`.`c_".$Zf5."`";$ZZZZR1717[] = "`u`.`c_".$Zf5."` AS `".$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]."`";$ZZZZZC22 = explode("_",$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]],3);if($ZZZZZC22[0]=="00"){$field = array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "bareTitle"=>$this->ZZZZZe4->ZZZZZw22("Assigned To",$this->ZZZZZJ99[1]->name), "availableValues" =>array(),);}else{$field = $this->db->ZZU2020($ZZZZZC22[1],$ZZZZZC22[2]);} $field["fieldname_org"] = $field["fieldname"];$field["fieldname"] = $this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]];$field["module"] = $ZZZZZC22[0]-1;if($this->ZZZZZe4->ZZZZZI88($field,$this->db,false,$ZZZZZC22[1])){$ZZZZR1717[] = "`u`.`c_".$Zf5."_id` AS `".$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]."_id`";$ZZZZR1717[] = "`u`.`c_".$Zf5."_setype` AS `".$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]."_setype`";} $ZZZc2[] = $field;if($ZZZZZC22[0]=="00"){$ZZZZZZZZZZZn13[$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]] = "Assigned To";}else{$ZZZZZZZZZZZn13[$this->ZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZY2424[1]["commonFields"][$Zf5]]] = $this->ZZZZZe4->ZZZZZw22($ZZZZZC22[1],$ZZZZZC22[1])." ".$this->ZZZZZe4->ZZZZZw22($field["fieldlabel"],$ZZZZZC22[1]);}} $ZZZZZZZZZZZZZZt19 = " AND ".implode(" AND ",$ZZZZZZZZZZZZZZt19);} array_unshift($ZZZO1414,"tmp");$ZZT1919 = count($ZZZZZZZZZZZZZZY2424);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZY2424[$Zf5]!==null){$ZZZZZZZZZZS1818[$Zf5] = "LEFT JOIN ".$ZZZZZZZZZZZZZZY2424[$Zf5]["table"]." `t".$Zf5."` ON (`t".$Zf5."`.`date_field`=`u`.`date_field` ".str_replace("{{i}}",$Zf5,$ZZZZZZZZZZZZZZt19).")";$ZZZZZZZZZZZZZZR1717 = array_keys($ZZZZZZZZZZZZZZY2424[$Zf5]["cols"]);array_shift($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZR1717);for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZZZZZZZZZZZZZZ2525;$ZZZZZW2222++){array_shift($ZZZZZZZZZZZZZZR1717);} for($ZZZZZW2222=$ZZZZZZZZZZZZZZZ2525;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){$ZZZZR1717[] = "`t".$Zf5."`.`c_".$ZZZZZW2222."` AS `".$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222-$ZZZZZZZZZZZZZZZ2525]."`";$ZZZZZZZZZZZn13[$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222-$ZZZZZZZZZZZZZZZ2525]] = $ZZZZZZZZZZZZZZY2424[$Zf5]["cols"][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222-$ZZZZZZZZZZZZZZZ2525]];} array_shift($ZZZO1414);}} $ZZZZS1818 = array();$ZZT1919 = count($ZZZc2);if($ZZZO1414[0]["sortAction"] =="groupsort"){if($ZZZO1414[0]["sortDirection"]=="DESC"){$ZZZZZZZX2323 = "DESC";}else{$ZZZZZZZX2323 = "ASC";} if(isset($ZZZO1414[0]["dateGrouping"]) && ($ZZZO1414[0]["dateGrouping"]=="monthAndYear" ||$ZZZO1414[0]["dateGrouping"]=="weekAndYear")){$ZZZZS1818[] = "LEFT(`u`.`date_field`,4) $ZZZZZZZX2323, CAST(MID(`u`.`date_field`,6,2) AS UNSIGNED) $ZZZZZZZX2323";}else{$ZZZZS1818[] = "`u`.`date_field` $ZZZZZZZX2323 ";}} for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($ZZZc2[$Zf5]["fieldname"]== $ZZZO1414[$Zf5]["name"]){if($ZZZO1414[$Zf5]["sortAction"] =="groupsort"){if($ZZZO1414[$Zf5]["sortDirection"]=="DESC"){$ZZZZS1818[] = "`u`.c_".($Zf5-1)." DESC ";}else{$ZZZZS1818[] = "`u`.c_".($Zf5-1)." ASC ";}}}} if(!empty($ZZZZS1818)){$ZZZZS1818 = " ORDER BY ".implode(" ,",$ZZZZS1818);}else{$ZZZZS1818 = "";} $ZZq16 = "SELECT `u`.`date_field`, ";$ZZq16.= implode(", ",$ZZZZR1717);$ZZq16.= "FROM ".$ZZZZZZZZZZZZZZs18." `u` ";$ZZq16.= implode(" ",$ZZZZZZZZZZS1818).$ZZZZS1818;$ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZX2323,array());$ZZZZZZZZZZZZZs18 = $ZZZZZZZZZZZZZR1717->ZZZZZZZZZZZZZt19($ZZq16, array(), $ZZZZZZZZZZZZZk10);$ZZq16.= $ZZZZZZZZZZZZZs18["sql"];$ZZZZZZZZZZZZZZZa0 = "DROP TEMPORARY TABLE IF EXISTS ".$this->ZZZZZZZZZZZZZZs18;return array("sql" => $ZZq16, "params" => array(), "cols" => $ZZZZZZZZZZZn13, "fields" => $ZZZc2, "removeTable" => $ZZZZZZZZZZZZZZZa0, "meta" => $ZZZZZZZZZZZZZs18["meta"],);} function ZZZZZZZZZZZZZZZb1($ZZZZZJ99){$this->ZZZZZZZZZZZZZZv21($ZZZZZJ99);$ZZS1818 = array();foreach($this->ZZZZZZZZZZZZZZn13 as $ZZZZZZZZZZZZZZy24){$ZZS1818[] = $ZZZZZZZZZZZZZZy24+1;} return $ZZS1818;} function ZZZZZZZZZZZZZZZc2($ZZZZZJ99){$ZZZZZZZZZZZZZZZd3 = $this->ZZZZZZZZZZZZZZZb1($ZZZZZJ99);$ZZZZZZZZZZZZZZZe4 = array();$ZZZZZZZZZZZZZZZf5 = array("00");$ZZS1818 = array();$ZZT1919 = count($ZZZZZJ99);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZZJ99[$Zf5]->name,$this->ZZZZZZZZZZZZZZq16)){$ZZZZZZZZZZZZZZZf5[] = $Zf5+1;if(in_array($ZZZZZJ99[$Zf5]->name,$ZZZZZZZZZZZZZZZe4)){$ZZS1818[] = $Zf5;}else{$ZZZZZZZZZZZZZZZe4[] = $ZZZZZJ99[$Zf5]->name;}}} return array("skip"=>$ZZS1818,"common"=>$this->ZZZZZZZZZZZZZZq16,"commonIds"=>$ZZZZZZZZZZZZZZZf5);} function ZZZZZZZZZZZZZZZg6($ZZZc2){$this->ZZZY2424 = $ZZZc2;} function ZZZZZZZZZZZZZZZh7(&$ZZZZJ99){$ZZZZZC22 = null;$ZZT1919 = count($this->ZZZY2424);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZJ99[0]["name"],$this->ZZZY2424)){$ZZZZZC22 = array_shift($ZZZZJ99);}}} function ZZZZZZZZZZZZZN1313($module,$ZZZZc2,$filters,$ZZZZZJ99 = array(),$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9 = false,$isCrosstab = true,$ZZZZZZZZZZZZZO1414 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd", $ZZZZZZZZZZZZZP1515 = false, $ZZZT1919 = array(), $ZZZZZZZZZZZZZk10 = array(), ARUser $ZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZZZZR1717 = new ZZZZZZZZZZQ1616($this->db,$this->ZZZZZe4,true, $ZZZZZZZZZZZZZQ1616);$ZZZZZZZj9 = $this->ZZZZZZZZZZZZZZv21($ZZZZZJ99);$ZZZZZZZZZZZZZZZi8 = str_replace('-', '_', session_id());$ZZq16 = array();for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){$ZZq16[$Zf5] = $this->ZZZZZZZZZZZZZZU2020($ZZZZZZZZZZZZZR1717,$this->ZZZZZZZZZZZZZZn13[$Zf5],$ZZZZc2,$filters,$ZZZZZJ99,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZj9);} for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){if($ZZq16[$Zf5]!==null){$this->ZZZZZZZZZZZZZZQ1616($ZZq16[$Zf5],$Zf5.$ZZZZZZZZZZZZZZZi8);}} for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["removeTable"],array());$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["createTmpTable"],$ZZq16[$Zf5]["params"]);$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["fixTable"],array());}} $ZZZZZZZZZZZZZZX2323 = $this->ZZZZZZZZZZZZZZM1212($ZZq16,"report".$ZZZZZZZZZZZZZZZi8);$ZZZZZZZZZZZZZZZj9 = $this->ZZZZZZZZZZZZZZW2222($ZZZZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZR1717, $ZZq16,$this->ZZZZZZZZZZZZZZs18,$ZZZO1414,$ZZZZZZZZZZZZZk10);$ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZZj9["removeTable"],array());$ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZX2323,array());$ZZS1818 = $this->db->ZZZE44($ZZZZZZZZZZZZZZZj9["sql"],array());for($Zf5 = 0;$Zf5<$ZZZZZZZj9;$Zf5++){$ZZZH77 = $this->db->ZZZI88($ZZq16[$Zf5]["removeTable"],array());} $ZZZH77 = $this->db->ZZZI88($ZZZZZZZZZZZZZZZj9["removeTable"],array());$ZZT1919 = count($ZZZZZJ99);$ZZZZZZZZZZZZZS1818 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZS1818[] = new ZZZZZZZZZZI88($ZZZZZJ99[$Zf5]->name,$this->db,$this->ZZZZZe4,$ZZZZZJ99[$Zf5]);} $ZZZZZZZZZZZZZT1919 = new ZZZZZZZZZZZZZU2020($ZZZO1414,$ZZZZZZZZZZZZZZZj9["fields"],$ZZZZZZZZZZZZZj9);$ZZZZZZZZZZZZZT1919->ZZZZZZZZZZZZZV2121($ZZS1818);$ZZZO1414[] = array("name"=>"date_field","dateGrouping"=>$ZZZO1414[0]["dateGrouping"],"sortAction"=>$ZZZO1414[0]["sortAction"],"position" =>$ZZZO1414[0]["position"]);$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZX2323($this->ZZZZZe4,$this->db,$ZZZZZZZZZZZZZZZj9["fields"],$ZZZO1414,$ZZZZZZZZZZZZZS1818,$dateFormat,$ZZZZZZZZZZZZZP1515);$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818);if($ZZZO1414[0]["sortAction"]=="nogroup"){unset($ZZZZZZZZZZZZZZZj9["cols"]['date_field']);} $ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZK1010($ZZZZZZZZZZZZZZZj9["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){$this->ZZZZZZZZZZZZZZZh7($ZZZO1414);if($aggregateColumn){$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZ2525($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);}else{$ZZZZZZZZZZZZZY2424 = new ZZZZZZZZZZZZZZa0($this->db,$this->ZZZZZe4,$ZZZZZZZZZZZZZS1818);} $ZZS1818 = $ZZZZZZZZZZZZZY2424->ZZZZZZZZZZZZZZb1($ZZS1818,$ZZZO1414,$ZZZP1515,$ZZZZZZZZZZZZZZZj9["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZK1010($ZZS1818["cols"]);$ZZS1818["meta"] = $ZZZZZZZZZZZZZZZj9["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZZd3($ZZZZZZZZZZZZZS1818, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);if($ZZZZZZZZZZZZZO1414){$ZZZZZZZZZZZZZW2222 = new ZZZZZZZZZZZZZZc2();$ZZZZZZZZZZZZZW2222->ZZZZZZZZZZZZZV2121($ZZS1818["data"]);} return $ZZS1818;}} class ZZZZZZZZZZZZZZa0{protected $ZZZZZZZZZZZZZZZk10;protected $ZZZP1515;protected $ZZZZZZZZZZZZZZZl11;protected $ZZZZZe4;protected $db;protected $ZZZZZZZZZZu20;function __construct($db, $ZZZZZe4,$ZZZZZZZZZZu20) {$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZZZZZZZZu20 = $ZZZZZZZZZZu20;} function ZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZn13,$ZZZZZZZZZZZZZZZk10){$ZZZZZZZZZZZZZZZo14 = count($ZZZZZZZZZZZZZZZn13);$ZZS1818 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZo14;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZn13[$Zf5]] = array();} $ZZT1919 = count($ZZZZZZZZZZZZZZZk10);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){for($ZZZZZW2222=0;$ZZZZZW2222<$ZZZZZZZZZZZZZZZo14;$ZZZZZW2222++){if(!in_array($ZZZZZZZZZZZZZZZk10[$Zf5][$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]],$ZZS1818[$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZS1818[$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]][] = $ZZZZZZZZZZZZZZZk10[$Zf5][$ZZZZZZZZZZZZZZZn13[$ZZZZZW2222]];}}} return $ZZS1818;} function ZZZZZZZZZZZZZZZp15($ZZZZZz25,$ZZZZZZZZZZZZZZZq16 = false){$ZZZH77 = $ZZZZZz25;$ZZT1919 = count($ZZZH77);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZH77[$Zf5] = strtoupper(trim($ZZZZZz25[$Zf5]));} if($ZZZZZZZZZZZZZZZq16){arsort($ZZZH77);}else{asort($ZZZH77);} $ZZS1818 = array();foreach($ZZZH77 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZS1818[] = $ZZZZZz25[$ZZZZa0];} return $ZZS1818;} function ZZZZZZZZZZZZZZZs18(&$ZZZZZZZZZZZZZZZt19,$ZZZZZZZZZZZZZZZu20,$ZZZZZZZZZZZZZZZv21){$ZZT1919 = count($ZZZZZZZZZZZZZZZt19);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZt19[$Zf5]["values"] = $ZZZZZZZZZZZZZZZu20[$ZZZZZZZZZZZZZZZt19[$Zf5]["name"]];if($ZZZZZZZZZZZZZZZv21 && $ZZZZZZZZZZZZZZZt19[$Zf5]["sort"] === 1){$ZZZZZZZZZZZZZZZt19[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZp15($ZZZZZZZZZZZZZZZt19[$Zf5]["values"]);} if($ZZZZZZZZZZZZZZZv21 && $ZZZZZZZZZZZZZZZt19[$Zf5]["sort"] === 2){$ZZZZZZZZZZZZZZZt19[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZp15($ZZZZZZZZZZZZZZZt19[$Zf5]["values"],true);}}} function ZZZZZZZZZZZZZZZw22($ZZZc2,$ZZZZZZZZZZZZZZZx23){$ZZS1818 = $ZZZZZZZZZZZZZZZx23;$ZZT1919 = count($ZZZc2);for($Zf5 = $ZZT1919;$Zf5>0;$Zf5--){$ZZZH77 = $ZZZc2[$Zf5-1];$ZZZH77["data"] = array();$ZZZH77["next"] = $ZZS1818;$ZZS1818 = $ZZZH77;} return $ZZS1818;} function ZZZZZZZZZZZZZZZy24($ZZZZZZG66,&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZA00,$ZZZP1515){if($ZZZZZZZZZZZZZZZA00){$Zf5 =array_search($ZZZZZZG66[$ZZZZZZZZZZZZZZZz25["name"]],$ZZZZZZZZZZZZZZZz25["values"]);if(!isset($ZZZZZZZZZZZZZZZz25["data"][$Zf5])){$ZZZZZZZZZZZZZZZz25["data"][$Zf5] = $ZZZZZZZZZZZZZZZz25["next"];} $this->ZZZZZZZZZZZZZZZy24($ZZZZZZG66,$ZZZZZZZZZZZZZZZz25["data"][$Zf5],$ZZZZZZZZZZZZZZZA00-1,$ZZZP1515);}else{$ZZT1919 = count($ZZZP1515);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if($ZZZP1515[$Zf5]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZz25["data"][$ZZZP1515[$Zf5]["selectedField"]."_sum"] = $ZZZZZZG66[$ZZZP1515[$Zf5]["selectedField"]."_sum"];} if($ZZZP1515[$Zf5]["value"]["count"]==true){$ZZZZZZZZZZZZZZZz25["data"][$ZZZP1515[$Zf5]["selectedField"]."_cnt"] = $ZZZZZZG66[$ZZZP1515[$Zf5]["selectedField"]."_cnt"];} if($ZZZP1515[$Zf5]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZz25["data"][$ZZZP1515[$Zf5]["selectedField"]."_avg"] = $ZZZZZZG66[$ZZZP1515[$Zf5]["selectedField"]."_avg"];}}}} function ZZZZZZZZZZZZZZZB11(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZC22,$ZZZZZZZZZZZZZZZD33,$ZZZP1515,$ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZl11){$ZZZZZZZZZZZZZZZA00 = $ZZZZZZZZZZZZZZZC22+$ZZZZZZZZZZZZZZZD33;if($ZZZZZZZZZZZZZZZE44<($ZZZZZZZZZZZZZZZA00 -1)) {if($ZZZZZZZZZZZZZZZz25["sort"] === 1 || $ZZZZZZZZZZZZZZZz25["sort"] === 2){ksort($ZZZZZZZZZZZZZZZz25["data"]);} foreach($ZZZZZZZZZZZZZZZz25["data"] as $ZZZZa0 =>$ZZZZZZZZZZZZZZZr17){$this->ZZZZZZZZZZZZZZZB11($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0],$ZZZZZZZZZZZZZZZC22,$ZZZZZZZZZZZZZZZD33,$ZZZP1515,$ZZZZZZZZZZZZZZZE44+1,$ZZZZZZZZZZZZZZZl11);} if($ZZZZZZZZZZZZZZZD33 -1 <$ZZZZZZZZZZZZZZZE44){$this->ZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZA00);if($ZZZZZZZZZZZZZZZE44== 0){$this->ZZZZZZZZZZZZZZZG66($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515);}}else{$this->ZZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZZZz25,($ZZZZZZZZZZZZZZZE44 === $ZZZZZZZZZZZZZZZD33-1));}}else{$this->ZZZZZZZZZZZZZZZI88($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515);if($ZZZZZZZZZZZZZZZE44== 0){$this->ZZZZZZZZZZZZZZZG66($ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515);}}} function ZZZZZZZZZZZZZZZG66(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZS1818 = array("cols"=>array(),"data"=>array(array()));$ZZZZZZZZZZZZZZF55 = count($ZZZP1515);$ZZZZZZZZZZZZZZZJ99 = array();for($ZZZZZW2222 =0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZP1515[$ZZZZZW2222]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"];} if($ZZZP1515[$ZZZZZW2222]["value"]["count"]==true){$ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"];} if($ZZZP1515[$ZZZZZW2222]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"];}} foreach($ZZZZZZZZZZZZZZZz25["cols"] as $ZZZZa0=>$ZZZZZZZZZZZZZZZr17){foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZK1010=>$ZZZZZZZZZZZZZZZL1111) {$ZZS1818["data"][0][$ZZZZa0] = (isset($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]))?($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]):"";$ZZS1818["cols"][$ZZZZa0] = $ZZZZZZZZZZZZZZZr17;}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZF55(&$ZZZZZZZZZZZZZZZz25){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);reset($ZZZZZZZZZZZZZZZz25["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZz25["data"]);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {foreach($ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"] as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZS1818["cols"]["v".$Zf5."_".$ZZZZa0] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZr17;}} foreach($ZZZZZZZZZZZZZZZz25["data"] as $ZZZZa0 =>$ZZZZZZZZZZZZZZZr17){foreach($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"] as $ZZZZZZZZZZZZZZZK1010 =>$ZZZZZZZZZZZZZZZL1111){$ZZS1818["data"]["v".$ZZZZa0."_".$ZZZZZZZZZZZZZZZK1010] = $ZZZZZZZZZZZZZZZL1111;}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZH77(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZM1212){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZS1818["cols"][$ZZZZZZZZZZZZZZZz25["name"]] = $ZZZZZZZZZZZZZZZz25["title"];reset($ZZZZZZZZZZZZZZZz25["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZz25["data"]);$ZZS1818["cols"] = array_merge($ZZS1818["cols"],$ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);foreach ($ZZZZZZZZZZZZZZZz25["data"] as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){if($ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0]===null){$ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0] = " - ";} if($ZZZZZZZZZZZZZZZM1212){$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZZZZZz25["name"]] = $ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"];}else{$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"]);for ($ZZZZZW2222 = 0;$ZZZZZW2222 < $ZZZZZZZZZZZZZZF55;$ZZZZZW2222++) {$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZW2222][$ZZZZZZZZZZZZZZZz25["name"]] = $ZZZZZZZZZZZZZZZz25["values"][$ZZZZa0];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZW2222];}}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$Zf5])){foreach($ZZZZZZZZZZZZZZZz25["data"][$Zf5]["data"] as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$this->ZZZZZZZZZZZZZZZJ99[$ZZZZa0] = $ZZZZZZZZZZZZZZZl11[$ZZZZa0];$ZZS1818["cols"]["v".$Zf5."_".$ZZZZa0] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZZa0];$ZZS1818["data"]["v".$Zf5."_".$ZZZZa0] = $ZZZZZZZZZZZZZZZr17;}}else{$ZZZZZZZZZZZZZZF55 = count($ZZZP1515);for($ZZZZZW2222 =0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZP1515[$ZZZZZW2222]["value"]["sum"]==true){$this->ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_sum"];} if($ZZZP1515[$ZZZZZW2222]["value"]["count"]==true){$this->ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_cnt"];} if($ZZZP1515[$ZZZZZW2222]["value"]["avg"]==true){$this->ZZZZZZZZZZZZZZZJ99[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$ZZZZZW2222]["selectedField"]."_avg"];}}}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZb1($r17,$ZZZO1414,$ZZZP1515,$ZZZc2){$ZZZZZZZZZZZZZZZN1313 = $r17["data"];$ZZZZZZZZZZZZZZZO1414 = array();$ZZZZZZZZZZh7 = $this->ZZZZZe4->ZZZZZT1919($ZZZc2, $ZZZO1414);$ZZZZZZZZZZZZZZZP1515 = array();$ZZZZZZZZZZZZZZZQ1616 = array();$ZZZZZZZZZZZZZZZR1717 = array();$ZZT1919 = count($ZZZO1414);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if(($ZZZO1414[$Zf5]["sortAction"]=="group" || $ZZZO1414[$Zf5]["sortAction"]=="groupsort")){if($ZZZO1414[$Zf5]["name"]!="date_field" && isset($ZZZO1414[$Zf5]['dateGrouping']) && !empty($ZZZO1414[$Zf5]['dateGrouping'])) {$ZZZO1414[$Zf5]['name'] = $ZZZO1414[$Zf5]['name'] . '_' . $ZZZO1414[$Zf5]['dateGrouping'];} if(isset($r17["cols"][$ZZZO1414[$Zf5]["name"]])){$ZZZH77 = array("name" =>$ZZZO1414[$Zf5]["name"], "title" => $r17["cols"][$ZZZO1414[$Zf5]["name"]], "sort" => false);if($ZZZO1414[$Zf5]["sortAction"]=="groupsort"){if(isset($ZZZO1414[$Zf5]["sortDirection"]) && $ZZZO1414[$Zf5]["sortDirection"] == "ASC"){$ZZZH77["sort"] = 1;}else{$ZZZH77["sort"] = 2;}} $ZZZZZZZZZZZZZZZR1717[] = $ZZZO1414[$Zf5]["name"];if($ZZZO1414[$Zf5]["position"] == "row" || $ZZZO1414[$Zf5]["position"] == ""){if($ZZZO1414[$Zf5]["name"] == "00_ALL_assigned_user_id"){$ZZZZZZZZZZZZZZZS1818 = false;}else{$ZZZZZZZZZZZZZZZS1818 = $this->ZZZZZe4->ZZZZZI88($ZZZZZZZZZZh7[$ZZZO1414[$Zf5]["name"]],$this->db,$this->ZZZZZZZZZZu20);} if($ZZZZZZZZZZZZZZZS1818){$ZZZZZZZZZZZZZZZQ1616[] = array("name" =>$ZZZO1414[$Zf5]["name"]."_id", "title" => $r17["cols"][$ZZZO1414[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZQ1616[] = array("name" =>$ZZZO1414[$Zf5]["name"]."_setype", "title" => $r17["cols"][$ZZZO1414[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZO1414[] = $ZZZO1414[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZO1414[] = $ZZZO1414[$Zf5]["name"]."_setype";$ZZZZZZZZZZZZZZZR1717[] = $ZZZO1414[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZR1717[] = $ZZZO1414[$Zf5]["name"]."_setype";} $ZZZZZZZZZZZZZZZQ1616[] = $ZZZH77;}else{$ZZZZZZZZZZZZZZZP1515[] = $ZZZH77;}}}} $ZZZZZZZZZZZZZZZT1919 = $this->ZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZZZZZN1313);$this->ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZQ1616,$ZZZZZZZZZZZZZZZT1919,true);$this->ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZZZZT1919,false);$ZZZZZZZZZZZZZZZU2020 = $this->ZZZZZZZZZZZZZZZw22($ZZZZZZZZZZZZZZZP1515,array());$ZZZZZZZZZZZZZZZz25 = $this->ZZZZZZZZZZZZZZZw22($ZZZZZZZZZZZZZZZQ1616,$ZZZZZZZZZZZZZZZU2020);$ZZZZZZZZZZZZZZZA00 = count($ZZZZZZZZZZZZZZZQ1616) + count($ZZZZZZZZZZZZZZZP1515);$ZZT1919 = count($ZZZZZZZZZZZZZZZN1313);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZy24($ZZZZZZZZZZZZZZZN1313[$Zf5],$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZA00,$ZZZP1515);} $this->ZZZZZZZZZZZZZZZk10 = $ZZZZZZZZZZZZZZZQ1616;$this->ZZZP1515 = $ZZZP1515;$this->ZZZZZZZZZZZZZZZl11 = $r17["cols"];$this->ZZZZZZZZZZZZZZZB11($ZZZZZZZZZZZZZZZz25,count($ZZZZZZZZZZZZZZZP1515),count($ZZZZZZZZZZZZZZZQ1616),$ZZZP1515,0,$r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZZO1414);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){unset($ZZZZZZZZZZZZZZZz25["cols"][$ZZZZZZZZZZZZZZZO1414[$Zf5]]);} return $ZZZZZZZZZZZZZZZz25;}} class ZZZZZZZZZZZZZZ2525 extends ZZZZZZZZZZZZZZa0{function ZZZZZZZZZZZZZZZF55(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZA00){if($ZZZZZZZZZZZZZZZE44 == $ZZZZZZZZZZZZZZZA00 - 1){$ZZS1818 = array("cols"=>array(""=>""),"data"=>array());$ZZZZZZZZZZZZZZZz25 = $ZZS1818;}else{parent::ZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZz25);}} function ZZZZZZZZZZZZZZZG66(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZS1818 = array("cols"=>array("aggregates"=>"Aggregate"),"data"=>array(array()));$ZZZH77 = array();foreach($ZZZZZZZZZZZZZZZz25["cols"] as $ZZZZa0=>$ZZZZZZZZZZZZZZZr17){$ZZS1818["cols"][$ZZZZa0] = $ZZZZZZZZZZZZZZZr17;if(isset($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]))foreach ($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"] as $ZZZZZZZZZZZZZZZK1010=>$ZZZZZZZZZZZZZZZL1111) {if(!isset($ZZZH77[$ZZZZZZZZZZZZZZZK1010])){$ZZZH77[$ZZZZZZZZZZZZZZZK1010] = array("aggregates"=>$ZZZZZZZZZZZZZZZl11[$ZZZZZZZZZZZZZZZK1010]);} $ZZZH77[$ZZZZZZZZZZZZZZZK1010][$ZZZZa0] = (is_array($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"]) && isset($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZZZZZK1010]))?($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZZZZZK1010]):"";}} $ZZS1818["data"] = array_values($ZZZH77);$ZZZZZZZZZZZZZZZz25 = $ZZS1818;} function ZZZZZZZZZZZZZZZH77(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZV2121){if($ZZZZZZZZZZZZZZZV2121){$ZZZZZZZZZZZZZZZl11 = $this->ZZZZZZZZZZZZZZZl11;$ZZZP1515 = $this->ZZZP1515;$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);$ZZZZZZZZZZZZZZZW2222["aggregates"] = "Aggregate";reset($ZZZZZZZZZZZZZZZz25["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZz25["data"]);$ZZZZZZZZZZZZZZZW2222 = array_merge($ZZZZZZZZZZZZZZZW2222,$ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);$ZZZZZZZZZZZn13 = array_keys($ZZZZZZZZZZZZZZZz25["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZZX2323 = count($ZZZP1515);$ZZZZZC22 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZX2323;$Zf5++){$ZZZZZZZZZZZZZZZY2424 = array("aggregates"=>($ZZZP1515[$Zf5]["value"]["sum"]==true)?$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$Zf5]["selectedField"]."_sum"]:"");$ZZZZZZZZZZZZZZZZ2525 = array("aggregates"=>($ZZZP1515[$Zf5]["value"]["count"]==true)?$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$Zf5]["selectedField"]."_cnt"]:"");$ZZZZZZZZZZZZZZZZa0 = array("aggregates"=>($ZZZP1515[$Zf5]["value"]["avg"]==true)?$ZZZZZZZZZZZZZZZl11[$ZZZP1515[$Zf5]["selectedField"]."_avg"]:"");for($ZZZZa0 = 0;$ZZZZa0<$ZZT1919;$ZZZZa0++){$ZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZZZY2424;$ZZn13 = $ZZZZZZZZZZZZZZZZ2525;$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZZZZZZZa0;for($ZZZZZW2222=0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZP1515[$Zf5]["value"]["sum"]==true){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZZZZZZZZZZZZZZZb1[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]]["data"][$ZZZP1515[$Zf5]["selectedField"]."_sum"];}} if($ZZZP1515[$Zf5]["value"]["count"]==true){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZn13[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]]["data"][$ZZZP1515[$Zf5]["selectedField"]."_cnt"];}} if($ZZZP1515[$Zf5]["value"]["avg"]==true){if(!empty($ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]])){$ZZZZZZZZZZZZZZZZc2[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = $ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"][$ZZZZZZZZZZZn13[$ZZZZZW2222]]["data"][$ZZZP1515[$Zf5]["selectedField"]."_avg"];}}} if(!isset($ZZZZZC22[$ZZZZa0])){$ZZZZZC22[$ZZZZa0] = array();} if(count($ZZZZZZZZZZZZZZZZb1)>1){$ZZZZZC22[$ZZZZa0][]=$ZZZZZZZZZZZZZZZZb1;} if(count($ZZn13)>1){$ZZZZZC22[$ZZZZa0][]=$ZZn13;} if(count($ZZZZZZZZZZZZZZZZc2)>1){$ZZZZZC22[$ZZZZa0][]=$ZZZZZZZZZZZZZZZZc2;}}} for($ZZZZZW2222=0;$ZZZZZW2222<$ZZZZZZZZZZZZZZF55;$ZZZZZW2222++){if($ZZZZZZZZZZZZZZZW2222[$ZZZZZZZZZZZn13[$ZZZZZW2222]] === null){$ZZZZZZZZZZZZZZZW2222[$ZZZZZZZZZZZn13[$ZZZZZW2222]] = "-";}} for($ZZZZa0 = 0;$ZZZZa0<$ZZT1919;$ZZZZa0++){if(!empty($ZZZZZC22[$ZZZZa0])){$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["cols"] = $ZZZZZZZZZZZZZZZW2222;$ZZZZZZZZZZZZZZZz25["data"][$ZZZZa0]["data"] = $ZZZZZC22[$ZZZZa0];}}} parent::ZZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZZZz25,false);} function ZZZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZZz25,$ZZZZZZZZZZZZZZZl11,$ZZZP1515){$ZZT1919 = count($ZZZZZZZZZZZZZZZz25["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZS1818["cols"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZz25["values"][$Zf5];if(isset($ZZZZZZZZZZZZZZZz25["data"][$Zf5])){$ZZS1818["data"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZz25["data"][$Zf5];}} $ZZZZZZZZZZZZZZZz25 = $ZZS1818;}}
class ZZZZZZZZZZZZZX2323{protected $ZZZZZZZZZZZZZZZZd3 = array();protected $ZZZZZZZZZZZZZS1818 = array();protected $ZZT1919 = 0;protected $ZZZZZe4;protected $db;protected $dateFormat;protected $ZZZc2;protected $ZZZZZZZZZZZZZP1515;function __construct($ZZZZZe4,$db,$ZZZc2,$ZZZO1414,$ZZZZZZZZZZZZZS1818,$dateFormat,$ZZZZZZZZZZZZZP1515) {$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->ZZZZZZZZZZZZZZZZd3 = $this->ZZZZZZZZZZZZZZZZe4($ZZZc2,$ZZZO1414);$this->ZZT1919 = count($this->ZZZZZZZZZZZZZZZZd3);$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZZS1818 = $ZZZZZZZZZZZZZS1818;$this->dateFormat = $dateFormat;$this->ZZZZZZZZZZZZZP1515 = $ZZZZZZZZZZZZZP1515;} protected function ZZZZZZZZZZZZZZZZe4($ZZZc2,$ZZZO1414){$ZZS1818 = array();$ZZZZZZZZZZZZZZZZf5 = array();$ZZZZZR1717 = 0;$ZZT1919 = count($ZZZc2);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZc2[$Zf5]["uitype"],array('date', 'datetime', 'datetimecombo', 'enum', 'multienum', 'currency', 'dynamicenum'))){$ZZS1818[$ZZZZZR1717] = $ZZZc2[$Zf5];$ZZZZZZZZZZZZZZZZf5[$ZZZc2[$Zf5]["fieldname"]] = &$ZZS1818[$ZZZZZR1717];$ZZZZZR1717++;}} $ZZT1919 = count($ZZZO1414);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZZZZZf5[$ZZZO1414[$Zf5]["name"]])){if(isset($ZZZO1414[$Zf5]["dateGrouping"])){$ZZZZZZZZZZZZZZZZf5[$ZZZO1414[$Zf5]["name"]]["dateGrouping"]= $ZZZO1414[$Zf5]["dateGrouping"];}}} $ZZZZZZZZZZZZZZZZg6 = array();foreach($ZZS1818 as $ZZZZZZZZZZZZZZZZh7) {if(isset($ZZZZZZZZZZZZZZZZh7['dateGrouping']) && !empty($ZZZZZZZZZZZZZZZZh7['dateGrouping']) && $ZZZZZZZZZZZZZZZZh7['fieldname']!="date_field") {foreach($ZZZO1414 as $ZZZZZZZZZZZZZZZZi8) {$ZZZZZZZZZZZZZZZZj9 = $ZZZZZZZZZZZZZZZZi8['name'] . '_' . $ZZZZZZZZZZZZZZZZi8['dateGrouping'];if($ZZZZZZZZZZZZZZZZh7['fieldname'] == $ZZZZZZZZZZZZZZZZi8['name']) {$ZZZZZZZZZZZZZZZZk10 = $ZZZZZZZZZZZZZZZZh7;$ZZZZZZZZZZZZZZZZk10['fieldname'] = $ZZZZZZZZZZZZZZZZj9;$ZZZZZZZZZZZZZZZZk10['dateGrouping'] = $ZZZZZZZZZZZZZZZZi8['dateGrouping'];$ZZZZZZZZZZZZZZZZg6[] = $ZZZZZZZZZZZZZZZZk10;} else if ($ZZZZZZZZZZZZZZZZh7['fieldname'] == $ZZZZZZZZZZZZZZZZj9){$ZZZZZZZZZZZZZZZZg6[] = $ZZZZZZZZZZZZZZZZh7;}}} else {$ZZZZZZZZZZZZZZZZg6[] = $ZZZZZZZZZZZZZZZZh7;}} $ZZS1818 = $ZZZZZZZZZZZZZZZZg6;return $ZZS1818;} function ZZZZZZZZZZZZZZZZl11($ZZZZZZZZZZZZZZZZm12){$ZZZH77 = explode(" ",$ZZZZZZZZZZZZZZZZm12,2);$ZZZZZZZZZZZZx23 = explode("-",$ZZZH77[0],3);if(count($ZZZZZZZZZZZZx23) == 1) {return $this->ZZZZZe4->ZZZZZQ1616($ZZZZZZZZZZZZx23[0]);} if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZx23[1])){return $ZZZZZZZZZZZZZZZZm12;} $ZZZZZZZZZZZZx23[1] = $this->ZZZZZe4->ZZZZZQ1616(intval($ZZZZZZZZZZZZx23[1],10));switch($this->dateFormat){case "mm-dd-yyyy": $ZZZH77[0] = $ZZZZZZZZZZZZx23[1]."-".$ZZZZZZZZZZZZx23[2]."-".$ZZZZZZZZZZZZx23[0];break;case "dd-mm-yyyy": $ZZZH77[0] = $ZZZZZZZZZZZZx23[2]."-".$ZZZZZZZZZZZZx23[1]."-".$ZZZZZZZZZZZZx23[0];break;case "yyyy-mm-dd": default: $ZZZH77[0] = $ZZZZZZZZZZZZx23[0]."-".$ZZZZZZZZZZZZx23[1]."-".$ZZZZZZZZZZZZx23[2];break;} $ZZS1818 = $ZZZH77[0];if(isset($ZZZH77[1])){$ZZS1818.=" ".$ZZZH77[1];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZn13($value,$field,$ZZZZZZZZZZu20){static $ZZZx23 = array('its_currencies' =>array());$ZZS1818 = $value;switch ($field['uitype']){case 'date': case 'datetime': case 'datetimecombo': if(!isset($field["dateGrouping"]) || in_array($field["dateGrouping"],array("day","month","monthAndYear"))){if(count(explode("-",$value))==2){$ZZZH77 = explode(" ",$value,2);$ZZZZZZZZZZZZx23 = explode("-",$ZZZH77[0],3);if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZx23[1])){return $ZZS1818;} $ZZZZZZZZZZZZx23[1] = $this->ZZZZZe4->ZZZZZQ1616(intval($ZZZZZZZZZZZZx23[1],10));$ZZZH77[0] = implode("-",$ZZZZZZZZZZZZx23);$ZZS1818 = implode(" ",$ZZZH77);}else{if(!empty($value)){$ZZS1818 = $this->ZZZZZZZZZZZZZZZZl11($value);}}} break;case 'multienum': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZy24($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} $ZZZZZZZZZZZZZZZZq16 = str_replace('^', '', $value);$ZZZZZZZZZZZZZZZZr17 = explode(",", $ZZZZZZZZZZZZZZZZq16);$ZZZZZZZZZZZZZZZZs18 = array();foreach ($ZZZZZZZZZZZZZZZZr17 as $ZZZZZZZZZZZZZZZZt19) {if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZt19])){$ZZZZZZZZZZZZZZZZs18[] = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZt19];}} if(count($ZZZZZZZZZZZZZZZZs18) > 0){$ZZS1818 = implode(", ", $ZZZZZZZZZZZZZZZZs18);} break;case 'enum': case 'dynamicenum': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZy24($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value])){$ZZS1818 = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value];} break;case '33': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZy24($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} $ZZZZZZZZZZZZZZZZu20 = explode(" |##| ", $value);$ZZZZZZZZZZZZZZZZv21 = array();foreach($ZZZZZZZZZZZZZZZZu20 as $ZZZZZZZZZZZZZZZZw22){if(!empty($ZZZZZZZZZZZZZZZZw22)){$ZZZZZZZZZZZZZZZZx23 = $ZZZZZZZZZZZZZZZZw22;if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZw22])){$ZZZZZZZZZZZZZZZZx23 = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZZZw22];} $ZZZZZZZZZZZZZZZZv21[] = $ZZZZZZZZZZZZZZZZx23;}} if(!empty($ZZZZZZZZZZZZZZZZv21)){$ZZS1818 = implode(", ",$ZZZZZZZZZZZZZZZZv21);} break;case '117': if(!isset($ZZZx23['its_currencies'][$value])){$ZZZZZZZZZZZZZZZZy24 = $this->db->ZZQ1616($value);$ZZZx23['its_currencies'][$value] = ($ZZZZZZZZZZZZZZZZy24)?($ZZZZZZZZZZZZZZZZy24):($value);} if(isset($ZZZx23['its_currencies'][$value])){$ZZS1818 = $ZZZx23['its_currencies'][$value];} break;case '-24': $ZZZZZZZZZZZZZZZZo14 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14])){$ZZZZZZZZZZZZZZZZp15 = $ZZZZZZZZZZu20[$field["module"]]->name;$ZZZx23[$ZZZZZZZZZZZZZZZZo14] = $this->ZZZZZe4->ZZZZZA00($field["fieldname_org"],$ZZZZZZZZZZZZZZZZp15,$this->db);} if(isset($ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value])){$ZZS1818 = $ZZZx23[$ZZZZZZZZZZZZZZZZo14][$value];} break;default: break;} return $ZZS1818;} function ZZZZZZZZZZZZZV2121(&$ZZZZZZZZZZZZZZZk10){$ZZT1919 = count($ZZZZZZZZZZZZZZZk10);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZZZk10[$Zf5]);}} function ZZZZZZZZZZZZZZZZz25(&$ZZr17){for($Zf5 = 0;$Zf5<$this->ZZT1919;$Zf5++){foreach($ZZr17 as $Zu20 => $value) {$ZZr17[$Zu20] = html_entity_decode($value, ENT_QUOTES, "UTF-8");} if(isset($ZZr17[$this->ZZZZZZZZZZZZZZZZd3[$Zf5]["fieldname"]])){$ZZr17[$this->ZZZZZZZZZZZZZZZZd3[$Zf5]["fieldname"]] = $this->ZZZZZZZZZZZZZZZZn13($ZZr17[$this->ZZZZZZZZZZZZZZZZd3[$Zf5]["fieldname"]],$this->ZZZZZZZZZZZZZZZZd3[$Zf5],$this->ZZZZZZZZZZZZZS1818);}} if($this->ZZZZZZZZZZZZZP1515){$ZZZZZZZZZZZZZZF55 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZF55;$Zf5++){if(isset($ZZr17[$this->ZZZc2[$Zf5]["fieldname"]]) && $ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] === null){$ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] = 0;}}}}} class ZZZZZZZZZZZZZU2020{protected $ZZZZZZZZZZZZZZZZA00 = array();protected $ZZZc2;protected $ZZZZZZZZZZZZZZZZB11 = 0;protected $ZZZO1414;protected $ZZZZZZZZZZZZZj9 = false;protected $ZZZZZZZZZZZZZZZZC22 = array();protected $ZZZZZZZZZZZZZZZZD33 = array();function ZZZZZZZZZZZZZZZZE44(){$ZZS1818 = array();$ZZZZZZZZZZZZZZZl11 = array();$ZZT1919 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZC22[$this->ZZZc2[$Zf5]["fieldname"]] = $this->ZZZc2[$Zf5]["uitype"];$ZZZZZZZZZZZZZZZl11[] = $this->ZZZc2[$Zf5]["fieldname"];} $ZZT1919 = count($this->ZZZO1414);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($this->ZZZO1414[$Zf5]["name"],$ZZZZZZZZZZZZZZZl11) && $this->ZZZZZZZZZZZZZZZZC22[$this->ZZZO1414[$Zf5]["name"]] == 33 && !empty($this->ZZZO1414[$Zf5]["transform"])){$ZZS1818[] = $this->ZZZO1414[$Zf5];} if(in_array($this->ZZZO1414[$Zf5]["name"],$ZZZZZZZZZZZZZZZl11)){$this->ZZZZZZZZZZZZZZZZD33[] = $this->ZZZO1414[$Zf5]["name"];}} return $ZZS1818;} function __construct($ZZZO1414,$ZZZc2,$ZZZZZZZZZZZZZj9){$this->ZZZO1414= $ZZZO1414;$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZZj9 = $ZZZZZZZZZZZZZj9;$this->ZZZZZZZZZZZZZZZZA00 = $this->ZZZZZZZZZZZZZZZZE44();} function ZZZZZZZZZZZZZZZZF55($ZZZZy24,$r17){$ZZZZZZZZZZZZZZZT1919 = array();for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZB11;$Zf5++){if(!in_array($r17[$Zf5][$ZZZZy24],$ZZZZZZZZZZZZZZZT1919)){$ZZZZZZZZZZZZZZZT1919[] = $r17[$Zf5][$ZZZZy24];}} $ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZT1919);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZT1919[$Zf5]] = explode(' |##| ',$ZZZZZZZZZZZZZZZT1919[$Zf5]);if(count($ZZS1818[$ZZZZZZZZZZZZZZZT1919[$Zf5]]) == 1){unset($ZZS1818[$ZZZZZZZZZZZZZZZT1919[$Zf5]]);}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZG66($ZZZZZa0,$r17){} function ZZZZZZZZZZZZZZZZH77($ZM1212,$ZZZZZZZZZZZZZZZZI88){$ZZZZZZZZZZZZZZZZJ99 = true;$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZD33);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZM1212[$this->ZZZZZZZZZZZZZZZZD33[$Zf5]] !== $ZZZZZZZZZZZZZZZZI88[$this->ZZZZZZZZZZZZZZZZD33[$Zf5]]){$ZZZZZZZZZZZZZZZZJ99 = false;}} return $ZZZZZZZZZZZZZZZZJ99;} function ZZZZZZZZZZZZZZZZK1010(&$r17,$ZZZZZZG66,$ZZZZZZZZZZZZZZZZL1111,$field,&$ZZZZZZZZZZZZZZZZM1212,&$ZZZZZZZZZZZZZZZZN1313){$ZZZZZZZZZZZZZZR1717 = array_merge(array_keys($r17[$ZZZZZZZZZZZZZZZZL1111]),array_keys($r17[$ZZZZZZG66]));$ZZZZZZZZZZZZZZR1717 = array_unique($ZZZZZZZZZZZZZZR1717);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(is_numeric($r17[$ZZZZZZG66][$ZZZZZZZZZZZZZZR1717[$Zf5]]) && !in_array($ZZZZZZZZZZZZZZR1717[$Zf5],$this->ZZZZZZZZZZZZZZZZD33)){$r17[$ZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZR1717[$Zf5]] = (string)round((floatval($r17[$ZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZR1717[$Zf5]]) + floatval($r17[$ZZZZZZG66][$ZZZZZZZZZZZZZZR1717[$Zf5]])),$ZZZZZZZZZZZF55);}} array_splice($r17,$ZZZZZZG66,1);$this->ZZZZZZZZZZZZZZZZB11--;if($ZZZZZZZZZZZZZZZZL1111>$ZZZZZZG66){$ZZZZZZZZZZZZZZZZL1111--;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZM1212);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZM1212[$Zf5]>$ZZZZZZG66){$ZZZZZZZZZZZZZZZZM1212[$Zf5]--;}} $ZZZZZZZZZZZZZZZZO1414 = array_search($ZZZZZZG66,$ZZZZZZZZZZZZZZZZN1313[$r17[$ZZZZZZZZZZZZZZZZL1111][$field]]);array_splice($ZZZZZZZZZZZZZZZZN1313[$r17[$ZZZZZZZZZZZZZZZZL1111][$field]],$ZZZZZZZZZZZZZZZZO1414,1);foreach ($ZZZZZZZZZZZZZZZZN1313 as &$ZZZZZz25) {$ZZT1919 = count($ZZZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZz25[$Zf5]>$ZZZZZZG66){$ZZZZZz25[$Zf5]--;}}}} function ZZZZZZZZZZZZZZZZP1515($ZZZZZZZZZZZZZZZZQ1616,$field,&$r17){$ZZZZZZZZZZZZZZZZR1717 = array();$ZZZZZZZZZZZZZZZZS1818 = array();foreach($ZZZZZZZZZZZZZZZZQ1616 as $ZZZZZz25){$ZZT1919 = count($ZZZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!isset($ZZZZZZZZZZZZZZZZR1717[$ZZZZZz25[$Zf5]])){$ZZZZZZZZZZZZZZZZR1717[$ZZZZZz25[$Zf5]] = array();}}} for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZB11;$Zf5++){if(isset($ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]])){$ZZZH77 = $r17[$Zf5];$ZZZZZZZZZZZZZZZZT1919 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]]);for($ZZZZZW2222 = 0;$ZZZZZW2222 < $ZZT1919;$ZZZZZW2222++){$ZZZZZZZZZZZZZZZZT1919[$ZZZZZW2222] = $ZZZH77;$ZZZZZZZZZZZZZZZZT1919[$ZZZZZW2222][$field] = $ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]][$ZZZZZW2222];$ZZZZZZZZZZZZZZZZS1818[] = $Zf5+$ZZZZZW2222;$ZZZZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZZZZQ1616[$r17[$Zf5][$field]][$ZZZZZW2222]][] = $Zf5+$ZZZZZW2222;} $this->ZZZZZZZZZZZZZZZZB11 = $this->ZZZZZZZZZZZZZZZZB11 + $ZZT1919 -1;array_splice($r17,$Zf5,1,$ZZZZZZZZZZZZZZZZT1919);$Zf5 = $Zf5 + $ZZT1919 -1;}elseif(isset($ZZZZZZZZZZZZZZZZR1717[$r17[$Zf5][$field]])){$ZZZZZZZZZZZZZZZZR1717[$r17[$Zf5][$field]][] = $Zf5;}} if ($this->ZZZZZZZZZZZZZj9) {$ZZT1919 = count($ZZZZZZZZZZZZZZZZS1818);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {$ZZZZZZZZZZZZZZF55 = count($ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]]);for ($ZZZZZW2222 = 0;$ZZZZZW2222 < $ZZZZZZZZZZZZZZF55;$ZZZZZW2222++) {if ($ZZZZZZZZZZZZZZZZS1818[$Zf5] != $ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]][$ZZZZZW2222]) {if ($this->ZZZZZZZZZZZZZZZZH77($r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]], $r17[$ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]][$ZZZZZW2222]])) {$this->ZZZZZZZZZZZZZZZZK1010($r17, $ZZZZZZZZZZZZZZZZS1818[$Zf5], $ZZZZZZZZZZZZZZZZR1717[$r17[$ZZZZZZZZZZZZZZZZS1818[$Zf5]][$field]][$ZZZZZW2222], $field, $ZZZZZZZZZZZZZZZZS1818, $ZZZZZZZZZZZZZZZZR1717);break;}}}}}} function ZZZZZZZZZZZZZV2121(&$r17){$this->ZZZZZZZZZZZZZZZZB11 = count($r17);$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZA00);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZQ1616 = $this->ZZZZZZZZZZZZZZZZF55($this->ZZZZZZZZZZZZZZZZA00[$Zf5]["name"],$r17);$this->ZZZZZZZZZZZZZZZZP1515($ZZZZZZZZZZZZZZZZQ1616,$this->ZZZZZZZZZZZZZZZZA00[$Zf5]["name"],$r17);}}}
class ZZZZZZZZZZZZZZc2{protected $id = 0;function ZZZZZZZZZZZZZV2121(&$ZZZZZZZZZZZZZZZk10){$ZZT1919 = count($ZZZZZZZZZZZZZZZk10);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZZZk10[$Zf5]);}} function ZZZZZZZZZZZZZZZZz25(&$ZZr17){$this->id++;$ZZr17["id"] = $this->id;}} class ZZZZZZZZZZH77 {public $name;protected $db;protected $ZZZZZe4;public $prefix = "";public $fieldTitlePrefix = "";public $relationDescr = null;function __construct($name, ZZp15 $db, ZZZZZf5 $ZZZZZe4){$this->name = $name;$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;$this->prefix = "0_".$this->name."_";} function ZZZZZZZZZZZZZZZZU2020($field){$ZZZZZz25 = $this->ZZZZZe4->ZZZZZy24($field['fieldname'],$this->name,$this->db);$ZZS1818 = array();foreach($ZZZZZz25 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZS1818[] = array("val" => $ZZZZa0,"title" => $ZZZZZZZZZZZZZZZr17);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZV2121($field){$ZZZZZZZZZZZZZZZu20 = array();switch ($field['uitype']) {case 'name': case 'text': case 'varchar': $type = "txt";break;case 'enum': case 'multienum': case 'dynamicenum': $type = "select";$ZZZZZZZZZZZZZZZu20 = $this->ZZZZZZZZZZZZZZZZU2020($field);break;case 'id': $type = "txt";break;case 'int': $type = "integer";break;case 'currency': case 'float': case 'decimal': $type = "number";break;case 'datetimecombo': case 'datetime': $type = "datetime";break;case 'date': $type = "date";break;case 'bool': $type = "checkbox";break;case 'relate': if(in_array($field["fieldname"], array("assigned_user_id"))) {$type = "user";} else {$type = "txt";} break;case 'assigned_user_name': $type = "user";break;default: $type = "txt";break;} $ZZZZZZZZZZZZZZZZW2222 = explode("~", $field['typeofdata']);if($ZZZZZZZZZZZZZZZZW2222[0]=="D"){$type = "date";} if($ZZZZZZZZZZZZZZZZW2222[0]=="N"||$ZZZZZZZZZZZZZZZZW2222[0]=="I"){if(!$this->ZZZZZe4->ZZZZZK1010($field)){$type = "number";}} return array("name"=>$this->prefix.$field['fieldname'], "column"=>$field['columnname'], "table"=>$field['tablename'], "uitype"=>$field['uitype'], "type"=>$type, "title"=>$this->fieldTitlePrefix.$this->ZZZZZe4->ZZZZZw22($field['fieldlabel'],$this->name), "availableValues" =>$ZZZZZZZZZZZZZZZu20, "bareTitle"=>$this->ZZZZZe4->ZZZZZw22($field['fieldlabel'],$this->name),);} function ZZZZZZZZZZZP1515(){return $this->ZZZZZe4->ZZZZZB11($this->name);} function ZZZZZZZZZZZZV2121(){$ZZZH77 = $this->ZZZZZe4->ZZZZZE44($this->name);$ZZZe4 = ZZZf5::getInstance();$ZZZg6 = $ZZZe4->ZZZh7();if(isset($ZZZg6->enableAudit) && $ZZZg6->enableAudit){ZZZi8::ZZZj9(ZZZk10::load('hooks', 'addAuditTable'));$ZZZH77 = ZZZi8::ZZZZZZZZZZZZZZZZX2323($this->name, $ZZZH77, $this->db);} if(isset($ZZZg6->enableCustomTables) && $ZZZg6->enableCustomTables) {ZZZi8::ZZZj9(ZZZk10::load('hooks', 'addCustomTable'));$ZZZH77 = ZZZi8::ZZZZZZZZZZZZZZZZX2323($this->name, $ZZZH77, $this->db);} $ZZT1919 = count($ZZZH77);$ZZS1818 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZH77[$Zf5]['name']] = $ZZZH77[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZZZZZh7(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZV2121($ZZZc2[$Zf5]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZY2424($ZZZZz25,$ZZZZZZZZZZZZZZZZZ2525 = false){if($ZZZZz25['label'] == "---"){$ZZS1818 = array("title" => $this->ZZZZZe4->ZZZZZw22($this->name,$this->name), "fields" => array(),);}else{$ZZS1818 = array("title" => $this->ZZZZZe4->ZZZZZw22($ZZZZz25['label'],$this->name), "fields" => array(),);} if($ZZZZz25['id'] === 52){$ZZS1818["title"] = $this->ZZZZZe4->ZZZZZw22($ZZZZz25['label'],"Invoice");} $ZZT1919 = count($ZZZZz25['fields']);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!$ZZZZZZZZZZZZZZZZZ2525 || !($ZZZZz25['fields'][$Zf5]['tablename']== "vtiger_crmentity" && $ZZZZz25['fields'][$Zf5]['columnname']=='assigned_user_id')){$ZZS1818['fields'][] = $this->ZZZZZZZZZZZZZZZZV2121($ZZZZz25['fields'][$Zf5]);}} return $ZZS1818;} function ZZZZZZZZZZg6(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]["module"] = 0;$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = "0_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZZe4->ZZZZZw22($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZM1212($ZZZZZZZZZZZZZZZZZ2525 = false){$ZZZZZZZZZZZZZZZZZa0 = $this->db->ZZZz25($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZa0);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZY2424($ZZZZZZZZZZZZZZZZZa0[$Zf5],$ZZZZZZZZZZZZZZZZZ2525);} return $ZZS1818;}} class ZZZZZZZZZZI88 extends ZZZZZZZZZZH77{public $relationDescr;public $prefix = "";public $ZZZZZZZZZZZZZZZZZb1 = "";function __construct($name, ZZp15 $db, ZZZZZf5 $ZZZZZe4,$relationDescr){parent::__construct($name,$db,$ZZZZZe4);$this->relationDescr = $relationDescr;} function ZZZZZZZZZZZZZZZZY2424($ZZZZz25,$ZZZZZZZZZZZZZZZZZ2525 = false){$ZZS1818 = parent::ZZZZZZZZZZZZZZZZY2424($ZZZZz25,$ZZZZZZZZZZZZZZZZZ2525);$ZZS1818["title"] = $this->ZZZZZZZZZZZZZZZZZb1.$ZZS1818["title"];return $ZZS1818;} function ZZZZZZZZZZg6($ZZZZZZZZZZZm12 = 0){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = $ZZZZZZZZZZZm12."_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZZe4->ZZZZZw22($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZZc2[$Zf5]['module'] = $ZZZZZZZZZZZm12;$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;}}
;require_once "modules/AnalyticReporting/lib/PHPEXCEL/Classes/PHPExcel.php";require_once 'modules/AnalyticReporting/lib/PHPEXCEL/Classes/PHPExcel.php';function retrieveData($adb,$ZZZZZZZZZZZZZZZZZZD33 = false,$ZZZZZZZZZZZZZZZZZZE44 = null){$ZZZZZe4 = new ZZZZZf5();if(!$ZZZZZZZZZZZZZZZZZZD33){$db = new ZZp15($adb);$ZZZZZZZZZZZZZZZZZZE44 = $db->loadReport((int)$_REQUEST["record"]);}else{$db = $adb;$ZZZZZZZZZZZZZZZZZZE44["related_data"] = json_decode($ZZZZZZZZZZZZZZZZZZE44["related_data"]);} $ZZZZZZZZZZZZZQ1616 = PlatformConnector::ZZZZZZq16();$ZZZR1717 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["labels"],true):json_decode($_POST['labels'],true);if(isset($_REQUEST["combined"]) &&$_REQUEST["combined"] == 1){$module = null;$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZZm12($db, $ZZZZZe4, $ZZZR1717);}else{$module = new ZZZZZZZZZZH77($ZZZZZZZZZZZZZZZZZZE44["module"],$db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZI88($db, $ZZZZZe4, $ZZZR1717);} $ZZZZZZZZZZZZZZZZZZG66 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZE44["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZG66[] = new ZZZZZZZZZZE44($ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][9]);} $ZZZg6 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]):json_decode($_POST["options"]);if(!isset($ZZZg6->aggregateColumn)){$ZZZg6->aggregateColumn = false;} global $current_user;$id = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZu20($db,$ZZZZZe4);$ZZZZZZZZZZZZZZZZZZI88 = $ZZZZZZZZZZZZZZZZZZH77->ZZZZZZZZZZZZZZZZZH77($current_user,$id);if($ZZZZZZZZZZZZZZZZZZI88 == 1){$_POST['columns'] = $ZZZZZZZZZZZZZZZZZZE44["fields"];$_POST['filters'] = $ZZZZZZZZZZZZZZZZZZE44["filters"];$_POST['labels'] = $ZZZZZZZZZZZZZZZZZZE44["labels"];} $r17 = $ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZN1313($module, ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["fields"]):json_decode($_POST['columns']), ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["filters"]):json_decode($_POST['filters']), $ZZZZZZZZZZZZZZZZZZG66, ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["grouping"],true):json_decode($_POST['grouping'],true), ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["aggregates"],true):json_decode($_POST['aggregates'],true), !$ZZZg6->includeDetails, $ZZZg6->isCrosstab, false, $ZZZg6->aggregateColumn, "yyyy-mm-dd", false, ($ZZZZZZZZZZZZZZZZZZD33) ? json_decode($ZZZZZZZZZZZZZZZZZZE44["calcFields"],true) : json_decode($_POST['calcFields'], true), array(), $ZZZZZZZZZZZZZQ1616);if((isset($_REQUEST['file']) && $_REQUEST['file'] == 'makePDF') || count($_REQUEST) == 0){$ZZZZZZZZZZZZZZZZZZJ99 = $ZR1717 = $ZZZZZZZZZZZZZZZZZZK1010 = $ZZZP1515 = $ZZZZZZZZZZZZZZZZZZL1111 = $ZZZZZZZZZZZZZZZZZZM1212 = array();$ZZZZZZZZZZZZZZZZZZJ99 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["grouping"],true):json_decode($_POST['grouping'],true);$ZZZZZZZZZZZZZZZZZZN1313 = 0;if(!$ZZZg6->includeDetails && !$ZZZg6->aggregateColumn){foreach ($ZZZZZZZZZZZZZZZZZZJ99 as $ZZZZy24) {if(!$ZZZg6->isCrosstab || $ZZZZy24['position'] == 'row'){if($ZZZZy24['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name']."_".$ZZZZy24['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name'];$ZZZZZZZZZZZZZZZW2222[] = $ZZZZZZZZZZZZZZZZZZO1414;if(isset($ZZZZy24['showAggregates'])){foreach($ZZZZy24['showAggregates'] as $ZZZZZZZZZZZZZZZZZZP1515 => $ZZZZZZZZZZZZZc2){if(isset($ZZZZZZZZZZZZZc2['sum']) && $ZZZZZZZZZZZZZc2['sum']) $ZZZP1515[] = $ZZZZZZZZZZZZZZZZZZP1515."_sum";if(isset($ZZZZZZZZZZZZZc2['count']) && $ZZZZZZZZZZZZZc2['count']) $ZZZP1515[] = $ZZZZZZZZZZZZZZZZZZP1515."_cnt";}}}} array_pop($ZZZZZZZZZZZZZZZW2222);$ZZZP1515 = array_unique($ZZZP1515);if(count($ZZZZZZZZZZZZZZZW2222)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZR1717) {foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818] != $ZZZZZZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZZZZZZS1818]){$ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919]))$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;unset($ZZZZZZZZZZZZZZZZZZA00);}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZZZZS1818);if($ZZZZZZZZZZZZZZZZZZS1818 == $ZZZZZZZZZZZZZZZW2222[0]) {foreach ($ZZZZZZZZZZZZZZZZZZK1010 as &$ZZZZZZZZZZZZZZZZZZU2020) $ZZZZZZZZZZZZZZZZZZU2020 = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZR1717 as $ZZZZZZZZZZZZZZZZZZV2121 => $ZZZZZZZZZZZZZZZZZZW2222) {$ZZZZZZZZZZZZZZZZZZX2323 = preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZV2121);foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZX2323, $ZZZP1515)){$ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] += $ZZZZZZZZZZZZZZZZZZW2222;} elseif((!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZX2323, $ZZZP1515)) || in_array($ZZZZZZZZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZZZW2222)){$ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] = $ZZZZZZZZZZZZZZZZZZW2222;}}}} $ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;if(!empty($ZR1717)){do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919]))$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;unset($ZZZZZZZZZZZZZZZZZZA00);}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZW2222[0]);} $r17["data"] = ZZZZZZZZZZZZZZZZZZY2424($r17["data"], $ZZZP1515);}}elseif ($ZZZg6->includeDetails) {foreach ($ZZZZZZZZZZZZZZZZZZJ99 as $ZZZZy24) {if($ZZZZy24['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name']."_".$ZZZZy24['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZO1414 = $ZZZZy24['name'];$ZZZZZZZZZZZZZZZW2222[] = $ZZZZZZZZZZZZZZZZZZO1414;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZO1414] = 0;foreach($ZZZZy24['showAggregates'] as $ZZZZZZZZZZZZZZZZZZP1515 => $ZZZZZZZZZZZZZc2){if(isset($ZZZZZZZZZZZZZc2['sum']) && $ZZZZZZZZZZZZZc2['sum']) $ZZZZZZZZZZZZZZZZZZL1111[] = $ZZZZZZZZZZZZZZZZZZP1515;if(isset($ZZZZZZZZZZZZZc2['count']) && $ZZZZZZZZZZZZZc2['count']) $ZZZZZZZZZZZZZZZZZZM1212[] = $ZZZZZZZZZZZZZZZZZZP1515;} $ZZZZZZZZZZZZZZZZZZL1111 = array_unique($ZZZZZZZZZZZZZZZZZZL1111);$ZZZZZZZZZZZZZZZZZZM1212 = array_unique($ZZZZZZZZZZZZZZZZZZM1212);} if(count($ZZZZZZZZZZZZZZZW2222)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZR1717) {foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZS1818] != $ZZZZZZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZZZZZZS1818]){$ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZZZZS1818);if($ZZZZZZZZZZZZZZZZZZS1818 == $ZZZZZZZZZZZZZZZW2222[0]) {foreach ($ZZZZZZZZZZZZZZZZZZK1010 as &$ZZZZZZZZZZZZZZZZZZU2020) $ZZZZZZZZZZZZZZZZZZU2020 = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZR1717 as $ZZZZZZZZZZZZZZZZZZV2121 => $ZZZZZZZZZZZZZZZZZZW2222) {foreach ($ZZZZZZZZZZZZZZZW2222 as $ZZZZZZZZZZZZZZZZZZS1818) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZL1111)) $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] += $ZZZZZZZZZZZZZZZZZZW2222;elseif(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZM1212)) $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]++;elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && (in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZW2222) || in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZL1111))){$ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] = $ZZZZZZZZZZZZZZZZZZW2222;} elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121]) && in_array($ZZZZZZZZZZZZZZZZZZV2121, $ZZZZZZZZZZZZZZZZZZM1212)) $ZR1717[$ZZZZZZZZZZZZZZZZZZS1818][$ZZZZZZZZZZZZZZZZZZV2121] = 1;}}} $ZZZZZW2222 = count($ZZZZZZZZZZZZZZZW2222)-1;do{$ZZZZZZZZZZZZZZZZZZT1919 = $ZZZZZZZZZZZZZZZW2222[$ZZZZZW2222];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZT1919] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZA00[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZW2222) && $Zu20 != $ZZZZZZZZZZZZZZZZZZT1919) unset($ZZZZZZZZZZZZZZZZZZA00[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919], 0, array($ZZZZZZZZZZZZZZZZZZA00));$ZZZZZZZZZZZZZZZZZZN1313++;$ZZZZZZZZZZZZZZZZZZK1010[$ZZZZZZZZZZZZZZZZZZT1919] = $ZZZZZZZZZZZZZZZZZZQ1616+$ZZZZZZZZZZZZZZZZZZN1313;$ZZZZZW2222--;}while($ZZZZZZZZZZZZZZZZZZT1919 != $ZZZZZZZZZZZZZZZW2222[0]);$r17["data"] = ZZZZZZZZZZZZZZZZZZY2424($r17["data"], $ZZZZZZZZZZZZZZZZZZM1212);}}} $r17["title"] = $ZZZZZZZZZZZZZZZZZZE44["title"];return $r17;} function ZZZZZZZZZZZZZZZZZZY2424($r17, $ZZZZZZZZZZZZZZZZZZM1212){global $current_user;$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZZ2525 = $ZZZZZe4->ZZZZZj9($current_user);$ZZZZZZZZZZZZZZZZZZZa0 = $ZZZZZZZZZZZZZZZZZZZ2525['decimal'];$ZZZZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZZZZZZZ2525['seperator'];$ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();foreach ($r17 as $ZZZZZZZZZZZZZZZZZZZc2 => $ZZZZZZZZZZZZZZZZZZZd3) {foreach ($ZZZZZZZZZZZZZZZZZZZd3 as $ZZZZZZZZZZZZZZZZZZZe4 => $ZZZZZZZZZZZZZZZZZZZf5) {if(substr($ZZZZZZZZZZZZZZZZZZZf5, 0, 10) == "<SubTotal>" && is_numeric(str_replace("<SubTotal>", "", $ZZZZZZZZZZZZZZZZZZZf5))){if(substr($ZZZZZZZZZZZZZZZZZZZe4, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZZe4."_cnt", $ZZZZZZZZZZZZZZZZZZM1212) && !in_array($ZZZZZZZZZZZZZZZZZZZe4, $ZZZZZZZZZZZZZZZZZZM1212)){$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]),$ZZZZZZZZZZZF55,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4];}else{$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4]),0,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZZc2][$ZZZZZZZZZZZZZZZZZZZe4];}}}} return $r17;} function ZZZZZZZZZZZZZZZZZZZg6($r17){$ZZZZZZZZZZZZZZR1717 = array_keys($r17["cols"]);$ZZS1818 = array();$ZZS1818[] = array_values($r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZZZZF55 = count($r17["data"]);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZF55;$Zf5++){$ZZZH77 = array();for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZT1919;$ZZZZZW2222++){$ZZZH77[] = (isset($r17["data"][$Zf5][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222]]))?($r17["data"][$Zf5][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222]]):("");} $ZZS1818[] = $ZZZH77;} $ZZZZZZZZZZZZZZZZZZZh7 = new PHPExcel();$ZZZZZZZZZZZZZZZZZZZh7->getProperties()->setCreator("Advanced Reporting For vTiger") ->setLastModifiedBy("ITSAPIENS.EU") ->setTitle("REPORT") ->setSubject("REPORT") ->setDescription("REPORT");$ZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZZZZZZZZZZZh7->getActiveSheet();$ZZZZZZZZZZZZZZZZZZZi8->fromArray($ZZS1818);return $ZZZZZZZZZZZZZZZZZZZh7;} function ZZZZZZZZZZZZZZZZZZZj9($r17){if(file_exists(dirname(__FILE__)."/generatePDFHTML.php")) {require_once dirname(__FILE__)."/generatePDFHTML.php";}else{$ZZZZZZZZZZZn13 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZZk10 = count($ZZZZZZZZZZZn13);$ZZZZZZZZZZZZZZZZZZZl11 = "<style> thead{font-weight: bold;} th{font-weight: bold;font-size: 12pt;} td,th{border: solid 1px #000000;page-break-inside:avoid;} tr{page-break-inside:avoid;} table{white-space: nowrap;} </style> <h3>".$r17["title"]."</h3> ";$ZZZZZZZZZZZZZZZZZZZl11.= "<table><thead><tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZZk10;$Zf5++){$ZZZZZZZZZZZZZZZZZZZl11.= "<th><b>";$ZZZZZZZZZZZZZZZZZZZl11.= $r17["cols"][$ZZZZZZZZZZZn13[$Zf5]];$ZZZZZZZZZZZZZZZZZZZl11.= "</b></th>";} $ZZZZZZZZZZZZZZZZZZZl11.= "</tr></thead><tbody>";$ZZT1919 = count($r17["data"]);for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZT1919;$ZZZZZW2222++){$ZZZZZZZZZZZZZZZZZZZl11.= "<tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZZk10;$Zf5++){$ZZZZZZZZZZZZZZZZZZZl11.= "<td>";if(isset($r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]])){@$ZZZZZZZZZZZZZZZZZZZl11.= (($ZZZZZZZZZZZn13[$Zf5] == "grand_total" || $r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[0]] == "Grand Total" || substr($r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]], 0, 10) == "<SubTotal>") ? "<b>".$r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]]."</b>":$r17["data"][$ZZZZZW2222][$ZZZZZZZZZZZn13[$Zf5]]);} $ZZZZZZZZZZZZZZZZZZZl11.= "</td>";} $ZZZZZZZZZZZZZZZZZZZl11.= "</tr>";} $ZZZZZZZZZZZZZZZZZZZl11.= "</tbody></table>";} return $ZZZZZZZZZZZZZZZZZZZl11;}
function ZZZZZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZZZZZn13){if($ZZZZZZZZZZZZZZZZZZZn13 <= 760) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A4";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >= 761 && $ZZZZZZZZZZZZZZZZZZZn13 <= 1120) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A3";}elseif($ZZZZZZZZZZZZZZZZZZZn13 >=1121 && $ZZZZZZZZZZZZZZZZZZZn13 <= 1600) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A2";}elseif($ZZZZZZZZZZZZZZZZZZZn13 >=1601 && $ZZZZZZZZZZZZZZZZZZZn13 <= 2200) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A1";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >=2201 && $ZZZZZZZZZZZZZZZZZZZn13 <= 3360) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "A0";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >=3361 && $ZZZZZZZZZZZZZZZZZZZn13 <= 4680) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "2A0";} elseif($ZZZZZZZZZZZZZZZZZZZn13 >=4681 && $ZZZZZZZZZZZZZZZZZZZn13 <= 6490) {$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = "4A0";}else{$ZZZZZZZZZZZZZZZZZZZo14 = "L";$ZZZZZZZZZZZZZZZZZZZp15 = array(round($ZZZZZZZZZZZZZZZZZZZn13/1.5),$ZZZZZZZZZZZZZZZZZZZn13);} return array($ZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZZZp15);}
;class ZZZZZZZZZZZZZZZZZu20 {protected $db;protected $ZZZZZe4;function __construct($db, $ZZZZZe4) {$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;} function ZZZZZZZZZZZZZZZZZv21($ZZZZZZZZZZZZZZZZZw22,$ZZZZZZZZZZZZZZZZZx23,$ZZZZZZZZZZZZZZZZZy24){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZw22);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array('id'=>$ZZZZZZZZZZZZZZZZZx23.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"], 'name'=>$ZZZZZZZZZZZZZZZZZy24.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["name"]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZz25($ZZZZZZZZZZZZZZZZZw22,$prefix){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZw22);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZZw22[$Zf5]["level"]==2) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"]] = "DELETE";elseif($ZZZZZZZZZZZZZZZZZw22[$Zf5]["level"]==1) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"]] = "EDIT";else $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZw22[$Zf5]["id"]] = "VIEW";} return $ZZS1818;} function ZZZZq16(){return $this->db->ZZZZq16();} function ZZZZZZZZZZZZZZZZZA00(){$ZZZZL1111 = $this->db->ZZZZq16();$ZZZZL1111 = $this->ZZZZZZZZZZZZZZZZZv21($ZZZZL1111,"u_",$this->ZZZZZe4->ZZZZZw22("label_user","AnalyticReporting")."::");$ZZZZP1515 = $this->db->ZZZZC22();$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZv21($ZZZZP1515,"r_",$this->ZZZZZe4->ZZZZZw22("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZZZL1111, $ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZB11($ZZZK1010){$ZZZZL1111 = $this->db->ZZZZr17($ZZZK1010);$ZZZZL1111 = $this->ZZZZZZZZZZZZZZZZZz25($ZZZZL1111,"u_");$ZZZZP1515 = $this->db->ZZZZA00($ZZZK1010);$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZz25($ZZZZP1515,"r_");$ZZS1818 = array_merge($ZZZZL1111,$ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZC22(){$ZZS1818 = $this->ZZZZZZZZZZZZZZZZZA00();$ZZZZP1515 = $this->db->ZZZZC22();$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZv21($ZZZZP1515,"r_",$this->ZZZZZe4->ZZZZZw22("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZS1818,$ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZD33($prefix,$name,$ZZZZZZZZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZj9);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $prefix.$ZZZZZZZZZZZZZZZZZj9[$Zf5][$name];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZE44($ZZZK1010){$ZZZZL1111 = $this->db->ZZZZs18($ZZZK1010);$ZZZZL1111 = $this->ZZZZZZZZZZZZZZZZZD33("u_","user",$ZZZZL1111);$ZZZZP1515 = $this->db->ZZZZu20($ZZZK1010);$ZZZZP1515 = $this->ZZZZZZZZZZZZZZZZZD33("r_","role",$ZZZZP1515);$ZZS1818 = array_merge($ZZZZL1111,$ZZZZP1515);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZF55($ZZZK1010){$ZZZH77 = $this->db->ZZZC22("SELECT * FROM advancedreports_schedule WHERE id = $ZZZK1010");$ZZS1818 = array("isScheduled" => false, "interval" => 0, "intervalOptions" => array("01","01"), "timeH" => "12", "timeM" => "00", "formats" =>new stdClass(),);if(!empty($ZZZH77)){$ZZS1818["isScheduled"] = true;$ZZS1818["interval"] = $ZZZH77[0]['interval'];$ZZZZZZZZZZZZZZZZZG66 = explode(":",$ZZZH77[0]["time"]);$ZZS1818["timeH"] = $ZZZZZZZZZZZZZZZZZG66[0];$ZZS1818["timeM"] = $ZZZZZZZZZZZZZZZZZG66[1];$ZZS1818["intervalOptions"] = $ZZZH77[0]["interval_options"];if(in_array($ZZS1818["interval"],array(2,4))){$ZZS1818["intervalOptions"] = explode("-",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==3){$ZZS1818["intervalOptions"] = array("01",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==1){$ZZS1818["intervalOptions"] = array($ZZS1818["intervalOptions"],"01");} if(!empty($ZZZH77[0]["formats"])){$ZZS1818["formats"] = json_decode($ZZZH77[0]["formats"]);}else{$ZZS1818["formats"] = json_decode('{"xlsx":true,"pdf":false,"url":false}');}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZH77($ZZZZZi8,$report){if($this->ZZZZZe4->ZZZZZg6($ZZZZZi8)){return 3;} $ZZZZf5 = $this->ZZZZZe4->ZZZZZh7($ZZZZZi8);$ZZZZJ99 = $this->ZZZZZe4->getUserGroups($ZZZZf5);$ZZZH77 = $this->db->ZZZZH77($ZZZZf5,$ZZZZJ99,$report);$ZZS1818 = ($ZZZH77[0]['level'] == null) ? 0 : $ZZZH77[0]['level'] + 1;return $ZZS1818;} function ZZZZZZZZZZZZZZZZZI88($ZZZK1010,$r17){$ZZZZJ99 = array();$ZZZZL1111 = array();foreach($r17 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZZH77 = explode("_",$ZZZZa0,2);if(count($ZZZH77) == 2){if($ZZZZZZZZZZZZZZZr17=="DELETE") $ZZZZZZZZZZZZZZZZZJ99 = 2;elseif ($ZZZZZZZZZZZZZZZr17=="EDIT") $ZZZZZZZZZZZZZZZZZJ99 = 1;else $ZZZZZZZZZZZZZZZZZJ99 = 0;if($ZZZH77[0]=="u"){$ZZZZL1111[] = array($ZZZK1010,$ZZZH77[1],$ZZZZZZZZZZZZZZZZZJ99);}else{$ZZZZJ99[] = array($ZZZK1010,$ZZZH77[1],$ZZZZZZZZZZZZZZZZZJ99);}}} $this->db->ZZZZI88($ZZZK1010,$ZZZZJ99);$this->db->ZZZZK1010($ZZZK1010,$ZZZZL1111);} function ZZZZZZZZZZZZZZZZZK1010($ZZZK1010,$r17){$ZZZZL1111 = array();$ZZZZJ99 = array();$ZZZZP1515 = array();$ZZT1919 = count($r17);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZH77 = explode("_",$r17[$Zf5], 2);switch($ZZZH77[0]){case "u": $ZZZZL1111[]= $ZZZH77[1];break;case "g": $ZZZZJ99[]= $ZZZH77[1];break;case "r": $ZZZZP1515[]= $ZZZH77[1];break;}} $this->db->ZZZZN1313($ZZZK1010,$ZZZZL1111);$this->db->ZZZZO1414($ZZZK1010,$ZZZZP1515);} function ZZZZZZZZZZZZZZZZZL1111($ZZZK1010){$this->db->ZZZI88("DELETE FROM advancedreports_schedule WHERE id = ?", array($ZZZK1010));$this->db->ZZZI88("DELETE FROM advancedreports_schedule_u WHERE id = ?", array($ZZZK1010));$this->db->ZZZI88("DELETE FROM advancedreports_schedule_r WHERE id = ?", array($ZZZK1010));} function ZZZZZZZZZZZZZZZZZM1212($ZZZZZZZZZZZZZZZZZN1313,$ZZZZZZZZZZZZZZZZZO1414,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZa0){$ZZZZZZZZZZZZZZZZZP1515 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZN1313){case 1: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("this ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414]);break;case 2: $ZZZZZZZZZZZZZZZZZO1414 = explode("-",$ZZZZZZZZZZZZZZZZZO1414,2);if($ZZZZZZZZZZZZZZZZZO1414[1] == 0){$ZZZZZZZZZZZZZZZZZR1717 = "first";$ZZZZZZZZZZZZZZZZZS1818 = "third";}else{$ZZZZZZZZZZZZZZZZZR1717 = "second";$ZZZZZZZZZZZZZZZZZS1818 = "fourth";} $ZZZZZZZZZZZZZZZZZT1919 = strtotime('today');$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZR1717." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of this month");if($ZZZZZZZZZZZZZZZZZT1919>$ZZZZZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZS1818." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of this month");} break;case 3: $ZZZH77 = date("Y-m-d");$ZZZH77 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZO1414,$ZZZH77);$ZZZZZZZZZZZZZZZZZU2020 = date('Y-m-d', strtotime('last day of this month'));if($ZZZH77>$ZZZZZZZZZZZZZZZZZU2020){$ZZZH77 = $ZZZZZZZZZZZZZZZZZU2020;} $ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 4: $ZZZZZZZZZZZL1111 = ((int)date("Y"));$ZZZH77 = $ZZZZZZZZZZZL1111."-".$ZZZZZZZZZZZZZZZZZO1414;$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 0: default: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("today");break;} $ZZZZZZZZZZZZB11 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZZZZZV2121 = $ZZZZZZZZZZZZB11.$ZZZZZZZZZZZZZZZZZG66.":00";$ZZZZZZZZZZZZZZZZZW2222 = date_default_timezone_get();date_default_timezone_set($ZZZZZZZa0);$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZZZZZZV2121);date_default_timezone_set($ZZZZZZZZZZZZZZZZZW2222);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZp15);} function ZZZZZZZZZZZZZZZZZX2323($ZZZZZZZZZZZZZZZZZN1313,$ZZZZZZZZZZZZZZZZZO1414,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZa0){$ZZZZZZZZZZZZZZZZZP1515 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZN1313){case 1: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("next ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414]);break;case 2: $ZZZZZZZZZZZZZZZZZO1414 = explode("-",$ZZZZZZZZZZZZZZZZZO1414,2);if($ZZZZZZZZZZZZZZZZZO1414[1] == 0){$ZZZZZZZZZZZZZZZZZR1717 = "first";$ZZZZZZZZZZZZZZZZZS1818 = "third";}else{$ZZZZZZZZZZZZZZZZZR1717 = "second";$ZZZZZZZZZZZZZZZZZS1818 = "fourth";} $ZZZZZZZZZZZZZZZZZT1919 = date("Y-m-d");$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZS1818." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of this month");if($ZZZZZZZZZZZZZZZZZT1919>=date("Y-m-d",$ZZZZZZZZZZZZZZZZZQ1616)){$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZR1717." ".$ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of next month");} break;case 3: $ZZZH77 = date("Y-m-d",strtotime("+1 month"));$ZZZH77 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZO1414,$ZZZH77);$ZZZZZZZZZZZZZZZZZU2020 = date('Y-m-d', strtotime('last day of next month'));if($ZZZH77>$ZZZZZZZZZZZZZZZZZU2020){$ZZZH77 = $ZZZZZZZZZZZZZZZZZU2020;} $ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 4: $ZZZZZZZZZZZL1111 = ((int)date("Y") + 1);$ZZZH77 = $ZZZZZZZZZZZL1111."-".$ZZZZZZZZZZZZZZZZZO1414;$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case 0: default: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("+1 day");break;} $ZZZZZZZZZZZZB11 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZZZZZV2121 = $ZZZZZZZZZZZZB11.$ZZZZZZZZZZZZZZZZZG66.":00";$ZZZZZZZZZZZZZZZZZW2222 = date_default_timezone_get();date_default_timezone_set($ZZZZZZZa0);$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZZZZZZV2121);date_default_timezone_set($ZZZZZZZZZZZZZZZZZW2222);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZp15);} function ZZZZZZZZZZZZZZZZZY2424($id,$ZZZZZZZZZZZZZZZZZN1313,$ZZZZZZZZZZZZZZZZZZ2525,$ZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZb1,$ZZZN1313,$ZZZZZZZZZZZZZZZZZZc2){$ZZZZZi8 = new User();$ZZZZZi8->retrieve((int)$ZZZN1313);$ZZZZZZZZZZZZZZZZZZc2 = json_decode($ZZZZZZZZZZZZZZZZZZc2);if(is_a($ZZZZZZZZZZZZZZZZZZc2,"stdClass") && (property_exists($ZZZZZZZZZZZZZZZZZZc2,"xlsx") || property_exists($ZZZZZZZZZZZZZZZZZZc2,"pdf") || property_exists($ZZZZZZZZZZZZZZZZZZc2,"url"))){$ZZZZZZZZZZZZZZZZZZc2 = json_encode($ZZZZZZZZZZZZZZZZZZc2);}else{$ZZZZZZZZZZZZZZZZZZc2 = "";} $ZZZZZZZZZZZZZZZZZZd3 = TimeDate::userTimezone($ZZZZZi8);$ZZZZZZZZZZZZZZZZZG66 = $ZZZZZZZZZZZZZZZZZZ2525.":".$ZZZZZZZZZZZZZZZZZZa0;$ZZZg6 = "";if($ZZZZZZZZZZZZZZZZZN1313 == 1){$ZZZg6 = (int)$ZZZZZZZZZZZZZZZZZZb1[0];}else if($ZZZZZZZZZZZZZZZZZN1313 == 2){$ZZZg6 = ((int)$ZZZZZZZZZZZZZZZZZZb1[0])."-".((int)$ZZZZZZZZZZZZZZZZZZb1[1]) ;}else if($ZZZZZZZZZZZZZZZZZN1313 == 3){$ZZZg6 = $ZZZZZZZZZZZZZZZZZZb1[1];}else if($ZZZZZZZZZZZZZZZZZN1313 == 4){$ZZZg6 = $ZZZZZZZZZZZZZZZZZZb1[0]."-".$ZZZZZZZZZZZZZZZZZZb1[1];} $ZZZZZZZZZZZZZZZZZZe4 = $this->ZZZZZZZZZZZZZZZZZM1212($ZZZZZZZZZZZZZZZZZN1313,$ZZZg6,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZZZZZZZZZZZZd3);if($ZZZZZZZZZZZZZZZZZZe4<date("Y-m-d H:i:s")){$ZZZZZZZZZZZZZZZZZZe4 = $this->ZZZZZZZZZZZZZZZZZX2323($ZZZZZZZZZZZZZZZZZN1313,$ZZZg6,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZZZZZZZZZZZZd3);} $this->db->ZZZI88("INSERT INTO advancedreports_schedule (`id`, `interval`, `interval_options`, `time`,`nexttime`, `formats`) VALUES(?,?,?,?,'$ZZZZZZZZZZZZZZZZZZe4',?) ON DUPLICATE KEY UPDATE `interval`=VALUES(`interval`), `interval_options`=VALUES(`interval_options`), `time`=VALUES(`time`), `formats`=VALUES(`formats`), `nexttime`='$ZZZZZZZZZZZZZZZZZZe4' ", array($id,$ZZZZZZZZZZZZZZZZZN1313,$ZZZg6,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZZZZZZZZZZZZc2));}} ;class ZZZk10{static private $ZZZZZZZZZZZZZZZZZZZq16 = 'modules/AnalyticReporting/config';static private $ZZZZZZZZZZZZZZZZZZZr17 = array('reportBuilder' => array('common' => 'common', 'manyToMany' => 'manyToMany',), 'common' => array('common' => 'common'), 'hooks' => array('addCustomTable' => 'addCustomTable'));static function load($type, $name){if(isset(ZZZk10::$ZZZZZZZZZZZZZZZZZZZr17[$type][$name])){$ZZZZZZZZZZZZZZZZZZZs18 = ZZZk10::$ZZZZZZZZZZZZZZZZZZZq16."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZt19 = $ZZZZZZZZZZZZZZZZZZZs18."Custom.php";$ZZZZZZZZZZZZZZZZZZZu20 = $ZZZZZZZZZZZZZZZZZZZs18."Default.php";if (file_exists($ZZZZZZZZZZZZZZZZZZZt19)){return include $ZZZZZZZZZZZZZZZZZZZt19;}elseif(file_exists($ZZZZZZZZZZZZZZZZZZZu20)){return include $ZZZZZZZZZZZZZZZZZZZu20;}} return false;} static function save($type, $name, $ZU2020){if(isset($ZZZZZZZZZZZZZZZZZZZr17[$type][$name])){$ZZZZZZZZZZZZZZZZZZZs18 = ZZZk10::$ZZZZZZZZZZZZZZZZZZZq16."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZt19 = $ZZZZZZZZZZZZZZZZZZZs18."Custom.php";file_put_contents($ZZZZZZZZZZZZZZZZZZZt19, ""."php return " . var_export($ZU2020, true) . ";");return true;} return false;}}
;class ZZZZZZZZZZZZZZZZZZZv21
{public $ZZZZZZZZZZZZZZZZZZZw22 = array();public $ZZZZZZZZZZZZZZZZZZZx23 = false;function __construct() {set_time_limit(0);} function ZZZZZZZZZZZZZZZZZZZy24($url, $r17, $ZZZZZZZZZZZZZZZZZZZz25 = false) {$ZZZZZZZZZZZZZZZZZZZA00 = http_build_query($r17);$ZZZZZZZZZZZZZZZZZZZB11 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_POST, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_POSTFIELDS, $ZZZZZZZZZZZZZZZZZZZA00);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_VERBOSE, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_HEADER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_BINARYTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_RETURNTRANSFER, 1);$ZZZZZZZZZZZZZZZZZZh7 = curl_exec($ZZZZZZZZZZZZZZZZZZZB11);$this->ZZZZZZZZZZZZZZZZZZZw22[] = curl_error($ZZZZZZZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZZZZZZZC22 = curl_getinfo($ZZZZZZZZZZZZZZZZZZZB11, CURLINFO_HEADER_SIZE);curl_close ($ZZZZZZZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZZZZZZZD33 = substr($ZZZZZZZZZZZZZZZZZZh7, 0, $ZZZZZZZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZZZZZZZE44 = substr($ZZZZZZZZZZZZZZZZZZh7, $ZZZZZZZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZZZZZZZF55 = explode("\n", $ZZZZZZZZZZZZZZZZZZZD33);foreach($ZZZZZZZZZZZZZZZZZZZF55 as $ZZZZZZZZZZZZZZZZZZZG66) {$ZZZZZZZZZZZZZZZZZZZH77 = explode(':', $ZZZZZZZZZZZZZZZZZZZG66);if(count($ZZZZZZZZZZZZZZZZZZZH77) == 2) {$ZZZZZZZZZZZZZZZZZZZI88[$ZZZZZZZZZZZZZZZZZZZH77[0]] = trim($ZZZZZZZZZZZZZZZZZZZH77[1]);}} if($ZZZZZZZZZZZZZZZZZZZz25) {return $ZZZZZZZZZZZZZZZZZZZE44;} header('Content-type: ' . $ZZZZZZZZZZZZZZZZZZZI88['Content-Type']);header('Content-Disposition: ' . $ZZZZZZZZZZZZZZZZZZZI88['Content-Disposition']);echo $ZZZZZZZZZZZZZZZZZZZE44;} function retrieve($url, $ZZZZZZZZZZZZZZZZZZZJ99 = true, $ZZZZZZZZZZZZZZZZZZZK1010 = false) {$ZZZZZZZZZZZZZZZZZZZB11 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_RETURNTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_TIMEOUT, 50);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_FAILONERROR, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_FOLLOWLOCATION, true);if($ZZZZZZZZZZZZZZZZZZZK1010) {curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_NOPROGRESS, false);curl_setopt($ZZZZZZZZZZZZZZZZZZZB11, CURLOPT_PROGRESSFUNCTION, $ZZZZZZZZZZZZZZZZZZZK1010);} $ZZZZZZZZZZZZZZZZZZh7 = curl_exec($ZZZZZZZZZZZZZZZZZZZB11);$this->ZZZZZZZZZZZZZZZZZZZw22[] = curl_error($ZZZZZZZZZZZZZZZZZZZB11);curl_close($ZZZZZZZZZZZZZZZZZZZB11);if($ZZZZZZZZZZZZZZZZZZZJ99) {return json_decode($ZZZZZZZZZZZZZZZZZZh7, true);} return $ZZZZZZZZZZZZZZZZZZh7;}}
;class ZZZi8{private static $ZZZZZZZZZZz25;private static $ZZZZZZZZZZZZZZZZZZZL1111;public static function ZZZj9($ZZZZZZZZZZz25){ZZZi8::$ZZZZZZZZZZz25 = $ZZZZZZZZZZz25;} public static function ZZZZZZZZZZZZZZZZZZZM1212($moduleName, $ZZZZZZZZZZC22, $ZZZZZZZZZZZZZJ99=""){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return $ZZZZZZZZZZZZZJ99;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {if($ZZZZZZZZZZZZZZZZZZZO1414['panelData']['id'] == $ZZZZZZZZZZC22){return $ZZZZZZZZZZZZZZZZZZZO1414['panelData']['label'];}} return $ZZZZZZZZZZZZZJ99;} public static function ZZZl11($moduleName, $ZZZ2525){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return $ZZZ2525;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {$ZZZ2525 = array_merge($ZZZ2525, $ZZZZZZZZZZZZZZZZZZZO1414['panelData']['fields']);} return $ZZZ2525;} public static function ZZZZZZZZZZZZZZZZX2323($moduleName, $ZZZZZZZZZZX2323, ZZp15 $ZZZZZZj9){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return $ZZZZZZZZZZX2323;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {$ZZZu20 = $ZZZZZZZZZZZZZZZZZZZO1414['tableName'];$ZZZZZZZZZZZZZZZZZZZP1515 = $ZZZZZZZZZZZZZZZZZZZO1414['parentModuleIdColumn'];if($ZZZZZZZZZZZZZZZZZZZO1414['view']){$ZZZZn13 = $ZZZZZZZZZZZZZZZZZZZO1414['viewSql'];$ZZZZo14 = $ZZZZZZZZZZZZZZZZZZZO1414['viewParameters'];$ZZZZZZj9->ZZZZm12($ZZZZn13, $ZZZZo14, $ZZZu20);} $ZZZZZZZZZZX2323[] = array('name' => $ZZZu20, 'idCol' => $ZZZZZZZZZZZZZZZZZZZP1515);} return $ZZZZZZZZZZX2323;} public static function ZZZZZZZZZZZZh7($moduleName, $ZZZZZZZZZZZZZZZZZZZQ1616){$ZZZZZZZZZZz25 = ZZZi8::ZZZZZZZZZZZZZZZZZZZN1313($moduleName);if(!$ZZZZZZZZZZz25) return null;$ZZZZZZZZZZZZf5 = null;foreach ($ZZZZZZZZZZz25 as $ZZZZZZZZZZZZZZZZZZZO1414) {if($ZZZZZZZZZZZZZZZZZZZO1414['tableName'] != $ZZZZZZZZZZZZZZZZZZZQ1616) continue;$ZZZZZZZZZZZZf5 = isset($ZZZZZZZZZZZZZZZZZZZO1414['mainTableId'])?$ZZZZZZZZZZZZZZZZZZZO1414['mainTableId'] : null;} return $ZZZZZZZZZZZZf5;} private static function ZZZZZZZZZZZZZZZZZZZN1313($moduleName){if(!isset(ZZZi8::$ZZZZZZZZZZz25[$moduleName])){return false;} return ZZZi8::$ZZZZZZZZZZz25[$moduleName];} private static function ZZZZZZZZZZZZZZZZZZZR1717($ZZZu20, $ZZZZZZZZZZZZZZZZZZZS1818, $type, $ZZZZZZZZZZZZZZZZZZZT1919){return array('tableName' => $ZZZu20, 'parentModuleIdColumn' => 'id', 'view' => false, 'viewSql' => "", 'viewParameters' => array(), 'panelData' => array('id' => $ZZZZZZZZZZZZZZZZZZZT1919, 'label' => "Snapshot {$ZZZZZZZZZZZZZZZZZZZS1818['columnName']} by {$type}", 'fields' => array(0 => array('tablename' => $ZZZu20, 'columnname' => 'date', 'fieldname' => "{$ZZZZZZZZZZZZZZZZZZZS1818['columnName']}_{$type}_date", 'fieldlabel' => 'Date', 'uitype' => 'datetime', 'typeofdata' => 'DT~O', 'block' => $ZZZZZZZZZZZZZZZZZZZT1919), 1 => array('tablename' => $ZZZu20, 'columnname' => 'value', 'fieldname' => "{$ZZZZZZZZZZZZZZZZZZZS1818['columnName']}_{$type}_value", 'fieldlabel' => 'Value', 'uitype' => $ZZZZZZZZZZZZZZZZZZZS1818['uitype'], 'typeofdata' => 'DT~O', 'block' => $ZZZZZZZZZZZZZZZZZZZT1919, 'options' => $ZZZZZZZZZZZZZZZZZZZS1818['options']),)));}}
;class ZZZf5 {private $ZZZZZZZZZZZZZZZZZZZU2020 = null;private static $ZZZZZZZZZZZZZZZZZZZV2121 = null;private function __construct() {} function ZZZZZZZZZZZZZZZZZZZW2222() {} static function getInstance() {if(is_null(self::$ZZZZZZZZZZZZZZZZZZZV2121)) {self::$ZZZZZZZZZZZZZZZZZZZV2121 = new self();} return self::$ZZZZZZZZZZZZZZZZZZZV2121;} function ZZZZZZZZZZZZZZZZZZZX2323($ZZZg6){$this->ZZZZZZZZZZZZZZZZZZZU2020 = $ZZZg6;} function ZZZh7() {return $this->ZZZZZZZZZZZZZZZZZZZU2020;}}
;function sendScheduledReports() {$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZZe4 = new ZZZZZf5();$ZZZZZZZZZZZZZZZZZZZZZr17 = new ZZZZZZZZZZZZZZZZZZZZZs18($db, $ZZZZZe4);$ZZZZZZZZZZZZZZZZZZZZZr17->sendScheduledReports();return true;} class ZZZZZZZZZZZZZZZZZZZZZs18{const ZZZZZZZZZZZZZZZZZZZZZt19 = 0;const ZZZZZZZZZZZZZZZZZZZZZu20 = 1;const ZZZZZZZZZZZZZZZZZZZZZv21 = 2;const ZZZZZZZZZZZZZZZZZZZZZw22 = 3;const ZZZZZZZZZZZZZZZZZZZZZx23 = 4;protected $db;protected $ZZZZZe4;function __construct($db,$ZZZZZe4){$this->db = $db;$this->ZZZZZe4 = $ZZZZZe4;} protected $ZZZZZZZZZZZZZZZZZP1515 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");function ZZZZZZZZZZZZZZZZZX2323($ZZZZZZZZZZZZZZZZZN1313,$ZZZZZZZZZZZZZZZZZO1414,$ZZZZZZZZZZZZZZZZZG66,$ZZZZZZZa0){switch($ZZZZZZZZZZZZZZZZZN1313){case self::ZZZZZZZZZZZZZZZZZZZZZu20: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("next ".$this->ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414]);break;case self::ZZZZZZZZZZZZZZZZZZZZZv21: $ZZZZZZZZZZZZZZZZZO1414 = explode("-",$ZZZZZZZZZZZZZZZZZO1414,2);if($ZZZZZZZZZZZZZZZZZO1414[1] == 0){$ZZZZZZZZZZZZZZZZZR1717 = "first";$ZZZZZZZZZZZZZZZZZS1818 = "third";}else{$ZZZZZZZZZZZZZZZZZR1717 = "second";$ZZZZZZZZZZZZZZZZZS1818 = "fourth";} $ZZZZZZZZZZZZZZZZZT1919 = date("Y-m-d");$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZS1818." ".$this->ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of this month");if($ZZZZZZZZZZZZZZZZZT1919>=date("Y-m-d",$ZZZZZZZZZZZZZZZZZQ1616)){$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZZZZZZZZZZZZZZZR1717." ".$this->ZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZO1414[0]]." of next month");} break;case self::ZZZZZZZZZZZZZZZZZZZZZw22: $ZZZH77 = date("Y-m-d",strtotime("+1 month"));$ZZZH77 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZO1414,$ZZZH77);$ZZZZZZZZZZZZZZZZZU2020 = date('Y-m-d', strtotime('last day of next month'));if($ZZZH77>$ZZZZZZZZZZZZZZZZZU2020){$ZZZH77 = $ZZZZZZZZZZZZZZZZZU2020;} $ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case self::ZZZZZZZZZZZZZZZZZZZZZx23: $ZZZZZZZZZZZL1111 = ((int)date("Y") + 1);$ZZZH77 = $ZZZZZZZZZZZL1111."-".$ZZZZZZZZZZZZZZZZZO1414;$ZZZZZZZZZZZZZZZZZQ1616 = strtotime($ZZZH77);break;case self::ZZZZZZZZZZZZZZZZZZZZZt19: default: $ZZZZZZZZZZZZZZZZZQ1616 = strtotime("+1 day");break;} $ZZZZZZZZZZZZB11 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZZZZZV2121 = $ZZZZZZZZZZZZB11.$ZZZZZZZZZZZZZZZZZG66.":00";$ZZZZZZZZZZZZZZZZZW2222 = date_default_timezone_get();date_default_timezone_set($ZZZZZZZa0);$ZZZZZZZZZZZZp15 = strtotime($ZZZZZZZZZZZZZZZZZV2121);date_default_timezone_set($ZZZZZZZZZZZZZZZZZW2222);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZp15);} function ZZZZZZZZZZZZZZZZZZZZZy24(){$ZZS1818 = $this->db->ZZZC22("SELECT s.`id`,s.`interval`,s.`interval_options`,s.`time`, s.`formats`, r.* FROM advancedreports_schedule s INNER JOIN `advancedreports` r ON r.id=s.id WHERE `nexttime` <='".date("Y-m-d H:i:s")."'");return $ZZS1818;} function ZZZZZZZZZZZZZZZZZZZZZz25($report){$ZZZZZZZZZZZZZZZZZZZZZA00 = array();$ZZZZL1111 = $this->db->ZZZC22("SELECT `user` FROM advancedreports_schedule_u u WHERE u.id =".((int)$report['id']));$ZZT1919 = count($ZZZZL1111);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZZZZA00[] = $ZZZZL1111[$Zf5]["user"];} $ZZZZP1515 = $this->db->ZZZC22("SELECT `role` FROM advancedreports_schedule_r r WHERE r.id =".((int)$report['id']));$ZZT1919 = count($ZZZZP1515);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZv21 = $this->ZZZZZe4->getRoleUsers($ZZZZP1515[$Zf5]["role"], $this->db);$ZZZZZZZZZZZZZZZZZZZZZA00 = array_merge($ZZZZZZZZZZZZZZZZZZZZZA00,$ZZZZZv21);} $ZZZZZZZZZZZZZZZZZZZZZA00 = array_unique($ZZZZZZZZZZZZZZZZZZZZZA00);$ZZq16 = "SELECT TRIM(CONCAT(IFNULL(`first_name`, ''), ' ', IFNULL(`last_name`, ''))) AS `name`, `emails`.`email_address` AS `email` FROM `users` `u` INNER JOIN `email_addr_bean_rel` AS `emails_rel` ON (`emails_rel`.`bean_module` = 'Users' AND `emails_rel`.`bean_id` = `u`.`id` AND `emails_rel`.`primary_address` = 1 AND `emails_rel`.`deleted` = 0) INNER JOIN `email_addresses` AS `emails` ON (`emails`.`id` = `emails_rel`.`email_address_id` AND `emails`.`deleted` = 0) WHERE `u`.`id` IN (".implode(",",$this->db->ZZK1010($ZZZZZZZZZZZZZZZZZZZZZA00)).") AND `u`.`status`='Active' ";$ZZS1818 = $this->db->ZZZC22($ZZq16);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZZZZZB11($ZZZZZZZZZZZZZZZZZZE44){$ZZZZZZZZZZZZZQ1616 = PlatformConnector::ZZZZZZq16($ZZZZZZZZZZZZZZZZZZE44["owner"]);$ZZZZZZZZZZZZZZZZZZE44["related_data"] = json_decode($ZZZZZZZZZZZZZZZZZZE44["related_data"]);$ZZZg6 = json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]);if(!isset($ZZZg6->isCombined)){$ZZZg6->isCombined = false;} $ZZZR1717 = json_decode($ZZZZZZZZZZZZZZZZZZE44["labels"], true);if($ZZZg6->isCombined){$module = null;$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZZm12($this->db, $this->ZZZZZe4, $ZZZR1717);}else{$module = new ZZZZZZZZZZH77($ZZZZZZZZZZZZZZZZZZE44["module"],$this->db,$this->ZZZZZe4);$ZZZZZZZZZZZZZZZZZZF55 = new ZZZZZZZZZZZZZI88($this->db, $this->ZZZZZe4, $ZZZR1717);} $ZZZZZZZZZZZZZZZZZZG66 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZE44["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZG66[] = new ZZZZZZZZZZE44($ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZE44["related_data"][$Zf5][11]);} if(!isset($ZZZg6->aggregateColumn)){$ZZZg6->aggregateColumn = false;} $r17 = $ZZZZZZZZZZZZZZZZZZF55->ZZZZZZZZZZZZZN1313($module, json_decode($ZZZZZZZZZZZZZZZZZZE44['fields']), json_decode($ZZZZZZZZZZZZZZZZZZE44['filters']), $ZZZZZZZZZZZZZZZZZZG66, json_decode($ZZZZZZZZZZZZZZZZZZE44['grouping'],true), json_decode($ZZZZZZZZZZZZZZZZZZE44['aggregates'],true), !$ZZZg6->includeDetails, $ZZZg6->isCrosstab, false, $ZZZg6->aggregateColumn, "yyyy-mm-dd", false, isset($ZZZZZZZZZZZZZZZZZZE44['calcFields']) ? json_decode($ZZZZZZZZZZZZZZZZZZE44['calcFields'], true) : array(), array(), $ZZZZZZZZZZZZZQ1616);$ZZZZZZZZZZZZZZR1717 = array_keys($r17["cols"]);$ZZS1818 = array();$ZZS1818[] = array_values($r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZR1717);$ZZZZZZZZZZZZZZF55 = count($r17["data"]);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZF55;$Zf5++){$ZZZH77 = array();for($ZZZZZW2222 = 0;$ZZZZZW2222<$ZZT1919;$ZZZZZW2222++){$ZZZH77[] = (isset($r17["data"][$Zf5][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222]]))?($r17["data"][$Zf5][$ZZZZZZZZZZZZZZR1717[$ZZZZZW2222]]):("");} $ZZS1818[] = $ZZZH77;} $ZZZZZZZZZZZZZZZZZZZh7 = new PHPExcel();$ZZZZZZZZZZZZZZZZZZZh7->getProperties()->setCreator("Advanced Reporting For vTiger") ->setLastModifiedBy("ITSAPIENS.EU") ->setTitle("REPORT") ->setSubject("REPORT") ->setDescription("REPORT");$ZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZZZZZZZZZZZh7->getActiveSheet();$ZZZZZZZZZZZZZZZZZZZi8->fromArray($ZZS1818);$ZZZZZZZZZZZZZZZZZZZZT1919 = PHPExcel_IOFactory::createWriter($ZZZZZZZZZZZZZZZZZZZh7, 'Excel2007');$S1818 = 'upload/AnalyticReporting_'.preg_replace('/[^a-zA-Z0-9_-\s]/', '', $ZZZZZZZZZZZZZZZZZZE44["title"]).'_'.time().".xlsx";$ZZZZZZZZZZZZZZZZZZZZT1919->save($S1818);return $S1818;} function ZZZZZZZZZZZZZZZZZZZZZC22($ZZZZZZZZZZZZZZZZZZE44){$ZZZg6 = json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]);unset($_REQUEST["combined"]);if(isset($ZZZg6->isCombined) && $ZZZg6->isCombined == true){$_REQUEST["combined"] = 1;} $ZZZZZZZZZZZF55 = PlatformConnector::ZZZZZZL1111();$_REQUEST['file'] = 'makePDF';$r17 = retrieveData($this->db,true,$ZZZZZZZZZZZZZZZZZZE44);global $current_user;$ZZZZZZZZZZZZZZZZZZD33 = true;$ZZZZZZZZZZZZZZZZZZZ2525 = $this->ZZZZZe4->ZZZZZj9($current_user);$ZZZZZZZZZZZZZZZZZZZa0 = $ZZZZZZZZZZZZZZZZZZZ2525['decimal'];$ZZZZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZZZZZZZ2525['seperator'];$ZZZg6 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["options"]):json_decode($_POST["options"]);if(empty($ZZZZZZZZZZZZZZZZZZE44["labels"])) {$ZZZZZZZZZZZZZZZZZZE44["labels"] = "[]";} $ZZZR1717 = ($ZZZZZZZZZZZZZZZZZZD33)? json_decode($ZZZZZZZZZZZZZZZZZZE44["labels"], true):json_decode($_POST["labels"], true);$ZZZQ1616 = ($ZZZZZZZZZZZZZZZZZZD33)?json_decode($ZZZZZZZZZZZZZZZZZZE44["totalAggregates"],true):json_decode($_POST["totalAggregates"],true);$ZZZZZZZZZZZZZZZZZZZZL1111 = array();foreach ($ZZZQ1616 as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZM1212 => $ZZZZZZZZZZZZZZZZZZZZN1313) {if($ZZZZZZZZZZZZZZZZZZZZN1313) $ZZZZZZZZZZZZZZZZZZZZL1111[] = $Zu20.($ZZZZZZZZZZZZZZZZZZZZM1212=='count'?'_cnt':'_sum');}} $ZZZZZZZZZZZZZZZZZZZZO1414 = "Grand Total";if(isset($ZZZR1717["grandTotal"])) {$ZZZZZZZZZZZZZZZZZZZZO1414 = $ZZZR1717["grandTotal"];} if(count($ZZZZZZZZZZZZZZZZZZZZL1111) > 0 && !$ZZZg6->aggregateColumn && !$ZZZg6->isCrosstab){$ZZZZZZZZZZZZZZZZZZZZP1515 = array();foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZZZR1717) {if(!isset($ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616])){$ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616] = 0;} if(substr($ZZZZZZZZZZZZZZZZZZZZR1717, 0, 10) != "<SubTotal>" && (preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZR1717) || is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717)) && substr($ZZZZZZZZZZZZZZZZZZZZQ1616, -4) != "_avg" && (in_array(preg_replace('/[v]\d[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616), $ZZZZZZZZZZZZZZZZZZZZL1111) || in_array(preg_replace('/[v]\d[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616)."_sum", $ZZZZZZZZZZZZZZZZZZZZL1111))){$ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616] = number_format($ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616]+$ZZZZZZZZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZF55,".","");}elseif(substr($ZZZZZZZZZZZZZZZZZZZZR1717, 0, 10) != "<SubTotal>" && in_array(preg_replace('/[v]\d[_]/', '', $ZZZZZZZZZZZZZZZZZZZZQ1616)."_cnt", $ZZZZZZZZZZZZZZZZZZZZL1111) && !preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZR1717) && !is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717)) {$ZZZZZZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZZZZZZZZZZQ1616]++;}}} $ZZZZZZZZZZZZZZZZZZZZP1515[key($r17["cols"])] = $ZZZZZZZZZZZZZZZZZZZZO1414;$r17['data'][] = $ZZZZZZZZZZZZZZZZZZZZP1515;}elseif($ZZZg6->aggregateColumn && !$ZZZg6->isCrosstab) {$ZZZZZZZZZZZZZZZZZZZZP1515 = array();foreach ($r17['data'] as $Zu20 => $value) {$r17['data'][$Zu20]["grand_total"] = 0;foreach ($value as $ZZZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZZZR1717) {if(preg_match('/[v]\d[_]/', $ZZZZZZZZZZZZZZZZZZZZQ1616)) $r17['data'][$Zu20]["grand_total"] += $ZZZZZZZZZZZZZZZZZZZZR1717;}} $r17["cols"]["grand_total"] = $ZZZZZZZZZZZZZZZZZZZZO1414;} foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZQ1616 => $ZZZZZZZZZZZZZZZZZZZZR1717) {if(!isset($r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZQ1616])) {continue;} if($r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZQ1616]=='txt'){continue;} if(is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717) && substr($ZZZZZZZZZZZZZZZZZZZZQ1616, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZZZQ1616."_cnt", $ZZZZZZZZZZZZZZZZZZZZL1111)){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZQ1616] = number_format($ZZZZZZZZZZZZZZZZZZZZR1717,$ZZZZZZZZZZZF55,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);}elseif(is_numeric($ZZZZZZZZZZZZZZZZZZZZR1717)){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZQ1616] = number_format($ZZZZZZZZZZZZZZZZZZZZR1717,0,$ZZZZZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZZZZZZb1);}}} $ZZZZZZZZZZZn13 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZZk10 = count($ZZZZZZZZZZZn13);$ZZZZZZZZZZZZZZZZZZZl11 = ZZZZZZZZZZZZZZZZZZZj9($r17);$ZZZZZZZZZZZZZZZZZZZn13 = $ZZZZZZZZZZZZZZZZZZZk10 * 70;list($ZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZZZp15) = ZZZZZZZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZZZZZZZn13);ini_set("memory_limit","512M");require_once('modules/AnalyticReporting/lib/tcpdf/tcpdf.php');$pdf = new TCPDF($ZZZZZZZZZZZZZZZZZZZo14, "mm", $ZZZZZZZZZZZZZZZZZZZp15, true, 'UTF-8', false);$pdf = new TCPDF($ZZZZZZZZZZZZZZZZZZZo14, "mm", $ZZZZZZZZZZZZZZZZZZZp15, true, 'UTF-8', false);$pdf->SetCreator("IT Sapiens");$pdf->SetAuthor('IT Sapiens');$pdf->SetTitle($r17["title"]);$pdf->SetSubject($r17["title"]);$pdf->SetKeywords('Report');$pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);$pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);$pdf->SetAutoPageBreak(TRUE, PDF_MARGIN_BOTTOM);$pdf->setFontSubsetting(true);$pdf->SetFont('arialunicode', '', 9, '', true);unset($r17);$pdf->AddPage();$pdf->writeHTMLCell(0, 0, '', '', $ZZZZZZZZZZZZZZZZZZZl11, 0, 1, 0, true, '', true);$S1818 = 'upload/AnalyticReporting_'.preg_replace('/[^a-zA-Z0-9_-\s]/', '', $ZZZZZZZZZZZZZZZZZZE44["title"]).'_'.time().".pdf";$pdf->Output($S1818, 'F');return $S1818;} function ZZZZZZZZZZZZZZZZZZZZZD33(){global $current_user;return $current_user->email1;} function ZZZZZZZZZZZZZZZZZZZZZE44($report,$ZZZZZZZZZZZZZZZZZZZZZF55){$ZZZZZi8 = new User();$ZZZZZi8->retrieve($report["owner"]);$ZZZZZZZZZZZZZZZZZZZZZG66 = TimeDate::userTimezone($ZZZZZi8);$ZZZZZZZZZZZZZZZZZZd3 = date_default_timezone_get();date_default_timezone_set($ZZZZZZZZZZZZZZZZZZZZZG66);$ZZZZZZZZZZZZZZZZZZZZZH77 = new TimeDate($ZZZZZi8);$ZZZZZZZZZZZZZZZZZZZZZI88 = $ZZZZZZZZZZZZZZZZZZZZZH77->get_time_format();$dateFormat = $ZZZZZZZZZZZZZZZZZZZZZH77->get_date_format();$ZZS1818 = array("subject"=>"[Report] ".$report["title"]." ".date($dateFormat." ".$ZZZZZZZZZZZZZZZZZZZZZI88), "body" =>$report["description"],);date_default_timezone_set($ZZZZZZZZZZZZZZZZZZd3);if($ZZZZZZZZZZZZZZZZZZZZZF55){global $sugar_config;$ZZS1818["body"].= "\n<br><a href=\"".$sugar_config['site_url']."/index.php?module=AnalyticReporting&action=report&record=".$report["id"]."\">".$report["title"]."</a>";} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZZZZZJ99($report){$ZZZZZZZZZZZZZZZZZZZZZK1010 = array();if(!empty($report["formats"])){$ZZZZZZZZZZZZZZZZZZc2 = json_decode($report["formats"]);}else{$ZZZZZZZZZZZZZZZZZZc2 = json_decode('{"xlsx":true,"pdf":true,"url":true}');} $ZZZZZZZa0 = date_default_timezone_get();if($ZZZZZZZZZZZZZZZZZZc2->xlsx){$ZZZZZZZZZZZZZZZZZZZZZK1010["Report.xlsx"] = $this->ZZZZZZZZZZZZZZZZZZZZZB11($report);} if($ZZZZZZZZZZZZZZZZZZc2->pdf){$ZZZZZZZZZZZZZZZZZZZZZK1010["Report.pdf"] = $this->ZZZZZZZZZZZZZZZZZZZZZC22($report);} date_default_timezone_set($ZZZZZZZa0);$ZZZZZZZZZQ1616 = new Email();$ZZZZZZZZZZZZZZZZZZZZZL1111 = $ZZZZZZZZZQ1616->getSystemDefaultEmail();$ZZZZZZZZZZZZZZZZZZZZZM1212= $this->ZZZZZZZZZZZZZZZZZZZZZE44($report,$ZZZZZZZZZZZZZZZZZZc2->url);$ZZZZZZZZZZZZZZZZZZZZy24 = $this->ZZZZZZZZZZZZZZZZZZZZZz25($report);$ZZZZZZZZv21 = $ZZZZZZZZZZZZZZZZZZZZZL1111['email'];$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZZZy24);include_once 'include/SugarPHPMailer.php';$ZZZZZZZZZZZZZZZZZZZZZN1313 = new SugarPHPMailer();$ZZZZZZZZZZZZZZZZZZZZZN1313->From = $ZZZZZZZZv21;$ZZZZZZZZZZZZZZZZZZZZZN1313->FromName = "Scheduled Report from CRM";$ZZZZZZZZZZZZZZZZZZZZZN1313->ClearAllRecipients();$ZZZZZZZZZZZZZZZZZZZZZN1313->ClearReplyTos();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZZZZN1313->AddAddress($ZZZZZZZZZZZZZZZZZZZZy24[$Zf5]["email"],$ZZZZZZZZZZZZZZZZZZZZy24[$Zf5]["name"]);} $ZZZZZZZZZZZZZZZZZZZZZN1313->Subject = $ZZZZZZZZZZZZZZZZZZZZZM1212["subject"];$ZZZZZZZZZZZZZZZZZZZZZN1313->Body = !empty($ZZZZZZZZZZZZZZZZZZZZZM1212["body"]) ? $ZZZZZZZZZZZZZZZZZZZZZM1212["body"] : "AnalyticReporting scheduled report\n";$ZZZZZZZZZZZZZZZZZZZZZN1313->isHTML(true);foreach($ZZZZZZZZZZZZZZZZZZZZZK1010 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){$ZZZZZZZZZZZZZZZZZZZZZN1313->AddAttachment($ZZZZZZZZZZZZZZZr17,$ZZZZa0);} $ZZZZZZZZZZZZZZZZZZZZZN1313->prepForOutbound();$ZZZZZZZZZZZZZZZZZZZZZN1313->setMailerForSystem();if (!$ZZZZZZZZZZZZZZZZZZZZZN1313->Send()) {$GLOBALS['log']->fatal("ERROR: Mail sending failed! (".__FILE__.")");} foreach($ZZZZZZZZZZZZZZZZZZZZZK1010 as $ZZZZa0 => $ZZZZZZZZZZZZZZZr17){unlink($ZZZZZZZZZZZZZZZr17);}} function ZZZZZZZZZZZZZZZZZZZZZO1414($report){$ZZZZZi8 = new User();$ZZZZZi8->retrieve($report["owner"]);$ZZZZZZZZZZZZZZZZZZZZZG66 = TimeDate::userTimezone($ZZZZZi8);$ZZZZZZZZZZZZZZZZZZe4 = $this->ZZZZZZZZZZZZZZZZZX2323($report['interval'],$report['interval_options'],$report['time'],$ZZZZZZZZZZZZZZZZZZZZZG66);$this->db->ZZZI88("UPDATE advancedreports_schedule SET nexttime = ? WHERE id= ?", array($ZZZZZZZZZZZZZZZZZZe4,$report['id']));} function sendScheduledReports(){$ZZZZZZc2 = $this->ZZZZZZZZZZZZZZZZZZZZZy24();$ZZT1919 = count($ZZZZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZZZZZZJ99($ZZZZZZc2[$Zf5]);$this->ZZZZZZZZZZZZZZZZZZZZZO1414($ZZZZZZc2[$Zf5]);}}}


array_push($job_strings, 'whatsapp_status');
function whatsapp_status()
{
        
require_once("modules/Administration/Administration.php");
    
$whatsapp_admin = new Administration();
$settings_whatsapp = $whatsapp_admin->retrieveSettings('whatsapp_config');    
    
$ch = curl_init();
$tl_url = "http://panel.apiwha.com/get_messages.php?apikey=".$settings_whatsapp."&type=OUT&markaspulled=1&getnotpulledonly=1";
curl_setopt($ch, CURLOPT_URL, $tl_url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post);
$result = curl_exec($ch);
curl_close($ch);

$json_data = json_decode($result,true);

    foreach ($json_data as $key => $value) {
    
    	$process_date = $value['process_date'];
    	$failed_date = $value['failed_date'];
    	$custom_data = $value['custom_data'];
    
    	if(!empty($custom_data)){
    
    		if(empty($process_date))
    		{
    			$msg_Query = "SELECT id_c  FROM calls_cstm WHERE message_id_c LIKE '".$custom_data."'";
    			$Result_msg = $GLOBALS['db']->query($msg_Query);
                $Row_Res = $GLOBALS['db']->fetchByAssoc($Result_msg);
                $MSGID = $Row_Res['id_c'];
    
                if(!empty($MSGID))
                {
                	$WMB = BeanFactory::getBean("Calls",$MSGID);
                	$WMB->status = "Pending";
                	$WMB->save();
                	
                }
    
    		}
    
    		if(!empty($failed_date))
    		{
    
    			$msg_Query = "SELECT id_c  FROM calls_cstm WHERE message_id_c LIKE '".$custom_data."'";
    			$Result_msg = $GLOBALS['db']->query($msg_Query);
                $Row_Res = $GLOBALS['db']->fetchByAssoc($Result_msg);
                $MSGID = $Row_Res['id_c'];
    
                if(!empty($MSGID))
                {
                	$WMB = BeanFactory::getBean("Calls",$MSGID);
                	$WMB->status = "Failure";
                	$WMB->save();
                	
                }
    
    
    		}
    	}
    }
    return true;
}
?>